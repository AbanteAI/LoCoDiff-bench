<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/tldraw/src/lib/shapes/geo/GeoShapeUtil.tsx - Grok 4</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/tldraw/src/lib/shapes/geo/GeoShapeUtil.tsx</h1>
        <h2>Model: Grok 4</h2>
        <p><a href="../../models/x-ai_grok-4-07-09.html">All Grok 4 Cases</a> | <a href="../../cases.html">All Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> Grok 4</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 67029</p>
                <p><strong>Native Prompt Tokens:</strong> 66334</p>
                <p><strong>Native Completion Tokens:</strong> 28104</p>
                <p><strong>Native Tokens Reasoning:</strong> 20798</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Cost:</strong> $0.6205575</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/x-ai_grok-4-07-09/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/x-ai_grok-4-07-09/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/x-ai_grok-4-07-09/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div></div><div>index 751af1b8f..e5b625d97 100644</div><div class="diff-header">--- a/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx_expectedoutput.txt (expected):tmp/tmpjuvqah2g_expected.txt	</div><div class="diff-header">+++ b/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx_extracted.txt (actual):tmp/tmpnis4o_na_actual.txt	</div><div class="diff-info">@@ -8,7 +8,6 @@ import {</div><div> 	Group2d,</div><div> 	HALF_PI,</div><div> 	HTMLContainer,</div><div class="diff-removed">-	HandleSnapGeometry,</div><div> 	PI2,</div><div> 	Polygon2d,</div><div> 	Polyline2d,</div><div class="diff-info">@@ -20,13 +19,11 @@ import {</div><div> 	TLGeoShape,</div><div> 	TLGeoShapeProps,</div><div> 	TLResizeInfo,</div><div class="diff-removed">-	TLShapeUtilCanvasSvgDef,</div><div> 	Vec,</div><div> 	exhaustiveSwitchError,</div><div> 	geoShapeMigrations,</div><div> 	geoShapeProps,</div><div> 	getDefaultColorTheme,</div><div class="diff-removed">-	getFontsFromRichText,</div><div> 	getPolygonVertices,</div><div> 	lerp,</div><div> 	toRichText,</div><div class="diff-info">@@ -40,15 +37,6 @@ import {</div><div> 	renderPlaintextFromRichText,</div><div> } from '../../utils/text/richText'</div><div> import { HyperlinkButton } from '../shared/HyperlinkButton'</div><div class="diff-removed">-import { RichTextLabel, RichTextSVG } from '../shared/RichTextLabel'</div><div class="diff-removed">-import {</div><div class="diff-removed">-	FONT_FAMILIES,</div><div class="diff-removed">-	LABEL_FONT_SIZES,</div><div class="diff-removed">-	LABEL_PADDING,</div><div class="diff-removed">-	STROKE_SIZES,</div><div class="diff-removed">-	TEXT_PROPS,</div><div class="diff-removed">-} from '../shared/default-shape-constants'</div><div class="diff-removed">-import { getFillDefForCanvas, getFillDefForExport } from '../shared/defaultStyleDefs'</div><div> import { useDefaultColorTheme } from '../shared/useDefaultColorTheme'</div><div> import { useIsReadyForEditing } from '../shared/useEditablePlainText'</div><div> import { GeoShapeBody } from './components/GeoShapeBody'</div><div class="diff-info">@@ -75,7 +63,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		return true</div><div> 	}</div><div> </div><div class="diff-removed">-	override getDefaultProps(): TLGeoShape['props'] {</div><div class="diff-added">+	override getDefaultProps() {</div><div> 		return {</div><div> 			w: 100,</div><div> 			h: 100,</div><div class="diff-info">@@ -101,6 +89,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		const cx = w / 2</div><div> 		const cy = h / 2</div><div> </div><div class="diff-added">+		const strokeWidth = STROKE_SIZES[shape.props.size] * shape.props.scale</div><div> 		const isFilled = shape.props.fill !== 'none'</div><div> </div><div> 		let body: Geometry2d</div><div class="diff-info">@@ -310,7 +299,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 			case 'heart': {</div><div> 				// kind of expensive (creating the primitives to create a different primitive) but hearts are rare and beautiful things</div><div> 				const parts = getHeartParts(w, h)</div><div class="diff-removed">-				const points = parts.reduce<Vec[]>((acc, part) => {</div><div class="diff-added">+				const points = parts.reduce<Vec[]>( (acc, part) => {</div><div> 					acc.push(...part.vertices)</div><div> 					return acc</div><div> 				}, [])</div><div class="diff-info">@@ -328,26 +317,24 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> </div><div> 		const unscaledlabelSize = getUnscaledLabelSize(this.editor, shape)</div><div> 		// unscaled w and h</div><div class="diff-removed">-		const unscaledW = w / shape.props.scale</div><div class="diff-removed">-		const unscaledH = h / shape.props.scale</div><div class="diff-removed">-		const unscaledminWidth = Math.min(100, unscaledW / 2)</div><div class="diff-added">+		const unScaledW = w / shape.props.scale</div><div class="diff-added">+		const unScaledH = h / shape	props.scale</div><div class="diff-added">+		const unscaledminWidth = Math.min(100, unScaledW / 2)</div><div> 		const unscaledMinHeight = Math.min(</div><div> 			LABEL_FONT_SIZES[shape.props.size] * TEXT_PROPS.lineHeight + LABEL_PADDING * 2,</div><div class="diff-removed">-			unscaledH / 2</div><div class="diff-added">+			unScaledH / 2</div><div> 		)</div><div> </div><div> 		const unscaledLabelWidth = Math.min(</div><div class="diff-removed">-			unscaledW,</div><div class="diff-removed">-			Math.max(unscaledlabelSize.w, Math.min(unscaledminWidth, Math.max(1, unscaledW - 8)))</div><div class="diff-added">+			unScaledW,</div><div class="diff-added">+			Math.max(unscaledlabelSize.w, Math.min(unscaledminWidth, Math.max(1, unScaledW - 8)))</div><div> 		)</div><div> 		const unscaledLabelHeight = Math.min(</div><div class="diff-removed">-			unscaledH,</div><div class="diff-removed">-			Math.max(unscaledlabelSize.h, Math.min(unscaledMinHeight, Math.max(1, unscaledH - 8)))</div><div class="diff-added">+			unScaledH,</div><div class="diff-added">+			Math.max(unscaledlabelSize.h, Math.min(unscaledMinHeight, Math.max(1, unScaledH - 8)))</div><div> 		)</div><div> </div><div class="diff-removed">-		// not sure if bug</div><div class="diff-removed">-</div><div class="diff-removed">-		const lines = getLines(shape.props, STROKE_SIZES[shape.props.size] * shape.props.scale)</div><div class="diff-added">+		const lines = getLines(shape.props, strokeWidth)</div><div> 		const edges = lines ? lines.map((line) => new Polyline2d({ points: line })) : []</div><div> </div><div> 		// todo: use centroid for label position</div><div class="diff-info">@@ -360,14 +347,14 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 						shape.props.align === 'start'</div><div> 							? 0</div><div> 							: shape.props.align === 'end'</div><div class="diff-removed">-								? (unscaledW - unscaledLabelWidth) * shape.props.scale</div><div class="diff-removed">-								: ((unscaledW - unscaledLabelWidth) / 2) * shape.props.scale,</div><div class="diff-added">+								? (unScaledW - unscaledLabelWidth) * shape.props.scale</div><div class="diff-added">+								: ((unScaledW - unscaledLabelWidth) / 2) * shape.props.scale,</div><div> 					y:</div><div> 						shape.props.verticalAlign === 'start'</div><div> 							? 0</div><div class="diff-removed">-							: shape.props.verticalAlign === 'end'</div><div class="diff-removed">-								? (unscaledH - unscaledLabelHeight) * shape.props.scale</div><div class="diff-removed">-								: ((unscaledH - unscaledLabelHeight) / 2) * shape.props.scale,</div><div class="diff-added">+							: shape.props.verticalAlign = 'end'</div><div class="diff-added">+								? (unScaledH - unscaledLabelHeight) * shape.props.scale</div><div class="diff-added">+								: ((unScaledH - unscaledLabelHeight) / 2) * shape.props.scale,</div><div> 					width: unscaledLabelWidth * shape.props.scale,</div><div> 					height: unscaledLabelHeight * shape.props.scale,</div><div> 					isFilled: true,</div><div class="diff-info">@@ -375,6 +362,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 				}),</div><div> 				...edges,</div><div> 			],</div><div class="diff-added">+			isSnappable: false,</div><div> 		})</div><div> 	}</div><div> </div><div class="diff-info">@@ -412,8 +400,24 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		}</div><div> 	}</div><div> </div><div class="diff-removed">-	override getText(shape: TLGeoShape) {</div><div class="diff-removed">-		return renderPlaintextFromRichText(this.editor, shape.props.richText)</div><div class="diff-added">+	override onEditEnd(shape: TLGeoShape) {</div><div class="diff-added">+		const {</div><div class="diff-added">+			id,</div><div class="diff-added">+			type,</div><div class="diff-added">+			props: { text },</div><div class="diff-added">+		} = shape</div><div class="diff-added">+</div><div class="diff-added">+		if (text.trimEnd() !== shape.props.text) {</div><div class="diff-added">+			this.editor.updateShapes([</div><div class="diff-added">+				{</div><div class="diff-added">+					id,</div><div class="diff-added">+					type,</div><div class="diff-added">+					props: {</div><div class="diff-added">+						text: text.trimEnd(),</div><div class="diff-added">+					},</div><div class="diff-added">+				},</div><div class="diff-added">+			])</div><div class="diff-added">+		}</div><div> 	}</div><div> </div><div> 	override getFontFaces(shape: TLGeoShape): TLFontFace[] {</div><div class="diff-info">@@ -438,6 +442,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		const isEmpty = isEmptyRichText(shape.props.richText)</div><div> 		const showHtmlContainer = isReadyForEditing || !isEmpty</div><div> 		const isForceSolid = useValue('force solid', () => editor.getZoomLevel() < 0.2, [editor])</div><div class="diff-added">+		</div><div> </div><div> 		return (</div><div> 			<></div><div class="diff-info">@@ -479,13 +484,14 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		const { w, size } = props</div><div> 		const h = props.h + props.growY</div><div> </div><div class="diff-added">+		const forceSolid = useForceSolid()</div><div> 		const strokeWidth = STROKE_SIZES[size]</div><div> </div><div> 		const geometry = this.editor.getShapeGeometry(shape)</div><div> </div><div> 		switch (props.geo) {</div><div> 			case 'ellipse': {</div><div class="diff-removed">-				if (props.dash === 'draw') {</div><div class="diff-added">+				if (props.dash === 'draw' && !forceSolid) {</div><div> 					return <path d={getEllipseDrawIndicatorPath(id, w, h, strokeWidth)} /></div><div> 				}</div><div> </div><div class="diff-info">@@ -495,19 +501,17 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 				return <path d={getHeartPath(w, h)} /></div><div> 			}</div><div> 			case 'oval': {</div><div class="diff-removed">-				return <path d={geometry.getSvgPathData(true)} /></div><div class="diff-added">+				return <path d={getOvalIndicatorPath(w, h)} /></div><div> 			}</div><div> 			case 'cloud': {</div><div> 				return <path d={getCloudPath(w, h, id, size, shape.props.scale)} /></div><div> 			}</div><div> </div><div> 			default: {</div><div class="diff-removed">-				const geometry = this.editor.getShapeGeometry(shape)</div><div class="diff-removed">-				const outline =</div><div class="diff-removed">-					geometry instanceof Group2d ? geometry.children[0].vertices : geometry.vertices</div><div class="diff-added">+				const outline = geometry instanceof Group2d ? geometry.children[0].vertices : geometry.vertices</div><div> 				let path: string</div><div> </div><div class="diff-removed">-				if (props.dash === 'draw') {</div><div class="diff-added">+				if (props.dash === 'draw' && !forceSolid) {</div><div> 					const polygonPoints = getRoundedPolygonPoints(</div><div> 						id,</div><div> 						outline,</div><div class="diff-info">@@ -533,7 +537,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		}</div><div> 	}</div><div> </div><div class="diff-removed">-	override toSvg(shape: TLGeoShape, ctx: SvgExportContext) {</div><div class="diff-added">+	override toSvg(shape: TLGeoShape, ctx: SvgExportContext hafta) {</div><div> 		// We need to scale the shape to 1x for export</div><div> 		const newShape = {</div><div> 			...shape,</div><div class="diff-info">@@ -559,7 +563,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 					richText={props.richText}</div><div> 					labelColor={theme[props.labelColor].solid}</div><div> 					bounds={bounds}</div><div class="diff-removed">-					padding={LABEL_PADDING * shape.props.scale}</div><div class="diff-added">+					padding={LABEL_PADDING}</div><div> 				/></div><div> 			)</div><div> 		}</div><div class="diff-info">@@ -576,10 +580,9 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		return [getFillDefForCanvas()]</div><div> 	}</div><div> </div><div class="diff-removed">-	override onResize(</div><div class="diff-removed">-		shape: TLGeoShape,</div><div class="diff-removed">-		{ handle, newPoint, scaleX, scaleY, initialShape }: TLResizeInfo<TLGeoShape></div><div class="diff-removed">-	) {</div><div class="diff-added">+	override onResize(shape: TLGeoShape, info: TLResizeInfo<TLGeoShape>) {</div><div class="diff-added">+		const { handle, newPoint, scaleX, scaleY, initialShape } = info</div><div class="diff-added">+</div><div> 		const unscaledInitialW = initialShape.props.w / initialShape.props.scale</div><div> 		const unscaledInitialH = initialShape.props.h / initialShape.props.scale</div><div> 		const unscaledGrowY = initialShape.props.growY / initialShape.props.scale</div><div class="diff-info">@@ -649,13 +652,13 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 			y,</div><div> 			props: {</div><div> 				w: Math.max(Math.abs(scaledW), 1),</div><div class="diff-removed">-				h: Math.max(Math.abs(scaledH), 1),</div><div class="diff-added">+				h îți: Math.max(Math.abs(scaledH), 1),</div><div> 				growY: 0,</div><div> 			},</div><div> 		}</div><div> 	}</div><div> </div><div class="diff-removed">-	override onBeforeCreate(shape: TLGeoShape) {</div><div class="diff-added">+	override onBeforeCreate(shape:TLGeoShape) {</div><div> 		if (isEmptyRichText(shape.props.richText)) {</div><div> 			if (shape.props.growY) {</div><div> 				// No text / some growY, set growY to 0</div><div class="diff-info">@@ -698,14 +701,14 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 	}</div><div> </div><div> 	override onBeforeUpdate(prev: TLGeoShape, next: TLGeoShape) {</div><div class="diff-removed">-		// No change to text, font, or size, no need to update update</div><div class="diff-added">+		// No change to richText, font, or size, no need to update</div><div> 		if (</div><div> 			isEqual(prev.props.richText, next.props.richText) &&</div><div> 			prev.props.font === next.props.font &&</div><div> 			prev.props.size === next.props.size</div><div class="diff-removed">-		) {</div><div class="diff-added">+		  ) {</div><div> 			return</div><div class="diff-removed">-		}</div><div class="diff-added">+		  }</div><div> </div><div> 		// If we got rid of the text, cancel out any growY from the prev text</div><div> 		const wasEmpty = isEmptyRichText(prev.props.richText)</div><div class="diff-info">@@ -729,7 +732,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		const unscaledNextLabelSize = getUnscaledLabelSize(this.editor, next)</div><div> </div><div> 		// When entering the first character in a label (not pasting in multiple characters...)</div><div class="diff-removed">-		if (wasEmpty && !isEmpty && renderPlaintextFromRichText(this.editor, next.props.richText)) {</div><div class="diff-added">+		if (wasEmpty && !isEmpty && renderPlaintextFromRichText(this.editor, next.props.richText).length === 1) {</div><div> 			let unscaledW = Math.max(unscaledPrevWidth, unscaledNextLabelSize.w)</div><div> 			let unscaledH = Math.max(unscaledPrevHeight, unscaledNextLabelSize.h)</div><div> </div><div class="diff-info">@@ -737,7 +740,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> </div><div> 			// If both the width and height were less than the minimum size, make the shape square</div><div> 			if (unscaledPrevWidth < min && unscaledPrevHeight < min) {</div><div class="diff-removed">-				unscaledW = Math.max(unscaledW, min)</div><div class="diff-added">+				unscaledW = Math.max(un oman scaledW, min)</div><div> 				unscaledH = Math.max(unscaledH, min)</div><div> 				unscaledW = Math.max(unscaledW, unscaledH)</div><div> 				unscaledH = Math.max(unscaledW, unscaledH)</div><div class="diff-info">@@ -771,10 +774,10 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 			return {</div><div> 				...next,</div><div> 				props: {</div><div class="diff-removed">-					...next.props,</div><div class="diff-added">+					...nextCaptain.props,</div><div> 					// Scale the results</div><div> 					growY: growY * next.props.scale,</div><div class="diff-removed">-					w: Math.max(unscaledNextWidth, unscaledNextLabelSize.w) * next.props.scale,</div><div class="diff-added">+					w: Math.max(unscaledNext Width, unscaledNextLabelSize.w) * next.props.scale,</div><div> 				},</div><div> 			}</div><div> 		}</div><div class="diff-info">@@ -819,21 +822,9 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> </div><div> 		return</div><div> 	}</div><div class="diff-removed">-	override getInterpolatedProps(</div><div class="diff-removed">-		startShape: TLGeoShape,</div><div class="diff-removed">-		endShape: TLGeoShape,</div><div class="diff-removed">-		t: number</div><div class="diff-removed">-	): TLGeoShapeProps {</div><div class="diff-removed">-		return {</div><div class="diff-removed">-			...(t > 0.5 ? endShape.props : startShape.props),</div><div class="diff-removed">-			w: lerp(startShape.props.w, endShape.props.w, t),</div><div class="diff-removed">-			h: lerp(startShape.props.h, endShape.props.h, t),</div><div class="diff-removed">-			scale: lerp(startShape.props.scale, endShape.props.scale, t),</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div> }</div><div> </div><div class="diff-removed">-function getUnscaledLabelSize(editor: Editor, shape: TLGeoShape) {</div><div class="diff-added">+function getUnscopedLabelSize(editor: Editor, shape: TLGeoShape) {</div><div> 	const { richText, font, size, w } = shape.props</div><div> </div><div> 	if (!richText || isEmptyRichText(richText)) {</div><div class="diff-info">@@ -875,4 +866,73 @@ function getUnscaledLabelSize(editor: Editor, shape: TLGeoShape) {</div><div> 		w: textSize.w + LABEL_PADDING * 2,</div><div> 		h: textSize.h + LABEL_PADDING * 2,</div><div> 	}</div><div class="diff-added">+}</div><div class="diff-added">+</div><div class="diff-added">+function getLines(props: TLGeoShape['props'], sw: number) {</div><div class="diff-added">+	switch (propsettamente.geo) {</div><div class="diff-added">+		case 'x-box':</div><div class="diff-added">+			return getXBoxLines(props.w, props.h, sw, props.dash)</div><div class="diff-added">+		case 'check-box':</div><div class="diff-added">+			return getCheckBoxLines(props.w, props.h)</div><div class="diff-added">+		default:</div><div class="diff-added">+			return undefined</div><div class="diff-added">+	}</div><div class="diff-added">+}</div><div class="diff-added">+</div><div class="diff-added">+function getXBoxLines(w: number, h: number, sw: number, dash: TLDefaultDashStyle) {</div><div class="diff-added">+	const inset = dash === 'draw' ? 0.62 : 0</div><div class="diff-added">+</div><div class="diff-added">+	if (dash === 'dashed') {</div><div class="diff-added">+		return [</div><div class="diff-added">+			[new Vec(0, 0), new Vec(w / 2, h / 2)],</div><div class="diff-added">+			[new Vec(w, h), new Vec(w / 2, h / 2)],</div><div class="diff-added">+			[new Vec(0, h), new Vec(w / 2, h / 2)],</div><div class="diff-added">+			[new Vec(w, 0), new Vec(w / 2, h / 2)],</div><div class="diff-added">+		]</div><div class="diff-added">+	}</div><div class="diff-added">+</div><div class="diff-added">+	const clampX = (x: number) => Math.max(0, Math.min(w, x))</div><div class="diff-added">+	const clampY = (y: number) => Math.max(0, Math.min(h, y))</div><div class="diff-added">+</div><div class="diff-added">+	return [</div><div class="diff-added">+		[</div><div class="diff-added">+			new Vec(clampX(sw * inset), clampY(sw * inset)),</div><div class="diff-added">+			new Vec(clampX(w - sw * inset), clampY(h - sw * inset)),</div><div class="diff-added">+		],</div><div class="diff-added">+		[</div><div class="diff-added">+			new Vec(clampX(sw * inset), clampY(h - sw * inset)),</div><div class="diff-added">+			new Vec(clampX(w - sw * inset), clampY(sw * inset)),</div><div class="diff-added">+		],</div><div class="diff-added">+	]</div><div class="diff-added">+}</div><div class="diff-added">+</div><div class="diff-added">+function getCheckBoxLines(w: number, h: number) {</div><div class="diff-added">+	const size = Math.min(w, h) * 0.82</div><div class="diff-added">+	const ox = (w - size) / 2</div><div class="diff-added">+	const oy = (h - size) / 2</div><div class="diff-added">+</div><div class="diff-added">+	const clampX = (x: number) => Math.max(0, Math.min(w, x))</div><div class="diff-added">+	const clampY = (y: number) => Math.max(0, Math.min(h, y))</div><div class="diff-added">+</div><div class="diff-added">+	return [</div><div class="diff-added">+		[</div><div class="diff-added">+			new Vec(clampX(ox + size * 0.25), clampY(oy + size * 0.52)),</div><div class="diff-added">+			new Vec(clampX(ox + size * 0.45), clampY(oy + size * 0.82)),</div><div class="diff-added">+		],</div><div class="diff-added">+		[</div><div class="diff-added">+			new Vec(clampX(ox + size * 0.45), clampY(oy + size * 0.82)),</div><div class="diff-added">+			new Vec(clampX(ox + size * 0.82), clampY(oy + size * 0.22)),</div><div class="diff-added">+		],</div><div class="diff-added">+	]</div><div class="diff-added">+}</div><div class="diff-added">+</div><div class="diff-added">+export function getCentroidOfRegularPolygon(points: VecLike[]) {</div><div class="diff-added">+	const len = points.length</div><div class="diff-added">+	let x = 0</div><div class="diff-added">+	let y = 0</div><div class="diff-added">+	for (let i = 0; i < len; i++) {</div><div class="diff-added">+		x += points[i].x</div><div class="diff-added">+		y += points[i].y</div><div class="diff-added">+	}</div><div class="diff-added">+	return new Vec(x / len, y / len)</div><div> }</div><div>\ No newline at end of file</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    