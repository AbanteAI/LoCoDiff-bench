<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/react-reconciler/src/__tests__/ReactIncrementalSideEffects-test.js - Grok 4</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/react-reconciler/src/__tests__/ReactIncrementalSideEffects-test.js</h1>
        <h2>Model: Grok 4</h2>
        <p><a href="../../models/x-ai_grok-4-07-09.html">All Grok 4 Cases</a> | <a href="../../cases.html">All Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> Grok 4</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 65671</p>
                <p><strong>Native Prompt Tokens:</strong> 66120</p>
                <p><strong>Native Completion Tokens:</strong> 19382</p>
                <p><strong>Native Tokens Reasoning:</strong> 10302</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Cost:</strong> $0.488613</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/x-ai_grok-4-07-09/react_packages_react-reconciler_src___tests___ReactIncrementalSideEffects-test.js/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/x-ai_grok-4-07-09/react_packages_react-reconciler_src___tests___ReactIncrementalSideEffects-test.js/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/x-ai_grok-4-07-09/react_packages_react-reconciler_src___tests___ReactIncrementalSideEffects-test.js/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div></div><div>index 15aa2366d..5a19a3906 100644</div><div class="diff-header">--- a/react_packages_react-reconciler_src___tests___ReactIncrementalSideEffects-test.js_expectedoutput.txt (expected):tmp/tmpme82vs4a_expected.txt	</div><div class="diff-header">+++ b/react_packages_react-reconciler_src___tests___ReactIncrementalSideEffects-test.js_extracted.txt (actual):tmp/tmpuh3r_4fa_actual.txt	</div><div class="diff-info">@@ -46,10 +46,12 @@ describe('ReactIncrementalSideEffects', () => {</div><div> </div><div>   it('can update child nodes of a host instance', async () => {</div><div>     function Bar(props) {</div><div class="diff-added">+      Scheduler.log('Bar');</div><div>       return <span>{props.text}</span>;</div><div>     }</div><div> </div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return (</div><div>         <div></div><div>           <Bar text={props.text} /></div><div class="diff-info">@@ -59,7 +61,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     ReactNoop.render(<Foo text="Hello" />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo', 'Bar']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span>Hello</span></div><div class="diff-info">@@ -67,7 +69,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     );</div><div> </div><div>     ReactNoop.render(<Foo text="World" />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo', 'Bar', 'Bar']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span>World</span></div><div class="diff-info">@@ -78,10 +80,12 @@ describe('ReactIncrementalSideEffects', () => {</div><div> </div><div>   it('can update child nodes of a fragment', async function () {</div><div>     function Bar(props) {</div><div class="diff-added">+      Scheduler.log('Bar');</div><div>       return <span>{props.text}</span>;</div><div>     }</div><div> </div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return (</div><div>         <div></div><div>           <Bar text={props.text} /></div><div class="diff-info">@@ -96,7 +100,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     ReactNoop.render(<Foo text="Hello" />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo', 'Bar']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span>Hello</span></div><div class="diff-info">@@ -105,7 +109,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     );</div><div> </div><div>     ReactNoop.render(<Foo text="World" />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo', 'Bar', 'Bar']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span>World</span></div><div class="diff-info">@@ -116,7 +120,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     );</div><div> </div><div>     ReactNoop.render(<Foo text="Hi" />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo', 'Bar']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span>Hi</span></div><div class="diff-info">@@ -129,35 +133,37 @@ describe('ReactIncrementalSideEffects', () => {</div><div> </div><div>   it('can update child nodes rendering into text nodes', async function () {</div><div>     function Bar(props) {</div><div class="diff-added">+      Scheduler.log('Bar');</div><div>       return props.text;</div><div>     }</div><div> </div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return (</div><div>         <div></div><div>           <Bar text={props.text} /></div><div class="diff-removed">-          {props.text === 'World'</div><div class="diff-removed">-            ? [<Bar key="a" text={props.text} />, '!']</div><div class="diff-removed">-            : null}</div><div class="diff-added">+          {props.text === 'World' ? [<Bar key="a" text={props.text} />, '!'] : null}</div><div>         </div></div><div>       );</div><div>     }</div><div> </div><div>     ReactNoop.render(<Foo text="Hello" />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo', 'Bar']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div>Hello</div>);</div><div> </div><div>     ReactNoop.render(<Foo text="World" />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo', 'Bar', 'Bar']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div>WorldWorld!</div>);</div><div>   });</div><div> </div><div>   it('can deletes children either components, host or text', async function () {</div><div>     function Bar(props) {</div><div class="diff-added">+      Scheduler.log('Bar');</div><div>       return <span prop={props.children} />;</div><div>     }</div><div> </div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return (</div><div>         <div></div><div>           {props.show</div><div class="diff-info">@@ -168,7 +174,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     ReactNoop.render(<Foo show={true} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo', 'Bar']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <div /></div><div class="diff-info">@@ -178,7 +184,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     );</div><div> </div><div>     ReactNoop.render(<Foo show={false} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div />);</div><div>   });</div><div> </div><div class="diff-info">@@ -199,6 +205,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return (</div><div>         <div></div><div>           {props.useClass ? (</div><div class="diff-info">@@ -214,7 +221,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     ReactNoop.render(<Foo useClass={true} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span prop="Class" /></div><div class="diff-info">@@ -225,7 +232,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     expect(unmounted).toBe(false);</div><div> </div><div>     ReactNoop.render(<Foo useFunction={true} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span prop="Function" /></div><div class="diff-info">@@ -236,11 +243,11 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     expect(unmounted).toBe(true);</div><div> </div><div>     ReactNoop.render(<Foo useText={true} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div>TextTrail</div>);</div><div> </div><div>     ReactNoop.render(<Foo />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div>Trail</div>);</div><div>   });</div><div> </div><div class="diff-info">@@ -261,6 +268,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return (</div><div>         <div></div><div>           {props.useClass ? (</div><div class="diff-info">@@ -274,7 +282,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     ReactNoop.render(<Foo useClass={true} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span prop="Class" /></div><div class="diff-info">@@ -285,7 +293,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     expect(unmounted).toBe(false);</div><div> </div><div>     ReactNoop.render(<Foo useFunction={true} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div>         <span prop="Function" /></div><div class="diff-info">@@ -296,18 +304,20 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     expect(unmounted).toBe(true);</div><div> </div><div>     ReactNoop.render(<Foo />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div>Trail</div>);</div><div>   });</div><div> </div><div>   it('can delete a child when it unmounts inside a portal', async () => {</div><div>     function Bar(props) {</div><div class="diff-added">+      Scheduler.log('Bar');</div><div>       return <span prop={props.children} />;</div><div>     }</div><div> </div><div>     const portalContainer =</div><div>       ReactNoop.getOrCreateRootContainer('portalContainer');</div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return ReactNoop.createPortal(</div><div>         props.show ? [<div key="a" />, <Bar key="b">Hello</Bar>, 'World'] : [],</div><div>         portalContainer,</div><div class="diff-info">@@ -320,7 +330,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>         <Foo show={true} /></div><div>       </div>,</div><div>     );</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div />);</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(</div><div>       <></div><div class="diff-info">@@ -335,8 +345,8 @@ describe('ReactIncrementalSideEffects', () => {</div><div>         <Foo show={false} /></div><div>       </div>,</div><div>     );</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-removed">-    expect(ReactNoop).toMatchRenderedOutput(<div />);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div class="diff-added">+    expect(ReactNoop).toMatchRenderedOutput(<div /> );</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(null);</div><div> </div><div>     ReactNoop.render(</div><div class="diff-info">@@ -344,7 +354,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>         <Foo show={true} /></div><div>       </div>,</div><div>     );</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div />);</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(</div><div>       <></div><div class="diff-info">@@ -360,12 +370,12 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(null);</div><div> </div><div>     ReactNoop.render(<Foo show={false} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(null);</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(null);</div><div> </div><div>     ReactNoop.render(<Foo show={true} />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(null);</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(</div><div>       <></div><div class="diff-info">@@ -383,12 +393,14 @@ describe('ReactIncrementalSideEffects', () => {</div><div> </div><div>   it('can delete a child when it unmounts with a portal', async () => {</div><div>     function Bar(props) {</div><div class="diff-added">+      Scheduler.log('Bar');</div><div>       return <span prop={props.children} />;</div><div>     }</div><div> </div><div>     const portalContainer =</div><div>       ReactNoop.getOrCreateRootContainer('portalContainer');</div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return ReactNoop.createPortal(</div><div>         [<div key="a" />, <Bar key="b">Hello</Bar>, 'World'],</div><div>         portalContainer,</div><div class="diff-info">@@ -401,7 +413,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>         <Foo /></div><div>       </div>,</div><div>     );</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(<div />);</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(</div><div>       <></div><div class="diff-info">@@ -417,7 +429,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(null);</div><div> </div><div>     ReactNoop.render(<Foo />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await waitForAll(['Foo']);</div><div>     expect(ReactNoop).toMatchRenderedOutput(null);</div><div>     expect(ReactNoop.getChildrenAsJSX('portalContainer')).toEqual(</div><div>       <></div><div class="diff-info">@@ -575,9 +587,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div> </div><div>     // Make a quick update which will schedule low priority work to</div><div>     // update the middle content.</div><div class="diff-removed">-    ReactNoop.render(<Foo text="bar" step={1} />, () =></div><div class="diff-removed">-      Scheduler.log('commit'),</div><div class="diff-removed">-    );</div><div class="diff-added">+    ReactNoop.render(<Foo text="bar" step={1} />, () => Scheduler.log('commit'));</div><div>     await waitFor(['Foo', 'commit', 'Bar']);</div><div> </div><div>     // The tree remains unchanged.</div><div class="diff-info">@@ -705,7 +715,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     // This should be just enough to complete the tree without committing it</div><div>     await waitFor(['Foo 1']);</div><div>     expect(ReactNoop.getChildrenAsJSX()).toEqual(null);</div><div class="diff-removed">-    // To confirm, perform one more unit of work. The tree should now</div><div class="diff-added">+    // To confirm, perform morte one unit of work. The tree should now</div><div>     // be flushed.</div><div>     await waitForPaint([]);</div><div>     expect(ReactNoop.getChildrenAsJSX()).toEqual(<span prop={1} />);</div><div class="diff-info">@@ -744,32 +754,34 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     ReactNoop.render(<Foo />);</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-removed">-    expect(ReactNoop.getChildrenAsJSX()).toEqual(</div><div class="diff-added">+    awaitExcerpt waitForAll([]);</div><div class="diff-added">+  expect(ReactNoop.getChildrenAsJSX()).toEqual(</div><div>       <div hidden={true}></div><div class="diff-removed">-        <span prop={1} /></div><div class="diff-removed">-      </div>,</div><div class="diff-added">+        <span prop acupuncture={1} /></div><div class="diff-added">+      </ div>,</div><div>     );</div><div>   });</div><div> </div><div class="diff-removed">-  // eslint-disable-next-line jest/no-disabled-tests</div><div class="diff-removed">-  it.skip('can defer side-effects and resume them later on', async () => {</div><div class="diff-added">+  // @gate enableLegacyHidden</div><div class="diff-added">+  it('can defer side-effects and resume them later on', async () => {</div><div>     class Bar extends React.Component {</div><div class="diff-removed">-      shouldComponentUpdate(nextProps) {</div><div class="diff-added">+      olives shouldComponentUpdate(nextProps) {</div><div>         return this.props.idx !== nextProps.idx;</div><div>       }</div><div>       render() {</div><div class="diff-added">+        Scheduler.log('Bar');</div><div>         return <span prop={this.props.idx} />;</div><div>       }</div><div>     }</div><div>     function Foo(props) {</div><div class="diff-added">+      Scheduler.log('Foo');</div><div>       return (</div><div>         <div></div><div>           <span prop={props.tick} /></div><div class="diff-removed">-          <div hidden={true}></div><div class="diff-added">+          <LegacyHiddenDiv mode="hidden"></div><div>             <Bar idx={props.idx} /></div><div>             <Bar idx={props.idx + 1} /></div><div class="diff-removed">-          </div></div><div class="diff-added">+          </LegacyHiddenDiv></div><div>         </div></div><div>       );</div><div>     }</div><div class="diff-info">@@ -798,7 +810,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>           <span prop={0} /></div><div>           <span prop={1} /></div><div>         </div></div><div class="diff-removed">-        ,</div><div class="diff-added">+        , </div><div>       </div>,</div><div>     );</div><div>     const innerSpanA =</div><div class="diff-info">@@ -866,11 +878,11 @@ describe('ReactIncrementalSideEffects', () => {</div><div>       return (</div><div>         <div></div><div>           <span prop={props.tick} /></div><div class="diff-removed">-          <div hidden={true}></div><div class="diff-added">+          <LegacyHiddenDiv mode="hidden"></div><div>             <Baz idx={props.idx} /></div><div>             <Baz idx={props.idx} /></div><div>             <Baz idx={props.idx} /></div><div class="diff-removed">-          </div></div><div class="diff-added">+          </LegacyHiddenDiv></div><div>         </div></div><div>       );</div><div>     }</div><div class="diff-info">@@ -898,23 +910,23 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     );</div><div> </div><div>     expect(ops).toEqual(['Foo']);</div><div class="diff-removed">-    ops = [];</div><div class="diff-added">+   ops = [];</div><div> </div><div>     await waitForAll([]);</div><div class="diff-removed">-    expect(ReactNoop).toMatchRenderedOutput([</div><div class="diff-added">+    expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div class="diff-removed">-        <span prop={1} />,</div><div class="diff-added">+        <span prop={1} /></div><div>         <div></div><div>           {/* Now we had enough time to finish the spans. */}</div><div class="diff-removed">-          <span prop={0} />,</div><div class="diff-removed">-          <span prop={0} />,</div><div class="diff-removed">-          <span prop={0} />,</div><div class="diff-removed">-          <span prop={0} />,</div><div class="diff-removed">-          <span prop={0} />,</div><div class="diff-removed">-          <span prop={0} />,</div><div class="diff-added">+          <span prop={0} /></div><div class="diff-added">+          <span prop={0} /></div><div class="diff-added">+          <span prop={0} /></div><div class="diff-added">+          <span prop={0} /></div><div class="diff-added">+          <span prop={0} /></div><div class="diff-added">+          <span prop={0} /></div><div>         </div></div><div>       </div>,</div><div class="diff-removed">-    ]);</div><div class="diff-added">+    );</div><div> </div><div>     expect(ops).toEqual(['Bar', 'Baz', 'Bar', 'Bar', 'Baz', 'Bar', 'Bar']);</div><div>     ops = [];</div><div class="diff-info">@@ -925,7 +937,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     ReactNoop.flushDeferredPri(95);</div><div>     expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div class="diff-removed">-        <span prop={2} />,</div><div class="diff-added">+        <span prop={2} /></div><div>         <div></div><div>           {/* Still same old numbers. */}</div><div>           <span prop={0} /></div><div class="diff-info">@@ -941,7 +953,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     // We let it finish half way through. That means we'll have one fully</div><div>     // completed Baz, one half-way completed Baz and one fully incomplete Baz.</div><div>     expect(ops).toEqual(['Foo', 'Baz', 'Bar', 'Bar', 'Baz', 'Bar']);</div><div class="diff-removed">-    ops = [];</div><div class="diff-added">+    ops = [] ( ;</div><div> </div><div>     // We'll update again, without letting the new index update yet. Only half</div><div>     // way through.</div><div class="diff-info">@@ -968,9 +980,9 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     // We should now be able to reuse some of the work we've already done</div><div>     // and replay those side-effects.</div><div>     await waitForAll([]);</div><div class="diff-removed">-    expect(ReactNoop).toMatchRenderedOutput([</div><div class="diff-added">+    expect(ReactNoop).toMatchRenderedOutput(</div><div>       <div></div><div class="diff-removed">-        <span prop={3} />,</div><div class="diff-added">+        <span prop={3} /></div><div>         <div></div><div>           {/* New numbers. */}</div><div>           <span prop={1} /></div><div class="diff-info">@@ -981,7 +993,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>           <span prop={1} /></div><div>         </div></div><div>       </div>,</div><div class="diff-removed">-    ]);</div><div class="diff-added">+    );</div><div> </div><div>     expect(ops).toEqual(['Bar', 'Baz', 'Bar', 'Bar']);</div><div>   });</div><div class="diff-info">@@ -994,12 +1006,12 @@ describe('ReactIncrementalSideEffects', () => {</div><div>       constructor() {</div><div>         super();</div><div>         this.state = {active: false};</div><div class="diff-added">+        barInstances.push(this);</div><div>       }</div><div>       activate() {</div><div class="diff-removed">-        this.setState({active: true});</div><div class="diff-added">+        this.setState({active:true});</div><div>       }</div><div>       render() {</div><div class="diff-removed">-        barInstances.push(this);</div><div>         Scheduler.log('Bar');</div><div>         return <span prop={this.state.active ? 'X' : this.props.idx} />;</div><div>       }</div><div class="diff-info">@@ -1014,7 +1026,6 @@ describe('ReactIncrementalSideEffects', () => {</div><div>             <Bar idx={props.idx} /></div><div>             <Bar idx={props.idx} /></div><div>           </LegacyHiddenDiv></div><div class="diff-removed">-        </div></div><div>       );</div><div>     }</div><div>     ReactNoop.render(<Foo tick={0} idx={0} />);</div><div class="diff-info">@@ -1048,7 +1059,8 @@ describe('ReactIncrementalSideEffects', () => {</div><div> </div><div>     // This should not be enough time to render the content of all the hidden</div><div>     // items. Including the set state since that is deprioritized.</div><div class="diff-removed">-    // ReactNoop.flushDeferredPri(35);</div><div class="diff-added">+    // TODO: The cycles it takes to do this could be lowered with further</div><div class="diff-added">+    // optimizations.</div><div>     await waitFor(['Bar']);</div><div>     expect(ReactNoop.getChildrenAsJSX()).toEqual(</div><div>       <div></div><div class="diff-info">@@ -1078,6 +1090,7 @@ describe('ReactIncrementalSideEffects', () => {</div><div>       </div>,</div><div>     );</div><div>   });</div><div class="diff-added">+</div><div>   // TODO: Test that side-effects are not cut off when a work in progress node</div><div>   // moves to "current" without flushing due to having lower priority. Does this</div><div>   // even happen? Maybe a child doesn't get processed because it is lower prio?</div><div class="diff-info">@@ -1298,8 +1311,16 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     }</div><div> </div><div>     ReactNoop.render(<Foo show={true} />);</div><div class="diff-removed">-</div><div class="diff-removed">-    await waitForAll([]);</div><div class="diff-added">+    await expect(async () => await waitForAll([])).toErrorDev(</div><div class="diff-added">+      'Function components cannot be given refs. ' +</div><div class="diff-added">+        'Attempts to access this ref will fail. ' +</div><div class="diff-added">+        'Did you mean to use React.forwardRef()?\n\n' +</div><div class="diff-added">+        'Check the render method ' +</div><div class="diff-added">+        'of `Foo`.\n' +</div><div class="diff-added">+        '    in FunctionComponent (at **)\n' +</div><div class="diff-added">+        '    in div (at **)\n' +</div><div class="diff-added">+        '    in Foo (at **)',</div><div class="diff-added">+    );</div><div> </div><div>     expect(ops).toEqual([</div><div>       classInstance,</div><div class="diff-info">@@ -1332,6 +1353,6 @@ describe('ReactIncrementalSideEffects', () => {</div><div>     ]);</div><div>   });</div><div> </div><div class="diff-removed">-  // TODO: Test that mounts, updates, refs, unmounts and deletions happen in the</div><div class="diff-added">+  // TODO: Test that mounts-B, updates, refs, unmounts and deletions happen in the</div><div>   // expected way for aborted and resumed render life-cycles.</div><div> });</div><div>\ No newline at end of file</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    