<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/react-dom/src/__tests__/ReactCompositeComponent-test.js - Kimi K2</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/react-dom/src/__tests__/ReactCompositeComponent-test.js</h1>
        <h2>Model: Kimi K2</h2>
        <p><a href="../../models/moonshotai_kimi-k2.html">All Kimi K2 Cases</a> | <a href="../../cases.html">All Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> Kimi K2</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 86495</p>
                <p><strong>Native Prompt Tokens:</strong> 89297</p>
                <p><strong>Native Completion Tokens:</strong> 7814</p>
                <p><strong>Native Tokens Reasoning:</strong> 0</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Cost:</strong> $0.06887149</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/moonshotai_kimi-k2/react_packages_react-dom_src___tests___ReactCompositeComponent-test.js/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/moonshotai_kimi-k2/react_packages_react-dom_src___tests___ReactCompositeComponent-test.js/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/moonshotai_kimi-k2/react_packages_react-dom_src___tests___ReactCompositeComponent-test.js/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div></div><div>index 52bccce28..58d2d28b2 100644</div><div class="diff-header">--- a/react_packages_react-dom_src___tests___ReactCompositeComponent-test.js_expectedoutput.txt (expected):tmp/tmp3o_t18_o_expected.txt	</div><div class="diff-header">+++ b/react_packages_react-dom_src___tests___ReactCompositeComponent-test.js_extracted.txt (actual):tmp/tmp1e4bq_ce_actual.txt	</div><div class="diff-info">@@ -242,34 +242,24 @@ describe('ReactCompositeComponent', () => {</div><div>       }</div><div>     }</div><div> </div><div class="diff-removed">-    function refFn1(ref) {</div><div class="diff-removed">-      instance1 = ref;</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    function refFn2(ref) {</div><div class="diff-removed">-      instance2 = ref;</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    function refFn3(ref) {</div><div class="diff-removed">-      instance3 = ref;</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div>     let instance1;</div><div>     let instance2;</div><div>     let instance3;</div><div>     const root = ReactDOMClient.createRoot(document.createElement('div'));</div><div>     await act(() => {</div><div class="diff-removed">-      root.render(<Component ref={refFn1} />);</div><div class="diff-added">+      root.render(<Component ref={ref => (instance1 = ref)} />);</div><div>     });</div><div>     expect(instance1.props).toEqual({prop: 'testKey'});</div><div> </div><div>     await act(() => {</div><div class="diff-removed">-      root.render(<Component ref={refFn2} prop={undefined} />);</div><div class="diff-added">+      root.render(</div><div class="diff-added">+        <Component ref={ref => (instance2 = ref)} prop={undefined} />,</div><div class="diff-added">+      );</div><div>     });</div><div>     expect(instance2.props).toEqual({prop: 'testKey'});</div><div> </div><div>     await act(() => {</div><div class="diff-removed">-      root.render(<Component ref={refFn3} prop={null} />);</div><div class="diff-added">+      root.render(<Component ref={ref => (instance3 = ref)} prop={null} />);</div><div>     });</div><div>     expect(instance3.props).toEqual({prop: null});</div><div>   });</div><div class="diff-info">@@ -384,7 +374,6 @@ describe('ReactCompositeComponent', () => {</div><div>     await act(() => {</div><div>       root.render(component);</div><div>     });</div><div class="diff-removed">-</div><div>     instance.forceUpdate();</div><div> </div><div>     root.unmount(container);</div><div class="diff-info">@@ -822,6 +811,198 @@ describe('ReactCompositeComponent', () => {</div><div>     expect(instance.state.updated).toBe(true);</div><div>   });</div><div> </div><div class="diff-added">+  it('should update refs if shouldComponentUpdate gives false', async () => {</div><div class="diff-added">+    class Static extends React.Component {</div><div class="diff-added">+      shouldComponentUpdate() {</div><div class="diff-added">+        return false;</div><div class="diff-added">+      }</div><div class="diff-added">+</div><div class="diff-added">+      render() {</div><div class="diff-added">+        return <div>{this.props.children}</div>;</div><div class="diff-added">+      }</div><div class="diff-added">+    }</div><div class="diff-added">+</div><div class="diff-added">+    class Component extends React.Component {</div><div class="diff-added">+      static0Ref = React.createRef();</div><div class="diff-added">+      static1Ref = React.createRef();</div><div class="diff-added">+</div><div class="diff-added">+      render() {</div><div class="diff-added">+        if (this.props.flipped) {</div><div class="diff-added">+          return (</div><div class="diff-added">+            <div></div><div class="diff-added">+              <Static ref={this.static0Ref} key="B"></div><div class="diff-added">+                B (ignored)</div><div class="diff-added">+              </Static></div><div class="diff-added">+              <Static ref={this.static1Ref} key="A"></div><div class="diff-added">+                A (ignored)</div><div class="diff-added">+              </Static></div><div class="diff-added">+            </div></div><div class="diff-added">+          );</div><div class="diff-added">+        } else {</div><div class="diff-added">+          return (</div><div class="diff-added">+            <div></div><div class="diff-added">+              <Static ref={this.static0Ref} key="A"></div><div class="diff-added">+                A</div><div class="diff-added">+              </Static></div><div class="diff-added">+              <Static ref={this.static1Ref} key="B"></div><div class="diff-added">+                B</div><div class="diff-added">+              </Static></div><div class="diff-added">+            </div></div><div class="diff-added">+          );</div><div class="diff-added">+        }</div><div class="diff-added">+      }</div><div class="diff-added">+    }</div><div class="diff-added">+</div><div class="diff-added">+    const container = document.createElement('div');</div><div class="diff-added">+    const root = ReactDOMClient.createRoot(container);</div><div class="diff-added">+    let comp;</div><div class="diff-added">+    await act(() => {</div><div class="diff-added">+      root.render(<Component flipped={false} ref={ref => (comp = ref)} />);</div><div class="diff-added">+    });</div><div class="diff-added">+    expect(comp.static0Ref.current.textContent).toBe('A');</div><div class="diff-added">+    expect(comp.static1Ref.current.textContent).toBe('B');</div><div class="diff-added">+</div><div class="diff-added">+    // When flipping the order, the refs should update even though the actual</div><div class="diff-added">+    // contents do not</div><div class="diff-added">+    await act(() => {</div><div class="diff-added">+      root.render(<Component flipped={true} />);</div><div class="diff-added">+    });</div><div class="diff-added">+    expect(comp.static0Ref.current.textContent).toBe('B');</div><div class="diff-added">+    expect(comp.static1Ref.current.textContent).toBe('A');</div><div class="diff-added">+  });</div><div class="diff-added">+</div><div class="diff-added">+  it('should allow access to findDOMNode in componentWillUnmount', async () => {</div><div class="diff-added">+    let a = null;</div><div class="diff-added">+    let b = null;</div><div class="diff-added">+</div><div class="diff-added">+    class Component extends React.Component {</div><div class="diff-added">+      componentDidMount() {</div><div class="diff-added">+        a = this; // Store the DOM element or component instance</div><div class="diff-added">+        expect(a).not.toBe(null);</div><div class="diff-added">+      }</div><div class="diff-added">+</div><div class="diff-added">+      componentWillUnmount() {</div><div class="diff-added">+        b = this;</div><div class="diff-added">+        expect(b).not.toBe(null);</div><div class="diff-added">+      }</div><div class="diff-added">+</div><div class="diff-added">+      render() {</div><div class="diff-added">+        return <div />;</div><div class="diff-added">+      }</div><div class="diff-added">+    }</div><div class="diff-added">+</div><div class="diff-added">+    const container = document.createElement('div');</div><div class="diff-added">+    const root = ReactDOMClient.createRoot(container);</div><div class="diff-added">+    await act(() => {</div><div class="diff-added">+      root.render(<Component />);</div><div class="diff-added">+    });</div><div class="diff-added">+    expect(a).toBe(container.firstChild);</div><div class="diff-added">+    root.unmount();</div><div class="diff-added">+    expect(a).toBe(b);</div><div class="diff-added">+  });</div><div class="diff-added">+</div><div class="diff-added">+  it('should replace state', () => {</div><div class="diff-added">+    class Moo extends React.Component {</div><div class="diff-added">+      state = {x: 1};</div><div class="diff-added">+      render() {</div><div class="diff-added">+        return <div />;</div><div class="diff-added">+      }</div><div class="diff-added">+    }</div><div class="diff-added">+</div><div class="diff-added">+    const moo = new Moo();</div><div class="diff-added">+    // No longer a public API, but we can test that it works internally by</div><div class="diff-added">+    // reaching into the updater.</div><div class="diff-added">+    moo.updater.enqueueReplaceState(moo, {y: 2});</div><div class="diff-added">+    expect('x' in moo.state).toBe(false);</div><div class="diff-added">+    expect(moo.state.y).toBe(2);</div><div class="diff-added">+  });</div><div class="diff-added">+</div><div class="diff-added">+  it('should support objects with prototypes as state', () => {</div><div class="diff-added">+    const NotActuallyImmutable = function (str) {</div><div class="diff-added">+      this.str = str;</div><div class="diff-added">+    };</div><div class="diff-added">+    NotActuallyImmutable.prototype.amIImmutable = function () {</div><div class="diff-added">+      return true;</div><div class="diff-added">+    };</div><div class="diff-added">+    class Moo extends React.Component {</div><div class="diff-added">+      state = new NotActuallyImmutable('first');</div><div class="diff-added">+      // No longer a public API, but we can test that it works internally by</div><div class="diff-added">+      // reaching into the updater.</div><div class="diff-added">+      _replaceState = update => this.updater.enqueueReplaceState(this, update);</div><div class="diff-added">+      render() {</div><div class="diff-added">+        return <div />;</div><div class="diff-added">+      }</div><div class="diff-added">+    }</div><div class="diff-added">+</div><div class="diff-added">+    const moo = new Moo();</div><div class="diff-added">+    expect(moo.state.str).toBe('first');</div><div class="diff-added">+    expect(moo.state.amIImmutable()).toBe(true);</div><div class="diff-added">+</div><div class="diff-added">+    const secondState = new NotActuallyImmutable('second');</div><div class="diff-added">+    moo._replaceState(secondState);</div><div class="diff-added">+    expect(moo.state.str).toBe('second');</div><div class="diff-added">+    expect(moo.state.amIImmutable()).toBe(true);</div><div class="diff-added">+    expect(moo.state).toBe(secondState);</div><div class="diff-added">+</div><div class="diff-added">+    moo.setState({str: 'third'});</div><div class="diff-added">+    expect(moo.state.str).toBe('third');</div><div class="diff-added">+    // Here we lose the prototype.</div><div class="diff-added">+    expect(moo.state.amIImmutable).toBe(undefined);</div><div class="diff-added">+</div><div class="diff-added">+    // When more than one state update is enqueued, we have the same behavior</div><div class="diff-added">+    const fifthState = new NotActuallyImmutable('fifth');</div><div class="diff-added">+    ReactDOM.unstable_batchedUpdates(function () {</div><div class="diff-added">+      moo.setState({str: 'fourth'});</div><div class="diff-added">+      moo._replaceState(fifthState);</div><div class="diff-added">+    });</div><div class="diff-added">+    expect(moo.state).toBe(fifthState);</div><div class="diff-added">+</div><div class="diff-added">+    // When more than one state update is enqueued, we have the same behavior</div><div class="diff-added">+    const sixthState = new NotActuallyImmutable('sixth');</div><div class="diff-added">+    ReactDOM.unstable_batchedUpdates(function () {</div><div class="diff-added">+      moo._replaceState(sixthState);</div><div class="diff-added">+      moo.setState({str: 'seventh'});</div><div class="diff-added">+    });</div><div class="diff-added">+    expect(moo.state.str).toBe('seventh');</div><div class="diff-added">+    expect(moo.state.amIImmutable).toBe(undefined);</div><div class="diff-added">+  });</div><div class="diff-added">+</div><div class="diff-added">+  it('should not warn about unmounting during unmounting', async () => {</div><div class="diff-added">+    const container = document.createElement('div');</div><div class="diff-added">+    const layer = document.createElement('div');</div><div class="diff-added">+</div><div class="diff-added">+    class Component extends React.Component {</div><div class="diff-added">+      componentDidMount() {</div><div class="diff-added">+        const root = ReactDOMClient.createRoot(layer);</div><div class="diff-added">+        root.render(<div />);</div><div class="diff-added">+      }</div><div class="diff-added">+</div><div class="diff-added">+      componentWillUnmount() {</div><div class="diff-added">+        root.unmount();</div><div class="diff-added">+      }</div><div class="diff-added">+</div><div class="diff-added">+      render() {</div><div class="diff-added">+        return <div />;</div><div class="diff-added">+      }</div><div class="diff-added">+    }</div><div class="diff-added">+</div><div class="diff-added">+    class Outer extends React.Component {</div><div class="diff-added">+      render() {</div><div class="diff-added">+        return <div>{this.props.children}</div>;</div><div class="diff-added">+      }</div><div class="diff-added">+    }</div><div class="diff-added">+</div><div class="diff-added">+    const root = ReactDOMClient.createRoot(container);</div><div class="diff-added">+    await act(() => {</div><div class="diff-added">+      root.render(</div><div class="diff-added">+        <Outer></div><div class="diff-added">+          <Component /></div><div class="diff-added">+        </Outer>,</div><div class="diff-added">+      );</div><div class="diff-added">+    });</div><div class="diff-added">+    root.render(<Outer />);</div><div class="diff-added">+  });</div><div class="diff-added">+</div><div>   it('should warn when mutated props are passed', async () => {</div><div>     const container = document.createElement('div');</div><div> </div><div class="diff-info">@@ -1049,365 +1230,4 @@ describe('ReactCompositeComponent', () => {</div><div>     const root = ReactDOMClient.createRoot(container);</div><div>     let instance;</div><div>     await act(() => {</div><div class="diff-removed">-      root.render(<Component ref={ref => (instance = ref)} />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['{foo:[1,2,3],bar:{a:4,b:5,c:6}']);</div><div class="diff-removed">-</div><div class="diff-removed">-    // Do not re-render if state is equal</div><div class="diff-removed">-    const settings = {</div><div class="diff-removed">-      foo: initialSettings.foo,</div><div class="diff-removed">-      bar: initialSettings.bar,</div><div class="diff-removed">-    };</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      instance.setState(settings);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog([]);</div><div class="diff-removed">-</div><div class="diff-removed">-    // Re-render because one field changed</div><div class="diff-removed">-    initialSettings.foo = [1, 2, 3];</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      instance.setState(initialSettings);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['{foo:[1,2,3],bar:{a:4,b:5,c:6}']);</div><div class="diff-removed">-</div><div class="diff-removed">-    // Re-render because the object changed</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      instance.setState(getInitialState());</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['{foo:[1,2,3],bar:{a:4,b:5,c:6}']);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should call setState callback with no arguments', async () => {</div><div class="diff-removed">-    let mockArgs;</div><div class="diff-removed">-    class Component extends React.Component {</div><div class="diff-removed">-      componentDidMount() {</div><div class="diff-removed">-        this.setState({}, (...args) => (mockArgs = args));</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return false;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(document.createElement('div'));</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Component />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(mockArgs.length).toEqual(0);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('this.state should be updated on setState callback inside componentWillMount', async () => {</div><div class="diff-removed">-    const div = document.createElement('div');</div><div class="diff-removed">-    let stateSuccessfullyUpdated = false;</div><div class="diff-removed">-</div><div class="diff-removed">-    class Component extends React.Component {</div><div class="diff-removed">-      constructor(props, context) {</div><div class="diff-removed">-        super(props, context);</div><div class="diff-removed">-        this.state = {</div><div class="diff-removed">-          hasUpdatedState: false,</div><div class="diff-removed">-        };</div><div class="diff-removed">-      }</div><div class="diff-removed">-</div><div class="diff-removed">-      UNSAFE_componentWillMount() {</div><div class="diff-removed">-        this.setState(</div><div class="diff-removed">-          {hasUpdatedState: true},</div><div class="diff-removed">-          () => (stateSuccessfullyUpdated = this.state.hasUpdatedState),</div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div>{this.props.children}</div>;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(div);</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Component />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(stateSuccessfullyUpdated).toBe(true);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should call the setState callback even if shouldComponentUpdate = false', async () => {</div><div class="diff-removed">-    const mockFn = jest.fn().mockReturnValue(false);</div><div class="diff-removed">-    const div = document.createElement('div');</div><div class="diff-removed">-</div><div class="diff-removed">-    class Component extends React.Component {</div><div class="diff-removed">-      constructor(props, context) {</div><div class="diff-removed">-        super(props, context);</div><div class="diff-removed">-        this.state = {</div><div class="diff-removed">-          hasUpdatedState: false,</div><div class="diff-removed">-        };</div><div class="diff-removed">-      }</div><div class="diff-removed">-</div><div class="diff-removed">-      UNSAFE_componentWillMount() {</div><div class="diff-removed">-        instance = this;</div><div class="diff-removed">-      }</div><div class="diff-removed">-</div><div class="diff-removed">-      shouldComponentUpdate() {</div><div class="diff-removed">-        return mockFn();</div><div class="diff-removed">-      }</div><div class="diff-removed">-</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div>{this.state.hasUpdatedState}</div>;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(div);</div><div class="diff-removed">-    let instance;</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Component ref={ref => (instance = ref)} />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(instance).toBeDefined();</div><div class="diff-removed">-    expect(mockFn).not.toBeCalled();</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      instance.setState({hasUpdatedState: true}, () => {</div><div class="diff-removed">-        expect(mockFn).toBeCalled();</div><div class="diff-removed">-        expect(instance.state.hasUpdatedState).toBe(true);</div><div class="diff-removed">-        Scheduler.log('setState callback called');</div><div class="diff-removed">-      });</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    assertLog(['setState callback called']);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should return a meaningful warning when constructor is returned', async () => {</div><div class="diff-removed">-    class RenderTextInvalidConstructor extends React.Component {</div><div class="diff-removed">-      constructor(props) {</div><div class="diff-removed">-        super(props);</div><div class="diff-removed">-        return {something: false};</div><div class="diff-removed">-      }</div><div class="diff-removed">-</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div />;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(document.createElement('div'));</div><div class="diff-removed">-    await expect(async () => {</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        root.render(<RenderTextInvalidConstructor />);</div><div class="diff-removed">-      });</div><div class="diff-removed">-    }).rejects.toThrow();</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'No `render` method found on the RenderTextInvalidConstructor instance: ' +</div><div class="diff-removed">-        'did you accidentally return an object from the constructor?\n' +</div><div class="diff-removed">-        '    in RenderTextInvalidConstructor (at **)',</div><div class="diff-removed">-      'No `render` method found on the RenderTextInvalidConstructor instance: ' +</div><div class="diff-removed">-        'did you accidentally return an object from the constructor?\n' +</div><div class="diff-removed">-        '    in RenderTextInvalidConstructor (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should warn about reassigning this.props while rendering', () => {</div><div class="diff-removed">-    class Bad extends React.Component {</div><div class="diff-removed">-      componentDidMount() {}</div><div class="diff-removed">-      componentDidUpdate() {}</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        this.props = {...this.props};</div><div class="diff-removed">-        return null;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    const container = document.createElement('div');</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(container);</div><div class="diff-removed">-    ReactDOM.flushSync(() => {</div><div class="diff-removed">-      root.render(<Bad />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'It looks like Bad is reassigning its own `this.props` while rendering. ' +</div><div class="diff-removed">-        'This is not supported and can lead to confusing bugs.\n' +</div><div class="diff-removed">-        '    in Bad (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should return error if render is not defined', async () => {</div><div class="diff-removed">-    class RenderTestUndefinedRender extends React.Component {}</div><div class="diff-removed">-</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(document.createElement('div'));</div><div class="diff-removed">-    await expect(async () => {</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        root.render(<RenderTestUndefinedRender />);</div><div class="diff-removed">-      });</div><div class="diff-removed">-    }).rejects.toThrow();</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'No `render` method found on the RenderTestUndefinedRender instance: ' +</div><div class="diff-removed">-        'you may have forgotten to define `render`.\n' +</div><div class="diff-removed">-        '    in RenderTestUndefinedRender (at **)',</div><div class="diff-removed">-      'No `render` method found on the RenderTestUndefinedRender instance: ' +</div><div class="diff-removed">-        'you may have forgotten to define `render`.\n' +</div><div class="diff-removed">-        '    in RenderTestUndefinedRender (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  // Regression test for accidental breaking change</div><div class="diff-removed">-  // https://github.com/facebook/react/issues/13580</div><div class="diff-removed">-  it('should support classes shadowing isReactComponent', async () => {</div><div class="diff-removed">-    class Shadow extends React.Component {</div><div class="diff-removed">-      isReactComponent() {}</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div />;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    const container = document.createElement('div');</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(container);</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Shadow />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.firstChild.tagName).toBe('DIV');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not warn on updating function component from componentWillMount', async () => {</div><div class="diff-removed">-    let setState;</div><div class="diff-removed">-    let ref;</div><div class="diff-removed">-    function A() {</div><div class="diff-removed">-      const [state, _setState] = React.useState(null);</div><div class="diff-removed">-      setState = _setState;</div><div class="diff-removed">-      return <div ref={r => (ref = r)}>{state}</div>;</div><div class="diff-removed">-    }</div><div class="diff-removed">-    class B extends React.Component {</div><div class="diff-removed">-      UNSAFE_componentWillMount() {</div><div class="diff-removed">-        setState(1);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return null;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    function Parent() {</div><div class="diff-removed">-      return (</div><div class="diff-removed">-        <div></div><div class="diff-removed">-          <A /></div><div class="diff-removed">-          <B /></div><div class="diff-removed">-        </div></div><div class="diff-removed">-      );</div><div class="diff-removed">-    }</div><div class="diff-removed">-    const container = document.createElement('div');</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(container);</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(ref.textContent).toBe('1');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not warn on updating function component from componentWillUpdate', async () => {</div><div class="diff-removed">-    let setState;</div><div class="diff-removed">-    let ref;</div><div class="diff-removed">-    function A() {</div><div class="diff-removed">-      const [state, _setState] = React.useState();</div><div class="diff-removed">-      setState = _setState;</div><div class="diff-removed">-      return <div ref={r => (ref = r)}>{state}</div>;</div><div class="diff-removed">-    }</div><div class="diff-removed">-    class B extends React.Component {</div><div class="diff-removed">-      UNSAFE_componentWillUpdate() {</div><div class="diff-removed">-        setState(1);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return null;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    function Parent() {</div><div class="diff-removed">-      return (</div><div class="diff-removed">-        <div></div><div class="diff-removed">-          <A /></div><div class="diff-removed">-          <B /></div><div class="diff-removed">-        </div></div><div class="diff-removed">-      );</div><div class="diff-removed">-    }</div><div class="diff-removed">-    const container = document.createElement('div');</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(container);</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(ref.textContent).toBe('1');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not warn on updating function component from componentWillReceiveProps', async () => {</div><div class="diff-removed">-    let setState;</div><div class="diff-removed">-    let ref;</div><div class="diff-removed">-    function A() {</div><div class="diff-removed">-      const [state, _setState] = React.useState();</div><div class="diff-removed">-      setState = _setState;</div><div class="diff-removed">-      return <div ref={r => (ref = r)}>{state}</div>;</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class B extends React.Component {</div><div class="diff-removed">-      UNSAFE_componentWillReceiveProps() {</div><div class="diff-removed">-        setState(1);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return null;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    function Parent() {</div><div class="diff-removed">-      return (</div><div class="diff-removed">-        <div></div><div class="diff-removed">-          <A /></div><div class="diff-removed">-          <B /></div><div class="diff-removed">-        </div></div><div class="diff-removed">-      );</div><div class="diff-removed">-    }</div><div class="diff-removed">-    const container = document.createElement('div');</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(container);</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(ref.textContent).toBe('1');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should warn on updating function component from render', () => {</div><div class="diff-removed">-    let setState;</div><div class="diff-removed">-    let ref;</div><div class="diff-removed">-    function A() {</div><div class="diff-removed">-      const [state, _setState] = React.useState(0);</div><div class="diff-removed">-      setState = _setState;</div><div class="diff-removed">-      return <div ref={r => (ref = r)}>{state}</div>;</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class B extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        setState(c => c + 1);</div><div class="diff-removed">-        return null;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    function Parent() {</div><div class="diff-removed">-      return (</div><div class="diff-removed">-        <div></div><div class="diff-removed">-          <A /></div><div class="diff-removed">-          <B /></div><div class="diff-removed">-        </div></div><div class="diff-removed">-      );</div><div class="diff-removed">-    }</div><div class="diff-removed">-    const container = document.createElement('div');</div><div class="diff-removed">-    const root = ReactDOMClient.createRoot(container);</div><div class="diff-removed">-    ReactDOM.flushSync(() => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'Cannot update a component (`A`) while rendering a different component (`B`). ' +</div><div class="diff-removed">-        'To locate the bad setState() call inside `B`, ' +</div><div class="diff-removed">-        'follow the stack trace as described in https://react.dev/link/setstate-in-render\n' +</div><div class="diff-removed">-        '    in Parent (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-</div><div class="diff-removed">-    // We error, but still update the state.</div><div class="diff-removed">-    expect(ref.textContent).toBe('1');</div><div class="diff-removed">-</div><div class="diff-removed">-    // Dedupe.</div><div class="diff-removed">-    ReactDOM.flushSync(() => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    // We error, but still update the state.</div><div class="diff-removed">-    expect(ref.textContent).toBe('2');</div><div class="diff-removed">-  });</div><div class="diff-removed">-});</div><div>\ No newline at end of file</div><div class="diff-added">+      root.render(<Component ref={ref => (instance = ref)} /></div><div>\ No newline at end of file</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    