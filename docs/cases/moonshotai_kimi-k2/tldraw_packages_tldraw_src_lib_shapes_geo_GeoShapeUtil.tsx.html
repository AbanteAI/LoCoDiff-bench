<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/tldraw/src/lib/shapes/geo/GeoShapeUtil.tsx - Kimi K2</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/tldraw/src/lib/shapes/geo/GeoShapeUtil.tsx</h1>
        <h2>Model: Kimi K2</h2>
        <p><a href="../../models/moonshotai_kimi-k2.html">All Kimi K2 Cases</a> | <a href="../../cases.html">All Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> Kimi K2</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 67029</p>
                <p><strong>Native Prompt Tokens:</strong> 66974</p>
                <p><strong>Native Completion Tokens:</strong> 6422</p>
                <p><strong>Native Tokens Reasoning:</strong> 0</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Cost:</strong> $0.05294578</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/moonshotai_kimi-k2/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/moonshotai_kimi-k2/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/moonshotai_kimi-k2/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div></div><div>index 751af1b8f..0d147416e 100644</div><div class="diff-header">--- a/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx_expectedoutput.txt (expected):tmp/tmpz9i68vgo_expected.txt	</div><div class="diff-header">+++ b/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx_extracted.txt (actual):tmp/tmp4heqeipv_actual.txt	</div><div class="diff-info">@@ -1,15 +1,14 @@</div><div class="diff-removed">-/* eslint-disable react-hooks/rules-of-hooks */</div><div> import {</div><div> 	BaseBoxShapeUtil,</div><div> 	Box,</div><div> 	Editor,</div><div> 	Ellipse2d,</div><div class="diff-added">+	exhaustiveSwitchError,</div><div> 	Geometry2d,</div><div> 	Group2d,</div><div class="diff-added">+	HandleSnapGeometry,</div><div> 	HALF_PI,</div><div> 	HTMLContainer,</div><div class="diff-removed">-	HandleSnapGeometry,</div><div class="diff-removed">-	PI2,</div><div> 	Polygon2d,</div><div> 	Polyline2d,</div><div> 	Rectangle2d,</div><div class="diff-info">@@ -22,7 +21,6 @@ import {</div><div> 	TLResizeInfo,</div><div> 	TLShapeUtilCanvasSvgDef,</div><div> 	Vec,</div><div class="diff-removed">-	exhaustiveSwitchError,</div><div> 	geoShapeMigrations,</div><div> 	geoShapeProps,</div><div> 	getDefaultColorTheme,</div><div class="diff-info">@@ -32,7 +30,6 @@ import {</div><div> 	toRichText,</div><div> 	useValue,</div><div> } from '@tldraw/editor'</div><div class="diff-removed">-</div><div> import isEqual from 'lodash.isequal'</div><div> import {</div><div> 	isEmptyRichText,</div><div class="diff-info">@@ -95,7 +92,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		}</div><div> 	}</div><div> </div><div class="diff-removed">-	override getGeometry(shape: TLGeoShape) {</div><div class="diff-added">+	override getGeometry(shape: TLGeoShape): Geometry2d {</div><div> 		const w = Math.max(1, shape.props.w)</div><div> 		const h = Math.max(1, shape.props.h + shape.props.growY)</div><div> 		const cx = w / 2</div><div class="diff-info">@@ -165,10 +162,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 				break</div><div> 			}</div><div> 			case 'star': {</div><div class="diff-removed">-				// Most of this code is to offset the center, a 5 point star</div><div class="diff-removed">-				// will need to be moved downward because from its center [0,0]</div><div class="diff-removed">-				// it will have a bigger minY than maxY. This is because it'll</div><div class="diff-removed">-				// have 2 points at the bottom.</div><div> 				const sides = 5</div><div> 				const step = PI2 / sides / 2</div><div> 				const rightMostIndex = Math.floor(sides / 4) * 2</div><div class="diff-info">@@ -186,19 +179,19 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 				const offsetY = h / 2 + minY - (h / 2 - maxY)</div><div> </div><div> 				const ratio = 1</div><div class="diff-removed">-				const cx = (w - offsetX) / 2</div><div class="diff-removed">-				const cy = (h - offsetY) / 2</div><div class="diff-removed">-				const ox = (w + diffX) / 2</div><div class="diff-removed">-				const oy = (h + diffY) / 2</div><div class="diff-removed">-				const ix = (ox * ratio) / 2</div><div class="diff-removed">-				const iy = (oy * ratio) / 2</div><div class="diff-added">+				const innerCx = (w - offsetX) / 2</div><div class="diff-added">+				const innerCy = (h - offsetY) / 2</div><div class="diff-added">+				const outerX = (w + diffX) / 2</div><div class="diff-added">+				const outerY = (h + diffY) / 2</div><div class="diff-added">+				const innerX = (outerX * ratio) / 2</div><div class="diff-added">+				const innerY = (outerY * ratio) / 2</div><div> </div><div> 				body = new Polygon2d({</div><div> 					points: Array.from(Array(sides * 2)).map((_, i) => {</div><div> 						const theta = -HALF_PI + i * step</div><div> 						return new Vec(</div><div class="diff-removed">-							cx + (i % 2 ? ix : ox) * Math.cos(theta),</div><div class="diff-removed">-							cy + (i % 2 ? iy : oy) * Math.sin(theta)</div><div class="diff-added">+							innerCx + (i % 2 ? innerX : outerX) * Math.cos(theta),</div><div class="diff-added">+							innerCy + (i % 2 ? innerY : outerY) * Math.sin(theta)</div><div> 						)</div><div> 					}),</div><div> 					isFilled,</div><div class="diff-info">@@ -308,7 +301,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 				break</div><div> 			}</div><div> 			case 'heart': {</div><div class="diff-removed">-				// kind of expensive (creating the primitives to create a different primitive) but hearts are rare and beautiful things</div><div> 				const parts = getHeartParts(w, h)</div><div> 				const points = parts.reduce<Vec[]>((acc, part) => {</div><div> 					acc.push(...part.vertices)</div><div class="diff-info">@@ -327,7 +319,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		}</div><div> </div><div> 		const unscaledlabelSize = getUnscaledLabelSize(this.editor, shape)</div><div class="diff-removed">-		// unscaled w and h</div><div> 		const unscaledW = w / shape.props.scale</div><div> 		const unscaledH = h / shape.props.scale</div><div> 		const unscaledminWidth = Math.min(100, unscaledW / 2)</div><div class="diff-info">@@ -345,13 +336,9 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 			Math.max(unscaledlabelSize.h, Math.min(unscaledMinHeight, Math.max(1, unscaledH - 8)))</div><div> 		)</div><div> </div><div class="diff-removed">-		// not sure if bug</div><div class="diff-removed">-</div><div> 		const lines = getLines(shape.props, STROKE_SIZES[shape.props.size] * shape.props.scale)</div><div> 		const edges = lines ? lines.map((line) => new Polyline2d({ points: line })) : []</div><div> </div><div class="diff-removed">-		// todo: use centroid for label position</div><div class="diff-removed">-</div><div> 		return new Group2d({</div><div> 			children: [</div><div> 				body,</div><div class="diff-info">@@ -360,14 +347,14 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 						shape.props.align === 'start'</div><div> 							? 0</div><div> 							: shape.props.align === 'end'</div><div class="diff-removed">-								? (unscaledW - unscaledLabelWidth) * shape.props.scale</div><div class="diff-removed">-								: ((unscaledW - unscaledLabelWidth) / 2) * shape.props.scale,</div><div class="diff-added">+							? (unscaledW - unscaledLabelWidth) * shape.props.scale</div><div class="diff-added">+							: ((unscaledW - unscaledLabelWidth) / 2) * shape.props.scale,</div><div> 					y:</div><div> 						shape.props.verticalAlign === 'start'</div><div> 							? 0</div><div> 							: shape.props.verticalAlign === 'end'</div><div class="diff-removed">-								? (unscaledH - unscaledLabelHeight) * shape.props.scale</div><div class="diff-removed">-								: ((unscaledH - unscaledLabelHeight) / 2) * shape.props.scale,</div><div class="diff-added">+							? (unscaledH - unscaledLabelHeight) * shape.props.scale</div><div class="diff-added">+							: ((unscaledH - unscaledLabelHeight) / 2) * shape.props.scale,</div><div> 					width: unscaledLabelWidth * shape.props.scale,</div><div> 					height: unscaledLabelHeight * shape.props.scale,</div><div> 					isFilled: true,</div><div class="diff-info">@@ -380,7 +367,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> </div><div> 	override getHandleSnapGeometry(shape: TLGeoShape): HandleSnapGeometry {</div><div> 		const geometry = this.getGeometry(shape)</div><div class="diff-removed">-		// we only want to snap handles to the outline of the shape - not to its label etc.</div><div> 		const outline = geometry.children[0]</div><div> 		switch (shape.props.geo) {</div><div> 			case 'arrow-down':</div><div class="diff-info">@@ -399,14 +385,12 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 			case 'trapezoid':</div><div> 			case 'triangle':</div><div> 			case 'x-box':</div><div class="diff-removed">-				// poly-line type shapes hand snap points for each vertex & the center</div><div class="diff-removed">-				return { outline: outline, points: [...outline.vertices, geometry.bounds.center] }</div><div class="diff-added">+				return { outline, points: [...outline.vertices, geometry.bounds.center] }</div><div> 			case 'cloud':</div><div> 			case 'ellipse':</div><div> 			case 'heart':</div><div> 			case 'oval':</div><div class="diff-removed">-				// blobby shapes only have a snap point in their center</div><div class="diff-removed">-				return { outline: outline, points: [geometry.bounds.center] }</div><div class="diff-added">+				return { outline, points: [geometry.bounds.center] }</div><div> 			default:</div><div> 				exhaustiveSwitchError(shape.props.geo)</div><div> 		}</div><div class="diff-info">@@ -475,32 +459,30 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 	}</div><div> </div><div> 	indicator(shape: TLGeoShape) {</div><div class="diff-removed">-		const { id, props } = shape</div><div class="diff-added">+		const { props } = shape</div><div> 		const { w, size } = props</div><div> 		const h = props.h + props.growY</div><div class="diff-removed">-</div><div class="diff-removed">-		const strokeWidth = STROKE_SIZES[size]</div><div class="diff-removed">-</div><div class="diff-removed">-		const geometry = this.editor.getShapeGeometry(shape)</div><div class="diff-added">+		const strokeWidth = STROKE_SIZES[size] * shape.props.scale</div><div class="diff-added">+		const { id } = shape</div><div> </div><div> 		switch (props.geo) {</div><div> 			case 'ellipse': {</div><div> 				if (props.dash === 'draw') {</div><div> 					return <path d={getEllipseDrawIndicatorPath(id, w, h, strokeWidth)} /></div><div> 				}</div><div class="diff-removed">-</div><div class="diff-added">+				const geometry = this.editor.getShapeGeometry(shape)</div><div> 				return <path d={geometry.getSvgPathData(true)} /></div><div> 			}</div><div> 			case 'heart': {</div><div> 				return <path d={getHeartPath(w, h)} /></div><div> 			}</div><div> 			case 'oval': {</div><div class="diff-added">+				const geometry = this.editor.getShapeGeometry(shape)</div><div> 				return <path d={geometry.getSvgPathData(true)} /></div><div> 			}</div><div> 			case 'cloud': {</div><div> 				return <path d={getCloudPath(w, h, id, size, shape.props.scale)} /></div><div> 			}</div><div class="diff-removed">-</div><div> 			default: {</div><div> 				const geometry = this.editor.getShapeGeometry(shape)</div><div> 				const outline =</div><div class="diff-info">@@ -520,8 +502,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 					path = 'M' + outline[0] + 'L' + outline.slice(1) + 'Z'</div><div> 				}</div><div> </div><div class="diff-removed">-				const lines = getLines(shape.props, strokeWidth)</div><div class="diff-removed">-</div><div class="diff-added">+				const lines = getLines(props, strokeWidth)</div><div> 				if (lines) {</div><div> 					for (const [A, B] of lines) {</div><div> 						path += `M${A.x},${A.y}L${B.x},${B.y}`</div><div class="diff-info">@@ -534,7 +515,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 	}</div><div> </div><div> 	override toSvg(shape: TLGeoShape, ctx: SvgExportContext) {</div><div class="diff-removed">-		// We need to scale the shape to 1x for export</div><div> 		const newShape = {</div><div> 			...shape,</div><div> 			props: {</div><div class="diff-info">@@ -583,8 +563,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		const unscaledInitialW = initialShape.props.w / initialShape.props.scale</div><div> 		const unscaledInitialH = initialShape.props.h / initialShape.props.scale</div><div> 		const unscaledGrowY = initialShape.props.growY / initialShape.props.scale</div><div class="diff-removed">-		// use the w/h from props here instead of the initialBounds here,</div><div class="diff-removed">-		// since cloud shapes calculated bounds can differ from the props w/h.</div><div> 		let unscaledW = unscaledInitialW * scaleX</div><div> 		let unscaledH = (unscaledInitialH + unscaledGrowY) * scaleY</div><div> 		let overShrinkX = 0</div><div class="diff-info">@@ -592,7 +570,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> </div><div> 		const min = MIN_SIZE_WITH_LABEL</div><div> </div><div class="diff-removed">-		if (!isEmptyRichText(shape.props.richText)) {</div><div class="diff-added">+		if (renderPlaintextFromRichText(this.editor, shape.props.richText)) {</div><div> 			let newW = Math.max(Math.abs(unscaledW), min)</div><div> 			let newH = Math.max(Math.abs(unscaledH), min)</div><div> </div><div class="diff-info">@@ -622,8 +600,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> </div><div> 		const offset = new Vec(0, 0)</div><div> </div><div class="diff-removed">-		// x offsets</div><div class="diff-removed">-</div><div> 		if (scaleX < 0) {</div><div> 			offset.x += scaledW</div><div> 		}</div><div class="diff-info">@@ -632,8 +608,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 			offset.x += scaleX < 0 ? overShrinkX : -overShrinkX</div><div> 		}</div><div> </div><div class="diff-removed">-		// y offsets</div><div class="diff-removed">-</div><div> 		if (scaleY < 0) {</div><div> 			offset.y += scaledH</div><div> 		}</div><div class="diff-info">@@ -658,7 +632,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 	override onBeforeCreate(shape: TLGeoShape) {</div><div> 		if (isEmptyRichText(shape.props.richText)) {</div><div> 			if (shape.props.growY) {</div><div class="diff-removed">-				// No text / some growY, set growY to 0</div><div> 				return {</div><div> 					...shape,</div><div> 					props: {</div><div class="diff-info">@@ -667,7 +640,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 					},</div><div> 				}</div><div> 			} else {</div><div class="diff-removed">-				// No text / no growY, nothing to change</div><div> 				return</div><div> 			}</div><div> 		}</div><div class="diff-info">@@ -690,7 +662,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 				...shape,</div><div> 				props: {</div><div> 					...shape.props,</div><div class="diff-removed">-					// scale the growY</div><div> 					growY: growY * shape.props.scale,</div><div> 				},</div><div> 			}</div><div class="diff-info">@@ -698,7 +669,6 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 	}</div><div> </div><div> 	override onBeforeUpdate(prev: TLGeoShape, next: TLGeoShape) {</div><div class="diff-removed">-		// No change to text, font, or size, no need to update update</div><div> 		if (</div><div> 			isEqual(prev.props.richText, next.props.richText) &&</div><div> 			prev.props.font === next.props.font &&</div><div class="diff-info">@@ -707,10 +677,9 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 			return</div><div> 		}</div><div> </div><div class="diff-removed">-		// If we got rid of the text, cancel out any growY from the prev text</div><div class="diff-removed">-		const wasEmpty = isEmptyRichText(prev.props.richText)</div><div class="diff-removed">-		const isEmpty = isEmptyRichText(next.props.richText)</div><div class="diff-removed">-		if (!wasEmpty && isEmpty) {</div><div class="diff-added">+		const prevPlaintext = renderPlaintextFromRichText(this.editor, prev.props.richText)</div><div class="diff-added">+		const nextPlaintext = renderPlaintextFromRichText(this.editor, next.props.richText)</div><div class="diff-added">+		if (prevPlaintext && !nextPlaintext) {</div><div> 			return {</div><div> 				...next,</div><div> 				props: {</div><div class="diff-info">@@ -720,22 +689,18 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 			}</div><div> 		}</div><div> </div><div class="diff-removed">-		// Get the prev width and height in unscaled values</div><div> 		const unscaledPrevWidth = prev.props.w / prev.props.scale</div><div> 		const unscaledPrevHeight = prev.props.h / prev.props.scale</div><div> 		const unscaledPrevGrowY = prev.props.growY / prev.props.scale</div><div> </div><div class="diff-removed">-		// Get the next width and height in unscaled values</div><div> 		const unscaledNextLabelSize = getUnscaledLabelSize(this.editor, next)</div><div> </div><div class="diff-removed">-		// When entering the first character in a label (not pasting in multiple characters...)</div><div class="diff-removed">-		if (wasEmpty && !isEmpty && renderPlaintextFromRichText(this.editor, next.props.richText)) {</div><div class="diff-added">+		if (!prevPlaintext && nextPlaintext && nextPlaintext.length === 1) {</div><div> 			let unscaledW = Math.max(unscaledPrevWidth, unscaledNextLabelSize.w)</div><div> 			let unscaledH = Math.max(unscaledPrevHeight, unscaledNextLabelSize.h)</div><div> </div><div> 			const min = MIN_SIZE_WITH_LABEL</div><div> </div><div class="diff-removed">-			// If both the width and height were less than the minimum size, make the shape square</div><div> 			if (unscaledPrevWidth < min && unscaledPrevHeight < min) {</div><div> 				unscaledW = Math.max(unscaledW, min)</div><div> 				unscaledH = Math.max(unscaledH, min)</div><div class="diff-info">@@ -743,12 +708,10 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 				unscaledH = Math.max(unscaledW, unscaledH)</div><div> 			}</div><div> </div><div class="diff-removed">-			// Don't set a growY—at least, not until we've implemented a growX property</div><div> 			return {</div><div> 				...next,</div><div> 				props: {</div><div> 					...next.props,</div><div class="diff-removed">-					// Scale the results</div><div> 					w: unscaledW * next.props.scale,</div><div> 					h: unscaledH * next.props.scale,</div><div> 					growY: 0,</div><div class="diff-info">@@ -761,6 +724,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 		if (unscaledNextLabelSize.h > unscaledPrevHeight) {</div><div> 			growY = unscaledNextLabelSize.h - unscaledPrevHeight</div><div> 		} else {</div><div class="diff-added">+			const unscaledPrevGrowY = prev.props.growY / prev.props.scale</div><div> 			if (unscaledPrevGrowY) {</div><div> 				growY = 0</div><div> 			}</div><div class="diff-info">@@ -772,36 +736,32 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 				...next,</div><div> 				props: {</div><div> 					...next.props,</div><div class="diff-removed">-					// Scale the results</div><div> 					growY: growY * next.props.scale,</div><div> 					w: Math.max(unscaledNextWidth, unscaledNextLabelSize.w) * next.props.scale,</div><div> 				},</div><div> 			}</div><div> 		}</div><div> </div><div class="diff-added">+		const unscaledNextWidth = next.props.w / next.props.scale</div><div> 		if (unscaledNextLabelSize.w > unscaledPrevWidth) {</div><div> 			return {</div><div> 				...next,</div><div> 				props: {</div><div> 					...next.props,</div><div class="diff-removed">-					// Scale the results</div><div> 					w: unscaledNextLabelSize.w * next.props.scale,</div><div> 				},</div><div> 			}</div><div> 		}</div><div class="diff-removed">-</div><div class="diff-removed">-		// otherwise, no update needed</div><div> 	}</div><div> </div><div> 	override onDoubleClick(shape: TLGeoShape) {</div><div class="diff-removed">-		// Little easter egg: double-clicking a rectangle / checkbox while</div><div class="diff-removed">-		// holding alt will toggle between check-box and rectangle</div><div> 		if (this.editor.inputs.altKey) {</div><div> 			switch (shape.props.geo) {</div><div> 				case 'rectangle': {</div><div> 					return {</div><div> 						...shape,</div><div> 						props: {</div><div class="diff-added">+							...shape.props,</div><div> 							geo: 'check-box' as const,</div><div> 						},</div><div> 					}</div><div class="diff-info">@@ -810,6 +770,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> 					return {</div><div> 						...shape,</div><div> 						props: {</div><div class="diff-added">+							...shape.props,</div><div> 							geo: 'rectangle' as const,</div><div> 						},</div><div> 					}</div><div class="diff-info">@@ -819,6 +780,7 @@ export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div> </div><div> 		return</div><div> 	}</div><div class="diff-added">+</div><div> 	override getInterpolatedProps(</div><div> 		startShape: TLGeoShape,</div><div> 		endShape: TLGeoShape,</div><div class="diff-info">@@ -844,10 +806,9 @@ function getUnscaledLabelSize(editor: Editor, shape: TLGeoShape) {</div><div> 		...TEXT_PROPS,</div><div> 		fontFamily: FONT_FAMILIES[font],</div><div> 		fontSize: LABEL_FONT_SIZES[size],</div><div class="diff-removed">-		maxWidth: 100, // ?</div><div class="diff-added">+		maxWidth: 100,</div><div> 	})</div><div> </div><div class="diff-removed">-	// TODO: Can I get these from somewhere?</div><div> 	const sizes = {</div><div> 		s: 2,</div><div> 		m: 3.5,</div><div class="diff-info">@@ -862,11 +823,8 @@ function getUnscaledLabelSize(editor: Editor, shape: TLGeoShape) {</div><div> 		fontSize: LABEL_FONT_SIZES[size],</div><div> 		minWidth: minSize.w,</div><div> 		maxWidth: Math.max(</div><div class="diff-removed">-			// Guard because a DOM nodes can't be less 0</div><div> 			0,</div><div class="diff-removed">-			// A 'w' width that we're setting as the min-width</div><div> 			Math.ceil(minSize.w + sizes[size]),</div><div class="diff-removed">-			// The actual text size</div><div> 			Math.ceil(w / shape.props.scale - LABEL_PADDING * 2)</div><div> 		),</div><div> 	})</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    