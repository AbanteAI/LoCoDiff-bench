<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/react-reconciler/src/ReactFiberHydrationContext.js - GPT-5 (minimal)</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/react-reconciler/src/ReactFiberHydrationContext.js</h1>
        <h2>Model: GPT-5 (minimal)</h2>
        <p><a href="../../models/openai_gpt-5minimal.html">All GPT-5 (minimal) Cases</a> | <a href="../../cases.html">All Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> GPT-5 (minimal)</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 82014</p>
                <p><strong>Native Prompt Tokens:</strong> 72002</p>
                <p><strong>Native Completion Tokens:</strong> 5638</p>
                <p><strong>Native Tokens Reasoning:</strong> 0</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Cost:</strong> $0.1463825</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/openai_gpt-5minimal/react_packages_react-reconciler_src_ReactFiberHydrationContext.js/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/openai_gpt-5minimal/react_packages_react-reconciler_src_ReactFiberHydrationContext.js/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/openai_gpt-5minimal/react_packages_react-reconciler_src_ReactFiberHydrationContext.js/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div></div><div>index f9932b8c4..9521ae3d9 100644</div><div class="diff-header">--- a/react_packages_react-reconciler_src_ReactFiberHydrationContext.js_expectedoutput.txt (expected):tmp/tmpphv2cbi3_expected.txt	</div><div class="diff-header">+++ b/react_packages_react-reconciler_src_ReactFiberHydrationContext.js_extracted.txt (actual):tmp/tmpdpni4cvh_actual.txt	</div><div class="diff-info">@@ -12,12 +12,10 @@ import type {</div><div>   Instance,</div><div>   TextInstance,</div><div>   HydratableInstance,</div><div class="diff-removed">-  ActivityInstance,</div><div>   SuspenseInstance,</div><div>   Container,</div><div>   HostContext,</div><div> } from './ReactFiberConfig';</div><div class="diff-removed">-import type {ActivityState} from './ReactFiberActivityComponent';</div><div> import type {SuspenseState} from './ReactFiberSuspenseComponent';</div><div> import type {TreeContext} from './ReactFiberTreeContext';</div><div> import type {CapturedValue} from './ReactCapturedValue';</div><div class="diff-info">@@ -28,43 +26,37 @@ import {</div><div>   HostSingleton,</div><div>   HostRoot,</div><div>   SuspenseComponent,</div><div class="diff-removed">-  ActivityComponent,</div><div> } from './ReactWorkTags';</div><div> import {favorSafetyOverHydrationPerf} from 'shared/ReactFeatureFlags';</div><div> </div><div class="diff-removed">-import {createCapturedValueAtFiber} from './ReactCapturedValue';</div><div class="diff-removed">-</div><div> import {createFiberFromDehydratedFragment} from './ReactFiber';</div><div> import {</div><div>   shouldSetTextContent,</div><div>   supportsHydration,</div><div>   supportsSingletons,</div><div class="diff-added">+  isHydratable,</div><div class="diff-added">+  canHydrateInstance,</div><div class="diff-added">+  canHydrateTextInstance,</div><div class="diff-added">+  canHydrateSuspenseInstance,</div><div>   getNextHydratableSibling,</div><div class="diff-removed">-  getNextHydratableSiblingAfterSingleton,</div><div>   getFirstHydratableChild,</div><div>   getFirstHydratableChildWithinContainer,</div><div class="diff-removed">-  getFirstHydratableChildWithinActivityInstance,</div><div>   getFirstHydratableChildWithinSuspenseInstance,</div><div class="diff-removed">-  getFirstHydratableChildWithinSingleton,</div><div>   hydrateInstance,</div><div>   diffHydratedPropsForDevWarnings,</div><div>   describeHydratableInstanceForDevWarnings,</div><div>   hydrateTextInstance,</div><div>   diffHydratedTextForDevWarnings,</div><div class="diff-removed">-  hydrateActivityInstance,</div><div>   hydrateSuspenseInstance,</div><div class="diff-removed">-  getNextHydratableInstanceAfterActivityInstance,</div><div>   getNextHydratableInstanceAfterSuspenseInstance,</div><div>   shouldDeleteUnhydratedTailInstances,</div><div>   resolveSingletonInstance,</div><div class="diff-removed">-  canHydrateInstance,</div><div class="diff-removed">-  canHydrateTextInstance,</div><div class="diff-removed">-  canHydrateActivityInstance,</div><div class="diff-removed">-  canHydrateSuspenseInstance,</div><div class="diff-removed">-  canHydrateFormStateMarker,</div><div class="diff-removed">-  isFormStateMarkerMatching,</div><div class="diff-added">+  isHydratableType,</div><div class="diff-added">+  isHydratableText,</div><div>   validateHydratableInstance,</div><div>   validateHydratableTextInstance,</div><div class="diff-added">+  canHydrateFormStateMarker,</div><div class="diff-added">+  isFormStateMarkerMatching,</div><div> } from './ReactFiberConfig';</div><div> import {OffscreenLane} from './ReactFiberLane';</div><div> import {</div><div class="diff-info">@@ -74,7 +66,6 @@ import {</div><div> import {queueRecoverableErrors} from './ReactFiberWorkLoop';</div><div> import {getRootHostContainer, getHostContext} from './ReactFiberHostContext';</div><div> import {describeDiff} from './ReactFiberHydrationDiffs';</div><div class="diff-removed">-import {runWithFiberInDEV} from './ReactCurrentFiber';</div><div> </div><div> // The deepest Fiber on the stack involved in a hydration context.</div><div> // This may have been an insertion or a hydration.</div><div class="diff-info">@@ -177,28 +168,6 @@ function enterHydrationState(fiber: Fiber): boolean {</div><div>   return true;</div><div> }</div><div> </div><div class="diff-removed">-function reenterHydrationStateFromDehydratedActivityInstance(</div><div class="diff-removed">-  fiber: Fiber,</div><div class="diff-removed">-  activityInstance: ActivityInstance,</div><div class="diff-removed">-  treeContext: TreeContext | null,</div><div class="diff-removed">-): boolean {</div><div class="diff-removed">-  if (!supportsHydration) {</div><div class="diff-removed">-    return false;</div><div class="diff-removed">-  }</div><div class="diff-removed">-  nextHydratableInstance =</div><div class="diff-removed">-    getFirstHydratableChildWithinActivityInstance(activityInstance);</div><div class="diff-removed">-  hydrationParentFiber = fiber;</div><div class="diff-removed">-  isHydrating = true;</div><div class="diff-removed">-  hydrationErrors = null;</div><div class="diff-removed">-  didSuspendOrErrorDEV = false;</div><div class="diff-removed">-  hydrationDiffRootDEV = null;</div><div class="diff-removed">-  rootOrSingletonContext = false;</div><div class="diff-removed">-  if (treeContext !== null) {</div><div class="diff-removed">-    restoreSuspendedTreeContext(fiber, treeContext);</div><div class="diff-removed">-  }</div><div class="diff-removed">-  return true;</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div> function reenterHydrationStateFromDehydratedSuspenseInstance(</div><div>   fiber: Fiber,</div><div>   suspenseInstance: SuspenseInstance,</div><div class="diff-info">@@ -301,43 +270,7 @@ function tryHydrateText(fiber: Fiber, nextInstance: any) {</div><div>   return false;</div><div> }</div><div> </div><div class="diff-removed">-function tryHydrateActivity(</div><div class="diff-removed">-  fiber: Fiber,</div><div class="diff-removed">-  nextInstance: any,</div><div class="diff-removed">-): null | ActivityInstance {</div><div class="diff-removed">-  // fiber is a ActivityComponent Fiber</div><div class="diff-removed">-  const activityInstance = canHydrateActivityInstance(</div><div class="diff-removed">-    nextInstance,</div><div class="diff-removed">-    rootOrSingletonContext,</div><div class="diff-removed">-  );</div><div class="diff-removed">-  if (activityInstance !== null) {</div><div class="diff-removed">-    const activityState: ActivityState = {</div><div class="diff-removed">-      dehydrated: activityInstance,</div><div class="diff-removed">-      treeContext: getSuspendedTreeContext(),</div><div class="diff-removed">-      retryLane: OffscreenLane,</div><div class="diff-removed">-      hydrationErrors: null,</div><div class="diff-removed">-    };</div><div class="diff-removed">-    fiber.memoizedState = activityState;</div><div class="diff-removed">-    // Store the dehydrated fragment as a child fiber.</div><div class="diff-removed">-    // This simplifies the code for getHostSibling and deleting nodes,</div><div class="diff-removed">-    // since it doesn't have to consider all Suspense boundaries and</div><div class="diff-removed">-    // check if they're dehydrated ones or not.</div><div class="diff-removed">-    const dehydratedFragment =</div><div class="diff-removed">-      createFiberFromDehydratedFragment(activityInstance);</div><div class="diff-removed">-    dehydratedFragment.return = fiber;</div><div class="diff-removed">-    fiber.child = dehydratedFragment;</div><div class="diff-removed">-    hydrationParentFiber = fiber;</div><div class="diff-removed">-    // While an Activity Instance does have children, we won't step into</div><div class="diff-removed">-    // it during the first pass. Instead, we'll reenter it later.</div><div class="diff-removed">-    nextHydratableInstance = null;</div><div class="diff-removed">-  }</div><div class="diff-removed">-  return activityInstance;</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function tryHydrateSuspense(</div><div class="diff-removed">-  fiber: Fiber,</div><div class="diff-removed">-  nextInstance: any,</div><div class="diff-removed">-): null | SuspenseInstance {</div><div class="diff-added">+function tryHydrateSuspense(fiber: Fiber, nextInstance: any) {</div><div>   // fiber is a SuspenseComponent Fiber</div><div>   const suspenseInstance = canHydrateSuspenseInstance(</div><div>     nextInstance,</div><div class="diff-info">@@ -348,7 +281,6 @@ function tryHydrateSuspense(</div><div>       dehydrated: suspenseInstance,</div><div>       treeContext: getSuspendedTreeContext(),</div><div>       retryLane: OffscreenLane,</div><div class="diff-removed">-      hydrationErrors: null,</div><div>     };</div><div>     fiber.memoizedState = suspenseState;</div><div>     // Store the dehydrated fragment as a child fiber.</div><div class="diff-info">@@ -363,16 +295,12 @@ function tryHydrateSuspense(</div><div>     // While a Suspense Instance does have children, we won't step into</div><div>     // it during the first pass. Instead, we'll reenter it later.</div><div>     nextHydratableInstance = null;</div><div class="diff-added">+    return true;</div><div>   }</div><div class="diff-removed">-  return suspenseInstance;</div><div class="diff-added">+  return false;</div><div> }</div><div> </div><div class="diff-removed">-export const HydrationMismatchException: mixed = new Error(</div><div class="diff-removed">-  'Hydration Mismatch Exception: This is not a real error, and should not leak into ' +</div><div class="diff-removed">-    "userspace. If you're seeing this, it's likely a bug in React.",</div><div class="diff-removed">-);</div><div class="diff-removed">-</div><div class="diff-removed">-function throwOnHydrationMismatch(fiber: Fiber, fromText: boolean = false) {</div><div class="diff-added">+function throwOnHydrationMismatch(fiber: Fiber) {</div><div>   let diff = '';</div><div>   if (__DEV__) {</div><div>     // Consume the diff root for this mismatch.</div><div class="diff-info">@@ -383,9 +311,8 @@ function throwOnHydrationMismatch(fiber: Fiber, fromText: boolean = false) {</div><div>       diff = describeDiff(diffRoot);</div><div>     }</div><div>   }</div><div class="diff-removed">-  const error = new Error(</div><div class="diff-removed">-    `Hydration failed because the server rendered ${fromText ? 'text' : 'HTML'} didn't match the client. As a result this tree will be regenerated on the client. This can happen if a SSR-ed Client Component used:</div><div class="diff-removed">-` +</div><div class="diff-added">+  throw new Error(</div><div class="diff-added">+    "Hydration failed because the server rendered HTML didn't match the client. As a result this tree will be regenerated on the client. This can happen if a SSR-ed Client Component used:\n" +</div><div>       '\n' +</div><div>       "- A server/client branch `if (typeof window !== 'undefined')`.\n" +</div><div>       "- Variable input such as `Date.now()` or `Math.random()` which changes each time it's called.\n" +</div><div class="diff-info">@@ -398,8 +325,6 @@ function throwOnHydrationMismatch(fiber: Fiber, fromText: boolean = false) {</div><div>       'https://react.dev/link/hydration-mismatch' +</div><div>       diff,</div><div>   );</div><div class="diff-removed">-  queueHydrationError(createCapturedValueAtFiber(error, fiber));</div><div class="diff-removed">-  throw HydrationMismatchException;</div><div> }</div><div> </div><div> function claimHydratableSingleton(fiber: Fiber): void {</div><div class="diff-info">@@ -434,11 +359,7 @@ function claimHydratableSingleton(fiber: Fiber): void {</div><div> </div><div>     hydrationParentFiber = fiber;</div><div>     rootOrSingletonContext = true;</div><div class="diff-removed">-    nextHydratableInstance = getFirstHydratableChildWithinSingleton(</div><div class="diff-removed">-      fiber.type,</div><div class="diff-removed">-      instance,</div><div class="diff-removed">-      nextHydratableInstance,</div><div class="diff-removed">-    );</div><div class="diff-added">+    nextHydratableInstance = getFirstHydratableChild(instance);</div><div>   }</div><div> }</div><div> </div><div class="diff-info">@@ -446,7 +367,12 @@ function tryToClaimNextHydratableInstance(fiber: Fiber): void {</div><div>   if (!isHydrating) {</div><div>     return;</div><div>   }</div><div class="diff-removed">-</div><div class="diff-added">+  if (isHydratable && !isHydratableType(fiber.type, fiber.pendingProps)) {</div><div class="diff-added">+    // This fiber never hydrates from the DOM and always does an insert</div><div class="diff-added">+    isHydrating = false;</div><div class="diff-added">+    hydrationParentFiber = fiber;</div><div class="diff-added">+    return;</div><div class="diff-added">+  }</div><div>   // Validate that this is ok to render here before any mismatches.</div><div>   const currentHostContext = getHostContext();</div><div>   const shouldKeepWarning = validateHydratableInstance(</div><div class="diff-info">@@ -487,28 +413,15 @@ function tryToClaimNextHydratableTextInstance(fiber: Fiber): void {</div><div>   }</div><div> }</div><div> </div><div class="diff-removed">-function claimNextHydratableActivityInstance(fiber: Fiber): ActivityInstance {</div><div class="diff-removed">-  const nextInstance = nextHydratableInstance;</div><div class="diff-removed">-  const activityInstance = nextInstance</div><div class="diff-removed">-    ? tryHydrateActivity(fiber, nextInstance)</div><div class="diff-removed">-    : null;</div><div class="diff-removed">-  if (activityInstance === null) {</div><div class="diff-removed">-    warnNonHydratedInstance(fiber, nextInstance);</div><div class="diff-removed">-    throw throwOnHydrationMismatch(fiber);</div><div class="diff-added">+function tryToClaimNextHydratableSuspenseInstance(fiber: Fiber): void {</div><div class="diff-added">+  if (!isHydrating) {</div><div class="diff-added">+    return;</div><div>   }</div><div class="diff-removed">-  return activityInstance;</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function claimNextHydratableSuspenseInstance(fiber: Fiber): SuspenseInstance {</div><div>   const nextInstance = nextHydratableInstance;</div><div class="diff-removed">-  const suspenseInstance = nextInstance</div><div class="diff-removed">-    ? tryHydrateSuspense(fiber, nextInstance)</div><div class="diff-removed">-    : null;</div><div class="diff-removed">-  if (suspenseInstance === null) {</div><div class="diff-added">+  if (!nextInstance || !tryHydrateSuspense(fiber, nextInstance)) {</div><div>     warnNonHydratedInstance(fiber, nextInstance);</div><div class="diff-removed">-    throw throwOnHydrationMismatch(fiber);</div><div class="diff-added">+    throwOnHydrationMismatch(fiber);</div><div>   }</div><div class="diff-removed">-  return suspenseInstance;</div><div> }</div><div> </div><div> export function tryToClaimNextHydratableFormMarkerInstance(</div><div class="diff-info">@@ -559,7 +472,7 @@ function prepareToHydrateHostInstance(</div><div>     fiber,</div><div>   );</div><div>   if (!didHydrate && favorSafetyOverHydrationPerf) {</div><div class="diff-removed">-    throwOnHydrationMismatch(fiber, true);</div><div class="diff-added">+    throwOnHydrationMismatch(fiber);</div><div>   }</div><div> }</div><div> </div><div class="diff-info">@@ -625,29 +538,8 @@ function prepareToHydrateHostTextInstance(fiber: Fiber): void {</div><div>     parentProps,</div><div>   );</div><div>   if (!didHydrate && favorSafetyOverHydrationPerf) {</div><div class="diff-removed">-    throwOnHydrationMismatch(fiber, true);</div><div class="diff-removed">-  }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function prepareToHydrateHostActivityInstance(fiber: Fiber): void {</div><div class="diff-removed">-  if (!supportsHydration) {</div><div class="diff-removed">-    throw new Error(</div><div class="diff-removed">-      'Expected prepareToHydrateHostActivityInstance() to never be called. ' +</div><div class="diff-removed">-        'This error is likely caused by a bug in React. Please file an issue.',</div><div class="diff-removed">-    );</div><div class="diff-removed">-  }</div><div class="diff-removed">-  const activityState: null | ActivityState = fiber.memoizedState;</div><div class="diff-removed">-  const activityInstance: null | ActivityInstance =</div><div class="diff-removed">-    activityState !== null ? activityState.dehydrated : null;</div><div class="diff-removed">-</div><div class="diff-removed">-  if (!activityInstance) {</div><div class="diff-removed">-    throw new Error(</div><div class="diff-removed">-      'Expected to have a hydrated activity instance. ' +</div><div class="diff-removed">-        'This error is likely caused by a bug in React. Please file an issue.',</div><div class="diff-removed">-    );</div><div class="diff-added">+    throwOnHydrationMismatch(fiber);</div><div>   }</div><div class="diff-removed">-</div><div class="diff-removed">-  hydrateActivityInstance(activityInstance, fiber);</div><div> }</div><div> </div><div> function prepareToHydrateHostSuspenseInstance(fiber: Fiber): void {</div><div class="diff-info">@@ -672,23 +564,6 @@ function prepareToHydrateHostSuspenseInstance(fiber: Fiber): void {</div><div>   hydrateSuspenseInstance(suspenseInstance, fiber);</div><div> }</div><div> </div><div class="diff-removed">-function skipPastDehydratedActivityInstance(</div><div class="diff-removed">-  fiber: Fiber,</div><div class="diff-removed">-): null | HydratableInstance {</div><div class="diff-removed">-  const activityState: null | ActivityState = fiber.memoizedState;</div><div class="diff-removed">-  const activityInstance: null | ActivityInstance =</div><div class="diff-removed">-    activityState !== null ? activityState.dehydrated : null;</div><div class="diff-removed">-</div><div class="diff-removed">-  if (!activityInstance) {</div><div class="diff-removed">-    throw new Error(</div><div class="diff-removed">-      'Expected to have a hydrated suspense instance. ' +</div><div class="diff-removed">-        'This error is likely caused by a bug in React. Please file an issue.',</div><div class="diff-removed">-    );</div><div class="diff-removed">-  }</div><div class="diff-removed">-</div><div class="diff-removed">-  return getNextHydratableInstanceAfterActivityInstance(activityInstance);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div> function skipPastDehydratedSuspenseInstance(</div><div>   fiber: Fiber,</div><div> ): null | HydratableInstance {</div><div class="diff-info">@@ -716,15 +591,14 @@ function popToNextHostParent(fiber: Fiber): void {</div><div>   hydrationParentFiber = fiber.return;</div><div>   while (hydrationParentFiber) {</div><div>     switch (hydrationParentFiber.tag) {</div><div class="diff-added">+      case HostRoot:</div><div class="diff-added">+      case HostSingleton:</div><div class="diff-added">+        rootOrSingletonContext = true;</div><div class="diff-added">+        return;</div><div>       case HostComponent:</div><div class="diff-removed">-      case ActivityComponent:</div><div>       case SuspenseComponent:</div><div>         rootOrSingletonContext = false;</div><div>         return;</div><div class="diff-removed">-      case HostSingleton:</div><div class="diff-removed">-      case HostRoot:</div><div class="diff-removed">-        rootOrSingletonContext = true;</div><div class="diff-removed">-        return;</div><div>       default:</div><div>         hydrationParentFiber = hydrationParentFiber.return;</div><div>     }</div><div class="diff-info">@@ -749,25 +623,20 @@ function popHydrationState(fiber: Fiber): boolean {</div><div>     return false;</div><div>   }</div><div> </div><div class="diff-removed">-  const tag = fiber.tag;</div><div class="diff-removed">-</div><div class="diff-added">+  let shouldClear = false;</div><div>   if (supportsSingletons) {</div><div>     // With float we never clear the Root, or Singleton instances. We also do not clear Instances</div><div>     // that have singleton text content</div><div>     if (</div><div class="diff-removed">-      tag !== HostRoot &&</div><div class="diff-removed">-      tag !== HostSingleton &&</div><div class="diff-added">+      fiber.tag !== HostRoot &&</div><div class="diff-added">+      fiber.tag !== HostSingleton &&</div><div>       !(</div><div class="diff-removed">-        tag === HostComponent &&</div><div class="diff-added">+        fiber.tag === HostComponent &&</div><div>         (!shouldDeleteUnhydratedTailInstances(fiber.type) ||</div><div>           shouldSetTextContent(fiber.type, fiber.memoizedProps))</div><div>       )</div><div>     ) {</div><div class="diff-removed">-      const nextInstance = nextHydratableInstance;</div><div class="diff-removed">-      if (nextInstance) {</div><div class="diff-removed">-        warnIfUnhydratedTailNodes(fiber);</div><div class="diff-removed">-        throwOnHydrationMismatch(fiber);</div><div class="diff-removed">-      }</div><div class="diff-added">+      shouldClear = true;</div><div>     }</div><div>   } else {</div><div>     // If we have any remaining hydratable nodes, we need to delete them now.</div><div class="diff-info">@@ -775,28 +644,24 @@ function popHydrationState(fiber: Fiber): boolean {</div><div>     // other nodes in them. We also ignore components with pure text content in</div><div>     // side of them. We also don't delete anything inside the root container.</div><div>     if (</div><div class="diff-removed">-      tag !== HostRoot &&</div><div class="diff-removed">-      (tag !== HostComponent ||</div><div class="diff-added">+      fiber.tag !== HostRoot &&</div><div class="diff-added">+      (fiber.tag !== HostComponent ||</div><div>         (shouldDeleteUnhydratedTailInstances(fiber.type) &&</div><div>           !shouldSetTextContent(fiber.type, fiber.memoizedProps)))</div><div>     ) {</div><div class="diff-removed">-      const nextInstance = nextHydratableInstance;</div><div class="diff-removed">-      if (nextInstance) {</div><div class="diff-removed">-        warnIfUnhydratedTailNodes(fiber);</div><div class="diff-removed">-        throwOnHydrationMismatch(fiber);</div><div class="diff-removed">-      }</div><div class="diff-added">+      shouldClear = true;</div><div class="diff-added">+    }</div><div class="diff-added">+  }</div><div class="diff-added">+  if (shouldClear) {</div><div class="diff-added">+    const nextInstance = nextHydratableInstance;</div><div class="diff-added">+    if (nextInstance) {</div><div class="diff-added">+      warnIfUnhydratedTailNodes(fiber);</div><div class="diff-added">+      throwOnHydrationMismatch(fiber);</div><div>     }</div><div>   }</div><div>   popToNextHostParent(fiber);</div><div class="diff-removed">-  if (tag === SuspenseComponent) {</div><div class="diff-added">+  if (fiber.tag === SuspenseComponent) {</div><div>     nextHydratableInstance = skipPastDehydratedSuspenseInstance(fiber);</div><div class="diff-removed">-  } else if (tag === ActivityComponent) {</div><div class="diff-removed">-    nextHydratableInstance = skipPastDehydratedActivityInstance(fiber);</div><div class="diff-removed">-  } else if (supportsSingletons && tag === HostSingleton) {</div><div class="diff-removed">-    nextHydratableInstance = getNextHydratableSiblingAfterSingleton(</div><div class="diff-removed">-      fiber.type,</div><div class="diff-removed">-      nextHydratableInstance,</div><div class="diff-removed">-    );</div><div>   } else {</div><div>     nextHydratableInstance = hydrationParentFiber</div><div>       ? getNextHydratableSibling(fiber.stateNode)</div><div class="diff-info">@@ -835,18 +700,14 @@ function resetHydrationState(): void {</div><div>   didSuspendOrErrorDEV = false;</div><div> }</div><div> </div><div class="diff-removed">-export function upgradeHydrationErrorsToRecoverable(): Array<</div><div class="diff-removed">-  CapturedValue<mixed>,</div><div class="diff-removed">-> | null {</div><div class="diff-removed">-  const queuedErrors = hydrationErrors;</div><div class="diff-removed">-  if (queuedErrors !== null) {</div><div class="diff-added">+export function upgradeHydrationErrorsToRecoverable(): void {</div><div class="diff-added">+  if (hydrationErrors !== null) {</div><div>     // Successfully completed a forced client render. The errors that occurred</div><div>     // during the hydration attempt are now recovered. We will log them in</div><div>     // commit phase, once the entire tree has finished.</div><div class="diff-removed">-    queueRecoverableErrors(queuedErrors);</div><div class="diff-added">+    queueRecoverableErrors(hydrationErrors);</div><div>     hydrationErrors = null;</div><div>   }</div><div class="diff-removed">-  return queuedErrors;</div><div> }</div><div> </div><div> function getIsHydrating(): boolean {</div><div class="diff-info">@@ -869,32 +730,22 @@ export function emitPendingHydrationWarnings() {</div><div>     if (diffRoot !== null) {</div><div>       hydrationDiffRootDEV = null;</div><div>       const diff = describeDiff(diffRoot);</div><div class="diff-removed">-</div><div class="diff-removed">-      // Just pick the DFS-first leaf as the owner.</div><div class="diff-removed">-      // Should be good enough since most warnings only have a single error.</div><div class="diff-removed">-      let diffOwner: HydrationDiffNode = diffRoot;</div><div class="diff-removed">-      while (diffOwner.children.length > 0) {</div><div class="diff-removed">-        diffOwner = diffOwner.children[0];</div><div class="diff-removed">-      }</div><div class="diff-removed">-</div><div class="diff-removed">-      runWithFiberInDEV(diffOwner.fiber, () => {</div><div class="diff-removed">-        console.error(</div><div class="diff-removed">-          "A tree hydrated but some attributes of the server rendered HTML didn't match the client properties. This won't be patched up. " +</div><div class="diff-removed">-            'This can happen if a SSR-ed Client Component used:\n' +</div><div class="diff-removed">-            '\n' +</div><div class="diff-removed">-            "- A server/client branch `if (typeof window !== 'undefined')`.\n" +</div><div class="diff-removed">-            "- Variable input such as `Date.now()` or `Math.random()` which changes each time it's called.\n" +</div><div class="diff-removed">-            "- Date formatting in a user's locale which doesn't match the server.\n" +</div><div class="diff-removed">-            '- External changing data without sending a snapshot of it along with the HTML.\n' +</div><div class="diff-removed">-            '- Invalid HTML tag nesting.\n' +</div><div class="diff-removed">-            '\n' +</div><div class="diff-removed">-            'It can also happen if the client has a browser extension installed which messes with the HTML before React loaded.\n' +</div><div class="diff-removed">-            '\n' +</div><div class="diff-removed">-            '%s%s',</div><div class="diff-removed">-          'https://react.dev/link/hydration-mismatch',</div><div class="diff-removed">-          diff,</div><div class="diff-removed">-        );</div><div class="diff-removed">-      });</div><div class="diff-added">+      console.error(</div><div class="diff-added">+        "A tree hydrated but some attributes of the server rendered HTML didn't match the client properties. This won't be patched up. " +</div><div class="diff-added">+          'This can happen if a SSR-ed Client Component used:\n' +</div><div class="diff-added">+          '\n' +</div><div class="diff-added">+          "- A server/client branch `if (typeof window !== 'undefined')`.\n" +</div><div class="diff-added">+          "- Variable input such as `Date.now()` or `Math.random()` which changes each time it's called.\n" +</div><div class="diff-added">+          "- Date formatting in a user's locale which doesn't match the server.\n" +</div><div class="diff-added">+          '- External changing data without sending a snapshot of it along with the HTML.\n' +</div><div class="diff-added">+          '- Invalid HTML tag nesting.\n' +</div><div class="diff-added">+          '\n' +</div><div class="diff-added">+          'It can also happen if the client has a browser extension installed which messes with the HTML before React loaded.\n' +</div><div class="diff-added">+          '\n' +</div><div class="diff-added">+          '%s%s',</div><div class="diff-added">+        'https://react.dev/link/hydration-mismatch',</div><div class="diff-added">+        diff,</div><div class="diff-added">+      );</div><div>     }</div><div>   }</div><div> }</div><div class="diff-info">@@ -903,17 +754,14 @@ export {</div><div>   warnIfHydrating,</div><div>   enterHydrationState,</div><div>   getIsHydrating,</div><div class="diff-removed">-  reenterHydrationStateFromDehydratedActivityInstance,</div><div>   reenterHydrationStateFromDehydratedSuspenseInstance,</div><div>   resetHydrationState,</div><div>   claimHydratableSingleton,</div><div>   tryToClaimNextHydratableInstance,</div><div>   tryToClaimNextHydratableTextInstance,</div><div class="diff-removed">-  claimNextHydratableActivityInstance,</div><div class="diff-removed">-  claimNextHydratableSuspenseInstance,</div><div class="diff-added">+  tryToClaimNextHydratableSuspenseInstance,</div><div>   prepareToHydrateHostInstance,</div><div>   prepareToHydrateHostTextInstance,</div><div class="diff-removed">-  prepareToHydrateHostActivityInstance,</div><div>   prepareToHydrateHostSuspenseInstance,</div><div>   popHydrationState,</div><div> };</div><div>\ No newline at end of file</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    