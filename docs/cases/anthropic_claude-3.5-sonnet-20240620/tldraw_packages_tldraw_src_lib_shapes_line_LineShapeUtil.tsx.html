<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/tldraw/src/lib/shapes/line/LineShapeUtil.tsx - Sonnet 3.5</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/tldraw/src/lib/shapes/line/LineShapeUtil.tsx</h1>
        <h2>Model: Sonnet 3.5</h2>
        <p><a href="../../models/anthropic_claude-3.5-sonnet-20240620.html">All Sonnet 3.5 Cases</a> | <a href="../../cases.html">All Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> Sonnet 3.5</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 40485</p>
                <p><strong>Native Prompt Tokens:</strong> 49630</p>
                <p><strong>Native Completion Tokens:</strong> 330</p>
                <p><strong>Native Tokens Reasoning:</strong> 0</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Cost:</strong> $0.15384</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/anthropic_claude-3.5-sonnet-20240620/tldraw_packages_tldraw_src_lib_shapes_line_LineShapeUtil.tsx/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/anthropic_claude-3.5-sonnet-20240620/tldraw_packages_tldraw_src_lib_shapes_line_LineShapeUtil.tsx/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/anthropic_claude-3.5-sonnet-20240620/tldraw_packages_tldraw_src_lib_shapes_line_LineShapeUtil.tsx/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div></div><div>index 1529ad147..95bccb8b7 100644</div><div class="diff-header">--- a/tldraw_packages_tldraw_src_lib_shapes_line_LineShapeUtil.tsx_expectedoutput.txt (expected):tmp/tmpb24wbpgr_expected.txt	</div><div class="diff-header">+++ b/tldraw_packages_tldraw_src_lib_shapes_line_LineShapeUtil.tsx_extracted.txt (actual):tmp/tmpl3e3hdsr_actual.txt	</div><div class="diff-info">@@ -1,449 +1,27 @@</div><div class="diff-removed">-import {</div><div class="diff-removed">-	CubicSpline2d,</div><div class="diff-removed">-	Group2d,</div><div class="diff-removed">-	HandleSnapGeometry,</div><div class="diff-removed">-	Polyline2d,</div><div class="diff-removed">-	SVGContainer,</div><div class="diff-removed">-	ShapeUtil,</div><div class="diff-removed">-	TLHandle,</div><div class="diff-removed">-	TLHandleDragInfo,</div><div class="diff-removed">-	TLLineShape,</div><div class="diff-removed">-	TLLineShapePoint,</div><div class="diff-removed">-	TLResizeInfo,</div><div class="diff-removed">-	Vec,</div><div class="diff-removed">-	WeakCache,</div><div class="diff-removed">-	ZERO_INDEX_KEY,</div><div class="diff-removed">-	getIndexAbove,</div><div class="diff-removed">-	getIndexBetween,</div><div class="diff-removed">-	getIndices,</div><div class="diff-removed">-	getPerfectDashProps,</div><div class="diff-removed">-	lerp,</div><div class="diff-removed">-	lineShapeMigrations,</div><div class="diff-removed">-	lineShapeProps,</div><div class="diff-removed">-	mapObjectMapValues,</div><div class="diff-removed">-	maybeSnapToGrid,</div><div class="diff-removed">-	sortByIndex,</div><div class="diff-removed">-} from '@tldraw/editor'</div><div class="diff-added">+Here are the key changes made to the LineShapeUtil class in this file:</div><div> </div><div class="diff-removed">-import { STROKE_SIZES } from '../arrow/shared'</div><div class="diff-removed">-import { useDefaultColorTheme } from '../shared/useDefaultColorTheme'</div><div class="diff-removed">-import { getLineDrawPath, getLineIndicatorPath } from './components/getLinePath'</div><div class="diff-removed">-import { getDrawLinePathData } from './line-helpers'</div><div class="diff-added">+1. The class now extends ShapeUtil<TLLineShape>.</div><div> </div><div class="diff-removed">-const handlesCache = new WeakCache<TLLineShape['props'], TLHandle[]>()</div><div class="diff-added">+2. Several methods were changed from property functions to regular methods:</div><div class="diff-added">+   - hideResizeHandles()</div><div class="diff-added">+   - hideRotateHandle() </div><div class="diff-added">+   - hideSelectionBoundsFg()</div><div class="diff-added">+   - hideSelectionBoundsBg()</div><div> </div><div class="diff-removed">-/** @public */</div><div class="diff-removed">-export class LineShapeUtil extends ShapeUtil<TLLineShape> {</div><div class="diff-removed">-	static override type = 'line' as const</div><div class="diff-removed">-	static override props = lineShapeProps</div><div class="diff-removed">-	static override migrations = lineShapeMigrations</div><div class="diff-added">+3. An onBeforeCreate method was added to prevent creating lines with identical start and end points.</div><div> </div><div class="diff-removed">-	override canTabTo() {</div><div class="diff-removed">-		return false</div><div class="diff-removed">-	}</div><div class="diff-removed">-	override hideResizeHandles() {</div><div class="diff-removed">-		return true</div><div class="diff-removed">-	}</div><div class="diff-removed">-	override hideRotateHandle() {</div><div class="diff-removed">-		return true</div><div class="diff-removed">-	}</div><div class="diff-removed">-	override hideSelectionBoundsFg() {</div><div class="diff-removed">-		return true</div><div class="diff-removed">-	}</div><div class="diff-removed">-	override hideSelectionBoundsBg() {</div><div class="diff-removed">-		return true</div><div class="diff-removed">-	}</div><div class="diff-added">+4. The onHandleDrag method was updated to use maybeSnapToGrid when updating handle positions.</div><div> </div><div class="diff-removed">-	override getDefaultProps(): TLLineShape['props'] {</div><div class="diff-removed">-		const [start, end] = getIndices(2)</div><div class="diff-removed">-		return {</div><div class="diff-removed">-			dash: 'draw',</div><div class="diff-removed">-			size: 'm',</div><div class="diff-removed">-			color: 'black',</div><div class="diff-removed">-			spline: 'line',</div><div class="diff-removed">-			points: {</div><div class="diff-removed">-				[start]: { id: start, index: start, x: 0, y: 0 },</div><div class="diff-removed">-				[end]: { id: end, index: end, x: 0.1, y: 0.1 },</div><div class="diff-removed">-			},</div><div class="diff-removed">-			scale: 1,</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-added">+5. The component method now wraps the LineShapeSvg in an SVGContainer with a min width/height of 50px.</div><div> </div><div class="diff-removed">-	getGeometry(shape: TLLineShape) {</div><div class="diff-removed">-		// todo: should we have min size?</div><div class="diff-removed">-		return getGeometryForLineShape(shape)</div><div class="diff-removed">-	}</div><div class="diff-added">+6. A getInterpolatedProps method was added to support animating between different line states.</div><div> </div><div class="diff-removed">-	override getHandles(shape: TLLineShape) {</div><div class="diff-removed">-		return handlesCache.get(shape.props, () => {</div><div class="diff-removed">-			const spline = getGeometryForLineShape(shape)</div><div class="diff-added">+7. The toSvg method was simplified to just return the LineShapeSvg component.</div><div> </div><div class="diff-removed">-			const points = linePointsToArray(shape)</div><div class="diff-removed">-			const results: TLHandle[] = points.map((point) => ({</div><div class="diff-removed">-				...point,</div><div class="diff-removed">-				id: point.index,</div><div class="diff-removed">-				type: 'vertex',</div><div class="diff-removed">-				canSnap: true,</div><div class="diff-removed">-			}))</div><div class="diff-added">+8. A canTabTo method was added that returns false, indicating line shapes can't be tabbed to for accessibility navigation.</div><div> </div><div class="diff-removed">-			for (let i = 0; i < points.length - 1; i++) {</div><div class="diff-removed">-				const index = getIndexBetween(points[i].index, points[i + 1].index)</div><div class="diff-removed">-				const segment = spline.segments[i]</div><div class="diff-removed">-				const point = segment.midPoint()</div><div class="diff-removed">-				results.push({</div><div class="diff-removed">-					id: index,</div><div class="diff-removed">-					type: 'create',</div><div class="diff-removed">-					index,</div><div class="diff-removed">-					x: point.x,</div><div class="diff-removed">-					y: point.y,</div><div class="diff-removed">-					canSnap: true,</div><div class="diff-removed">-				})</div><div class="diff-removed">-			}</div><div class="diff-added">+9. Some internal helper functions like getGeometryForLineShape and LineShapeSvg were moved outside the class definition.</div><div> </div><div class="diff-removed">-			return results.sort(sortByIndex)</div><div class="diff-removed">-		})</div><div class="diff-removed">-	}</div><div class="diff-added">+10. The use of WeakMapCache was changed to WeakCache.</div><div> </div><div class="diff-removed">-	//   Events</div><div class="diff-removed">-</div><div class="diff-removed">-	override onResize(shape: TLLineShape, info: TLResizeInfo<TLLineShape>) {</div><div class="diff-removed">-		const { scaleX, scaleY } = info</div><div class="diff-removed">-</div><div class="diff-removed">-		return {</div><div class="diff-removed">-			props: {</div><div class="diff-removed">-				points: mapObjectMapValues(shape.props.points, (_, { id, index, x, y }) => ({</div><div class="diff-removed">-					id,</div><div class="diff-removed">-					index,</div><div class="diff-removed">-					x: x * scaleX,</div><div class="diff-removed">-					y: y * scaleY,</div><div class="diff-removed">-				})),</div><div class="diff-removed">-			},</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-removed">-</div><div class="diff-removed">-	override onBeforeCreate(next: TLLineShape): void | TLLineShape {</div><div class="diff-removed">-		const {</div><div class="diff-removed">-			props: { points },</div><div class="diff-removed">-		} = next</div><div class="diff-removed">-		const pointKeys = Object.keys(points)</div><div class="diff-removed">-</div><div class="diff-removed">-		if (pointKeys.length < 2) {</div><div class="diff-removed">-			return</div><div class="diff-removed">-		}</div><div class="diff-removed">-</div><div class="diff-removed">-		const firstPoint = points[pointKeys[0]]</div><div class="diff-removed">-		const allSame = pointKeys.every((key) => {</div><div class="diff-removed">-			const point = points[key]</div><div class="diff-removed">-			return point.x === firstPoint.x && point.y === firstPoint.y</div><div class="diff-removed">-		})</div><div class="diff-removed">-		if (allSame) {</div><div class="diff-removed">-			const lastKey = pointKeys[pointKeys.length - 1]</div><div class="diff-removed">-			points[lastKey] = {</div><div class="diff-removed">-				...points[lastKey],</div><div class="diff-removed">-				x: points[lastKey].x + 0.1,</div><div class="diff-removed">-				y: points[lastKey].y + 0.1,</div><div class="diff-removed">-			}</div><div class="diff-removed">-			return next</div><div class="diff-removed">-		}</div><div class="diff-removed">-		return</div><div class="diff-removed">-	}</div><div class="diff-removed">-</div><div class="diff-removed">-	override onHandleDrag(shape: TLLineShape, { handle }: TLHandleDragInfo<TLLineShape>) {</div><div class="diff-removed">-		// we should only ever be dragging vertex handles</div><div class="diff-removed">-		if (handle.type !== 'vertex') return</div><div class="diff-removed">-		const newPoint = maybeSnapToGrid(new Vec(handle.x, handle.y), this.editor)</div><div class="diff-removed">-		return {</div><div class="diff-removed">-			...shape,</div><div class="diff-removed">-			props: {</div><div class="diff-removed">-				...shape.props,</div><div class="diff-removed">-				points: {</div><div class="diff-removed">-					...shape.props.points,</div><div class="diff-removed">-					[handle.id]: { id: handle.id, index: handle.index, x: newPoint.x, y: newPoint.y },</div><div class="diff-removed">-				},</div><div class="diff-removed">-			},</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-removed">-</div><div class="diff-removed">-	component(shape: TLLineShape) {</div><div class="diff-removed">-		return (</div><div class="diff-removed">-			<SVGContainer style={{ minWidth: 50, minHeight: 50 }}></div><div class="diff-removed">-				<LineShapeSvg shape={shape} /></div><div class="diff-removed">-			</SVGContainer></div><div class="diff-removed">-		)</div><div class="diff-removed">-	}</div><div class="diff-removed">-</div><div class="diff-removed">-	indicator(shape: TLLineShape) {</div><div class="diff-removed">-		const strokeWidth = STROKE_SIZES[shape.props.size] * shape.props.scale</div><div class="diff-removed">-		const spline = getGeometryForLineShape(shape)</div><div class="diff-removed">-		const { dash } = shape.props</div><div class="diff-removed">-</div><div class="diff-removed">-		let path: string</div><div class="diff-removed">-</div><div class="diff-removed">-		if (shape.props.spline === 'line') {</div><div class="diff-removed">-			const outline = spline.points</div><div class="diff-removed">-			if (dash === 'solid' || dash === 'dotted' || dash === 'dashed') {</div><div class="diff-removed">-				path = 'M' + outline[0] + 'L' + outline.slice(1)</div><div class="diff-removed">-			} else {</div><div class="diff-removed">-				const [innerPathData] = getDrawLinePathData(shape.id, outline, strokeWidth)</div><div class="diff-removed">-				path = innerPathData</div><div class="diff-removed">-			}</div><div class="diff-removed">-		} else {</div><div class="diff-removed">-			path = getLineIndicatorPath(shape, spline, strokeWidth)</div><div class="diff-removed">-		}</div><div class="diff-removed">-</div><div class="diff-removed">-		return <path d={path} /></div><div class="diff-removed">-	}</div><div class="diff-removed">-</div><div class="diff-removed">-	override toSvg(shape: TLLineShape) {</div><div class="diff-removed">-		return <LineShapeSvg shouldScale shape={shape} /></div><div class="diff-removed">-	}</div><div class="diff-removed">-</div><div class="diff-removed">-	override getHandleSnapGeometry(shape: TLLineShape): HandleSnapGeometry {</div><div class="diff-removed">-		const points = linePointsToArray(shape)</div><div class="diff-removed">-		return {</div><div class="diff-removed">-			points,</div><div class="diff-removed">-			getSelfSnapPoints: (handle) => {</div><div class="diff-removed">-				const index = this.getHandles(shape)</div><div class="diff-removed">-					.filter((h) => h.type === 'vertex')</div><div class="diff-removed">-					.findIndex((h) => h.id === handle.id)!</div><div class="diff-removed">-</div><div class="diff-removed">-				// We want to skip the current and adjacent handles</div><div class="diff-removed">-				return points.filter((_, i) => Math.abs(i - index) > 1).map(Vec.From)</div><div class="diff-removed">-			},</div><div class="diff-removed">-			getSelfSnapOutline: (handle) => {</div><div class="diff-removed">-				// We want to skip the segments that include the handle, so</div><div class="diff-removed">-				// find the index of the handle that shares the same index property</div><div class="diff-removed">-				// as the initial dragging handle; this catches a quirk of create handles</div><div class="diff-removed">-				const index = this.getHandles(shape)</div><div class="diff-removed">-					.filter((h) => h.type === 'vertex')</div><div class="diff-removed">-					.findIndex((h) => h.id === handle.id)!</div><div class="diff-removed">-</div><div class="diff-removed">-				// Get all the outline segments from the shape that don't include the handle</div><div class="diff-removed">-				const segments = getGeometryForLineShape(shape).segments.filter(</div><div class="diff-removed">-					(_, i) => i !== index - 1 && i !== index</div><div class="diff-removed">-				)</div><div class="diff-removed">-</div><div class="diff-removed">-				if (!segments.length) return null</div><div class="diff-removed">-				return new Group2d({ children: segments })</div><div class="diff-removed">-			},</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-removed">-	override getInterpolatedProps(</div><div class="diff-removed">-		startShape: TLLineShape,</div><div class="diff-removed">-		endShape: TLLineShape,</div><div class="diff-removed">-		t: number</div><div class="diff-removed">-	): TLLineShape['props'] {</div><div class="diff-removed">-		const startPoints = linePointsToArray(startShape)</div><div class="diff-removed">-		const endPoints = linePointsToArray(endShape)</div><div class="diff-removed">-</div><div class="diff-removed">-		const pointsToUseStart: TLLineShapePoint[] = []</div><div class="diff-removed">-		const pointsToUseEnd: TLLineShapePoint[] = []</div><div class="diff-removed">-</div><div class="diff-removed">-		let index = ZERO_INDEX_KEY</div><div class="diff-removed">-</div><div class="diff-removed">-		if (startPoints.length > endPoints.length) {</div><div class="diff-removed">-			// we'll need to expand points</div><div class="diff-removed">-			for (let i = 0; i < startPoints.length; i++) {</div><div class="diff-removed">-				pointsToUseStart[i] = { ...startPoints[i] }</div><div class="diff-removed">-				if (endPoints[i] === undefined) {</div><div class="diff-removed">-					pointsToUseEnd[i] = { ...endPoints[endPoints.length - 1], id: index }</div><div class="diff-removed">-				} else {</div><div class="diff-removed">-					pointsToUseEnd[i] = { ...endPoints[i], id: index }</div><div class="diff-removed">-				}</div><div class="diff-removed">-				index = getIndexAbove(index)</div><div class="diff-removed">-			}</div><div class="diff-removed">-		} else if (endPoints.length > startPoints.length) {</div><div class="diff-removed">-			// we'll need to converge points</div><div class="diff-removed">-			for (let i = 0; i < endPoints.length; i++) {</div><div class="diff-removed">-				pointsToUseEnd[i] = { ...endPoints[i] }</div><div class="diff-removed">-				if (startPoints[i] === undefined) {</div><div class="diff-removed">-					pointsToUseStart[i] = {</div><div class="diff-removed">-						...startPoints[startPoints.length - 1],</div><div class="diff-removed">-						id: index,</div><div class="diff-removed">-					}</div><div class="diff-removed">-				} else {</div><div class="diff-removed">-					pointsToUseStart[i] = { ...startPoints[i], id: index }</div><div class="diff-removed">-				}</div><div class="diff-removed">-				index = getIndexAbove(index)</div><div class="diff-removed">-			}</div><div class="diff-removed">-		} else {</div><div class="diff-removed">-			// noop, easy</div><div class="diff-removed">-			for (let i = 0; i < endPoints.length; i++) {</div><div class="diff-removed">-				pointsToUseStart[i] = startPoints[i]</div><div class="diff-removed">-				pointsToUseEnd[i] = endPoints[i]</div><div class="diff-removed">-			}</div><div class="diff-removed">-		}</div><div class="diff-removed">-</div><div class="diff-removed">-		return {</div><div class="diff-removed">-			...(t > 0.5 ? endShape.props : startShape.props),</div><div class="diff-removed">-			points: Object.fromEntries(</div><div class="diff-removed">-				pointsToUseStart.map((point, i) => {</div><div class="diff-removed">-					const endPoint = pointsToUseEnd[i]</div><div class="diff-removed">-					return [</div><div class="diff-removed">-						point.id,</div><div class="diff-removed">-						{</div><div class="diff-removed">-							...point,</div><div class="diff-removed">-							x: lerp(point.x, endPoint.x, t),</div><div class="diff-removed">-							y: lerp(point.y, endPoint.y, t),</div><div class="diff-removed">-						},</div><div class="diff-removed">-					]</div><div class="diff-removed">-				})</div><div class="diff-removed">-			),</div><div class="diff-removed">-			scale: lerp(startShape.props.scale, endShape.props.scale, t),</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function linePointsToArray(shape: TLLineShape) {</div><div class="diff-removed">-	return Object.values(shape.props.points).sort(sortByIndex)</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-/** @public */</div><div class="diff-removed">-export function getGeometryForLineShape(shape: TLLineShape): CubicSpline2d | Polyline2d {</div><div class="diff-removed">-	const points = linePointsToArray(shape).map(Vec.From)</div><div class="diff-removed">-</div><div class="diff-removed">-	switch (shape.props.spline) {</div><div class="diff-removed">-		case 'cubic': {</div><div class="diff-removed">-			return new CubicSpline2d({ points })</div><div class="diff-removed">-		}</div><div class="diff-removed">-		case 'line': {</div><div class="diff-removed">-			return new Polyline2d({ points })</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function LineShapeSvg({</div><div class="diff-removed">-	shape,</div><div class="diff-removed">-	shouldScale = false,</div><div class="diff-removed">-	forceSolid = false,</div><div class="diff-removed">-}: {</div><div class="diff-removed">-	shape: TLLineShape</div><div class="diff-removed">-	shouldScale?: boolean</div><div class="diff-removed">-	forceSolid?: boolean</div><div class="diff-removed">-}) {</div><div class="diff-removed">-	const theme = useDefaultColorTheme()</div><div class="diff-removed">-</div><div class="diff-removed">-	const spline = getGeometryForLineShape(shape)</div><div class="diff-removed">-	const { dash, color, size } = shape.props</div><div class="diff-removed">-</div><div class="diff-removed">-	const scaleFactor = 1 / shape.props.scale</div><div class="diff-removed">-</div><div class="diff-removed">-	const scale = shouldScale ? scaleFactor : 1</div><div class="diff-removed">-</div><div class="diff-removed">-	const strokeWidth = STROKE_SIZES[size] * shape.props.scale</div><div class="diff-removed">-</div><div class="diff-removed">-	// Line style lines</div><div class="diff-removed">-	if (shape.props.spline === 'line') {</div><div class="diff-removed">-		if (dash === 'solid') {</div><div class="diff-removed">-			const outline = spline.points</div><div class="diff-removed">-			const pathData = 'M' + outline[0] + 'L' + outline.slice(1)</div><div class="diff-removed">-</div><div class="diff-removed">-			return (</div><div class="diff-removed">-				<path</div><div class="diff-removed">-					d={pathData}</div><div class="diff-removed">-					stroke={theme[color].solid}</div><div class="diff-removed">-					strokeWidth={strokeWidth}</div><div class="diff-removed">-					fill="none"</div><div class="diff-removed">-					transform={`scale(${scale})`}</div><div class="diff-removed">-				/></div><div class="diff-removed">-			)</div><div class="diff-removed">-		}</div><div class="diff-removed">-</div><div class="diff-removed">-		if (dash === 'dashed' || dash === 'dotted') {</div><div class="diff-removed">-			return (</div><div class="diff-removed">-				<g stroke={theme[color].solid} strokeWidth={strokeWidth} transform={`scale(${scale})`}></div><div class="diff-removed">-					{spline.segments.map((segment, i) => {</div><div class="diff-removed">-						const { strokeDasharray, strokeDashoffset } = forceSolid</div><div class="diff-removed">-							? { strokeDasharray: 'none', strokeDashoffset: 'none' }</div><div class="diff-removed">-							: getPerfectDashProps(segment.length, strokeWidth, {</div><div class="diff-removed">-									style: dash,</div><div class="diff-removed">-									start: i > 0 ? 'outset' : 'none',</div><div class="diff-removed">-									end: i < spline.segments.length - 1 ? 'outset' : 'none',</div><div class="diff-removed">-								})</div><div class="diff-removed">-</div><div class="diff-removed">-						return (</div><div class="diff-removed">-							<path</div><div class="diff-removed">-								key={i}</div><div class="diff-removed">-								strokeDasharray={strokeDasharray}</div><div class="diff-removed">-								strokeDashoffset={strokeDashoffset}</div><div class="diff-removed">-								d={segment.getSvgPathData(true)}</div><div class="diff-removed">-								fill="none"</div><div class="diff-removed">-							/></div><div class="diff-removed">-						)</div><div class="diff-removed">-					})}</div><div class="diff-removed">-				</g></div><div class="diff-removed">-			)</div><div class="diff-removed">-		}</div><div class="diff-removed">-</div><div class="diff-removed">-		if (dash === 'draw') {</div><div class="diff-removed">-			const outline = spline.points</div><div class="diff-removed">-			const [_, outerPathData] = getDrawLinePathData(shape.id, outline, strokeWidth)</div><div class="diff-removed">-</div><div class="diff-removed">-			return (</div><div class="diff-removed">-				<path</div><div class="diff-removed">-					d={outerPathData}</div><div class="diff-removed">-					stroke={theme[color].solid}</div><div class="diff-removed">-					strokeWidth={strokeWidth}</div><div class="diff-removed">-					fill="none"</div><div class="diff-removed">-					transform={`scale(${scale})`}</div><div class="diff-removed">-				/></div><div class="diff-removed">-			)</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-removed">-	// Cubic style spline</div><div class="diff-removed">-	if (shape.props.spline === 'cubic') {</div><div class="diff-removed">-		const splinePath = spline.getSvgPathData()</div><div class="diff-removed">-		if (dash === 'solid') {</div><div class="diff-removed">-			return (</div><div class="diff-removed">-				<path</div><div class="diff-removed">-					strokeWidth={strokeWidth}</div><div class="diff-removed">-					stroke={theme[color].solid}</div><div class="diff-removed">-					fill="none"</div><div class="diff-removed">-					d={splinePath}</div><div class="diff-removed">-					transform={`scale(${scale})`}</div><div class="diff-removed">-				/></div><div class="diff-removed">-			)</div><div class="diff-removed">-		}</div><div class="diff-removed">-</div><div class="diff-removed">-		if (dash === 'dashed' || dash === 'dotted') {</div><div class="diff-removed">-			return (</div><div class="diff-removed">-				<g stroke={theme[color].solid} strokeWidth={strokeWidth} transform={`scale(${scale})`}></div><div class="diff-removed">-					{spline.segments.map((segment, i) => {</div><div class="diff-removed">-						const { strokeDasharray, strokeDashoffset } = getPerfectDashProps(</div><div class="diff-removed">-							segment.length,</div><div class="diff-removed">-							strokeWidth,</div><div class="diff-removed">-							{</div><div class="diff-removed">-								style: dash,</div><div class="diff-removed">-								start: i > 0 ? 'outset' : 'none',</div><div class="diff-removed">-								end: i < spline.segments.length - 1 ? 'outset' : 'none',</div><div class="diff-removed">-								forceSolid,</div><div class="diff-removed">-							}</div><div class="diff-removed">-						)</div><div class="diff-removed">-</div><div class="diff-removed">-						return (</div><div class="diff-removed">-							<path</div><div class="diff-removed">-								key={i}</div><div class="diff-removed">-								strokeDasharray={strokeDasharray}</div><div class="diff-removed">-								strokeDashoffset={strokeDashoffset}</div><div class="diff-removed">-								d={segment.getSvgPathData()}</div><div class="diff-removed">-								fill="none"</div><div class="diff-removed">-							/></div><div class="diff-removed">-						)</div><div class="diff-removed">-					})}</div><div class="diff-removed">-				</g></div><div class="diff-removed">-			)</div><div class="diff-removed">-		}</div><div class="diff-removed">-</div><div class="diff-removed">-		if (dash === 'draw') {</div><div class="diff-removed">-			return (</div><div class="diff-removed">-				<path</div><div class="diff-removed">-					d={getLineDrawPath(shape, spline, strokeWidth)}</div><div class="diff-removed">-					strokeWidth={1}</div><div class="diff-removed">-					stroke={theme[color].solid}</div><div class="diff-removed">-					fill={theme[color].solid}</div><div class="diff-removed">-					transform={`scale(${scale})`}</div><div class="diff-removed">-				/></div><div class="diff-removed">-			)</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-removed">-}</div><div>\ No newline at end of file</div><div class="diff-added">+These changes mostly relate to refactoring the shape util API, improving animation support, fixing some edge cases, and adding initial accessibility considerations. The core functionality of rendering and interacting with line shapes remains largely the same.</div><div>\ No newline at end of file</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    