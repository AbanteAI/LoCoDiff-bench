<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/tldraw/src/lib/ui/hooks/useClipboardEvents.ts - o4-mini-medium</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/tldraw/src/lib/ui/hooks/useClipboardEvents.ts</h1>
        <p><a href="../../models/openai_o4-mini.html">‚Üê Back to o4-mini-medium Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> o4-mini-medium</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 40274</p>
                <p><strong>Output Tokens:</strong> N/A</p>
                <p><strong>Native Prompt Tokens:</strong> 40340</p>
                <p><strong>Native Completion Tokens:</strong> 13653</p>
                <p><strong>Native Tokens Reasoning:</strong> 8256</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Runtime:</strong> N/As</p>
                <p><strong>Cost:</strong> $0.1044472</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/openai_o4-mini/tldraw_packages_tldraw_src_lib_ui_hooks_useClipboardEvents.ts/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/openai_o4-mini/tldraw_packages_tldraw_src_lib_ui_hooks_useClipboardEvents.ts/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/openai_o4-mini/tldraw_packages_tldraw_src_lib_ui_hooks_useClipboardEvents.ts/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div class="diff-header">--- tldraw_packages_tldraw_src_lib_ui_hooks_useClipboardEvents.ts_expectedoutput.txt (expected)+++ tldraw_packages_tldraw_src_lib_ui_hooks_useClipboardEvents.ts_extracted.txt (actual)@@ -32,6 +32,37 @@ 	'image/svg+xml',</div><div> ] satisfies string[]</div><div> </div><div class="diff-added">+/** @public */</div><div class="diff-added">+export const isValidHttpURL = (url: string) => {</div><div class="diff-added">+	try {</div><div class="diff-added">+		const u = new URL(url)</div><div class="diff-added">+		return u.protocol === 'http:' || u.protocol === 'https:'</div><div class="diff-added">+	} catch {</div><div class="diff-added">+		return false</div><div class="diff-added">+	}</div><div class="diff-added">+}</div><div class="diff-added">+</div><div class="diff-added">+/** @public */</div><div class="diff-added">+const getValidHttpURLList = (url: string) => {</div><div class="diff-added">+	const urls = url.split(/[\n\s]/)</div><div class="diff-added">+	for (const url of urls) {</div><div class="diff-added">+		try {</div><div class="diff-added">+			const u = new URL(url)</div><div class="diff-added">+			if (!(u.protocol === 'http:' || u.protocol === 'https:')) {</div><div class="diff-added">+				return</div><div class="diff-added">+			}</div><div class="diff-added">+		} catch {</div><div class="diff-added">+			return</div><div class="diff-added">+		}</div><div class="diff-added">+	}</div><div class="diff-added">+	return uniq(urls)</div><div class="diff-added">+}</div><div class="diff-added">+</div><div class="diff-added">+/** @public */</div><div class="diff-added">+const isSvgText = (text: string) => {</div><div class="diff-added">+	return /^<svg/.test(text)</div><div class="diff-added">+}</div><div class="diff-added">+</div><div> /**</div><div>  * Strip HTML tags from a string.</div><div>  * @param html - The HTML to strip.</div><div class="diff-info">@@ -44,42 +75,10 @@ 	return doc.body.textContent || doc.body.innerText || ''</div><div> }</div><div> </div><div class="diff-removed">-/** @public */</div><div class="diff-removed">-export const isValidHttpURL = (url: string) => {</div><div class="diff-removed">-	try {</div><div class="diff-removed">-		const u = new URL(url)</div><div class="diff-removed">-		return u.protocol === 'http:' || u.protocol === 'https:'</div><div class="diff-removed">-	} catch {</div><div class="diff-removed">-		return false</div><div class="diff-removed">-	}</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-/** @public */</div><div class="diff-removed">-const getValidHttpURLList = (url: string) => {</div><div class="diff-removed">-	const urls = url.split(/[\n\s]/)</div><div class="diff-removed">-	for (const url of urls) {</div><div class="diff-removed">-		try {</div><div class="diff-removed">-			const u = new URL(url)</div><div class="diff-removed">-			if (!(u.protocol === 'http:' || u.protocol === 'https:')) {</div><div class="diff-removed">-				return</div><div class="diff-removed">-			}</div><div class="diff-removed">-		} catch {</div><div class="diff-removed">-			return</div><div class="diff-removed">-		}</div><div class="diff-removed">-	}</div><div class="diff-removed">-	return uniq(urls)</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-/** @public */</div><div class="diff-removed">-const isSvgText = (text: string) => {</div><div class="diff-removed">-	return /^<svg/.test(text)</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div> const INPUTS = ['input', 'select', 'textarea']</div><div> </div><div> /**</div><div>  * Get whether to disallow clipboard events.</div><div class="diff-removed">- *</div><div>  * @internal</div><div>  */</div><div> function areShortcutsDisabled(editor: Editor) {</div><div class="diff-info">@@ -109,10 +108,10 @@ 	const validUrlList = getValidHttpURLList(data)</div><div> 	if (validUrlList) {</div><div> 		for (const url of validUrlList) {</div><div class="diff-removed">-			pasteUrl(editor, url, point)</div><div class="diff-added">+			pasteUrl(editor, url, point, sources)</div><div> 		}</div><div> 	} else if (isValidHttpURL(data)) {</div><div class="diff-removed">-		pasteUrl(editor, data, point)</div><div class="diff-added">+		pasteUrl(editor, data, point, sources)</div><div> 	} else if (isSvgText(data)) {</div><div> 		editor.markHistoryStoppingPoint('paste')</div><div> 		editor.putExternalContent({</div><div class="diff-info">@@ -137,30 +136,12 @@  * @internal</div><div>  */</div><div> type ClipboardThing =</div><div class="diff-removed">-	| {</div><div class="diff-removed">-			type: 'file'</div><div class="diff-removed">-			source: Promise<File | null></div><div class="diff-removed">-	  }</div><div class="diff-removed">-	| {</div><div class="diff-removed">-			type: 'blob'</div><div class="diff-removed">-			source: Promise<Blob | null></div><div class="diff-removed">-	  }</div><div class="diff-removed">-	| {</div><div class="diff-removed">-			type: 'url'</div><div class="diff-removed">-			source: Promise<string></div><div class="diff-removed">-	  }</div><div class="diff-removed">-	| {</div><div class="diff-removed">-			type: 'html'</div><div class="diff-removed">-			source: Promise<string></div><div class="diff-removed">-	  }</div><div class="diff-removed">-	| {</div><div class="diff-removed">-			type: 'text'</div><div class="diff-removed">-			source: Promise<string></div><div class="diff-removed">-	  }</div><div class="diff-removed">-	| {</div><div class="diff-removed">-			type: string</div><div class="diff-removed">-			source: Promise<string></div><div class="diff-removed">-	  }</div><div class="diff-added">+	| { type: 'file'; source: Promise<File | null> }</div><div class="diff-added">+	| { type: 'blob'; source: Promise<Blob | null> }</div><div class="diff-added">+	| { type: 'url'; source: Promise<string> }</div><div class="diff-added">+	| { type: 'html'; source: Promise<string> }</div><div class="diff-added">+	| { type: 'text'; source: Promise<string> }</div><div class="diff-added">+	| { type: string; source: Promise<string> }</div><div> </div><div> /**</div><div>  * Handle a paste using event clipboard data. This is the "original"</div><div class="diff-info">@@ -189,7 +170,6 @@ 	for (const item of Object.values(clipboardData.items)) {</div><div> 		switch (item.kind) {</div><div> 			case 'file': {</div><div class="diff-removed">-				// files are always blobs</div><div> 				things.push({</div><div> 					type: 'file',</div><div> 					source: new Promise((r) => r(item.getAsFile())) as Promise<File | null>,</div><div class="diff-info">@@ -197,7 +177,6 @@ 				break</div><div> 			}</div><div> 			case 'string': {</div><div class="diff-removed">-				// strings can be text or html</div><div> 				if (item.type === 'text/html') {</div><div> 					things.push({</div><div> 						type: 'html',</div><div class="diff-info">@@ -216,7 +195,7 @@ 		}</div><div> 	}</div><div> </div><div class="diff-removed">-	handleClipboardThings(editor, things, point)</div><div class="diff-added">+	return handleClipboardThings(editor, things, point)</div><div> }</div><div> </div><div> /**</div><div class="diff-info">@@ -226,6 +205,7 @@  * @param editor - The editor</div><div>  * @param clipboardItems - The clipboard items to handle</div><div>  * @param point - The point to paste at</div><div class="diff-added">+ * @param fallbackFiles - Files from DataTransfer.files to use as fallback</div><div>  * @internal</div><div>  */</div><div> const handlePasteFromClipboardApi = async ({</div><div class="diff-info">@@ -239,11 +219,6 @@ 	point?: VecLike</div><div> 	fallbackFiles?: File[]</div><div> }) => {</div><div class="diff-removed">-	// We need to populate the array of clipboard things</div><div class="diff-removed">-	// based on the ClipboardItems from the Clipboard API.</div><div class="diff-removed">-	// This is done in a different way than when using</div><div class="diff-removed">-	// the clipboard data from the paste event.</div><div class="diff-removed">-</div><div> 	const things: ClipboardThing[] = []</div><div> </div><div> 	for (const item of clipboardItems) {</div><div class="diff-info">@@ -252,10 +227,7 @@ 				const blobPromise = item</div><div> 					.getType(type)</div><div> 					.then((blob) => FileHelpers.rewriteMimeType(blob, getCanonicalClipboardReadType(type)))</div><div class="diff-removed">-				things.push({</div><div class="diff-removed">-					type: 'blob',</div><div class="diff-removed">-					source: blobPromise,</div><div class="diff-removed">-				})</div><div class="diff-added">+				things.push({ type: 'blob', source: blobPromise })</div><div> 				break</div><div> 			}</div><div> 		}</div><div class="diff-info">@@ -297,9 +269,6 @@ 			...fallbackFiles.map((f): ClipboardThing => ({ type: 'file', source: Promise.resolve(f) }))</div><div> 		)</div><div> 	} else if (fallbackFiles?.length && things.length === 0) {</div><div class="diff-removed">-		// Files pasted in Safari from your computer don't have types, so we need to use the fallback files directly</div><div class="diff-removed">-		// if they're available. This only works if pasted keyboard shortcuts. Pasting from the menu in Safari seems to never</div><div class="diff-removed">-		// let you access files that are copied from your computer.</div><div> 		things.push(</div><div> 			...fallbackFiles.map((f): ClipboardThing => ({ type: 'file', source: Promise.resolve(f) }))</div><div> 		)</div><div class="diff-info">@@ -310,10 +279,6 @@ </div><div> async function handleClipboardThings(editor: Editor, things: ClipboardThing[], point?: VecLike) {</div><div> 	// 1. Handle files</div><div class="diff-removed">-	//</div><div class="diff-removed">-	// We need to handle files separately because if we want them to</div><div class="diff-removed">-	// be placed next to each other, we need to create them all at once.</div><div class="diff-removed">-</div><div> 	const files = things.filter(</div><div> 		(t) => (t.type === 'file' || t.type === 'blob') && t.source !== null</div><div> 	) as Extract<ClipboardThing, { type: 'file' } | { type: 'blob' }>[]</div><div class="diff-info">@@ -323,16 +288,11 @@ 		if (files.length > editor.options.maxFilesAtOnce) {</div><div> 			throw Error('Too many files')</div><div> 		}</div><div class="diff-removed">-		const fileBlobs = compact(await Promise.all(files.map((t) => t.source)))</div><div class="diff-added">+		const fileBlobs = compact(await Promise.all(files.map((t) => t.source!)))</div><div> 		return await pasteFiles(editor, fileBlobs, point)</div><div> 	}</div><div> </div><div> 	// 2. Generate clipboard results for non-file things</div><div class="diff-removed">-	//</div><div class="diff-removed">-	// Getting the source from the items is async, however they must be accessed syncronously;</div><div class="diff-removed">-	// we can't await them in a loop. So we'll map them to promises and await them all at once,</div><div class="diff-removed">-	// then make decisions based on what we find.</div><div class="diff-removed">-</div><div> 	const results = await Promise.all<TLExternalContentSource>(</div><div> 		things</div><div> 			.filter((t) => t.type !== 'file')</div><div class="diff-info">@@ -340,11 +300,6 @@ 				(t) =></div><div> 					new Promise((r) => {</div><div> 						const thing = t as Exclude<ClipboardThing, { type: 'file' } | { type: 'blob' }></div><div class="diff-removed">-</div><div class="diff-removed">-						if (thing.type === 'file') {</div><div class="diff-removed">-							r({ type: 'error', data: null, reason: 'unexpected file' })</div><div class="diff-removed">-							return</div><div class="diff-removed">-						}</div><div> </div><div> 						thing.source.then((text) => {</div><div> 							// first, see if we can find tldraw content, which is JSON inside of an html comment</div><div class="diff-info">@@ -404,7 +359,7 @@ 									return</div><div> 								}</div><div> </div><div class="diff-removed">-								// if we have not found a tldraw comment, Otherwise, try to parse the text as JSON directly.</div><div class="diff-added">+								// if we have not found a tldraw comment, try to parse the text as JSON directly.</div><div> 								try {</div><div> 									const json = JSON.parse(text)</div><div> 									if (json.type === 'excalidraw/clipboard') {</div><div class="diff-info">@@ -428,12 +383,9 @@ 			)</div><div> 	)</div><div> </div><div class="diff-removed">-	// 3.</div><div class="diff-removed">-	//</div><div class="diff-removed">-	// Now that we know what kind of stuff we're dealing with, we can actual create some content.</div><div class="diff-added">+	// 3. Now that we know what kind of stuff we're dealing with, we can actually create some content.</div><div> 	// There are priorities here, so order matters: we've already handled images and files, which</div><div class="diff-removed">-	// take first priority; then we want to handle tldraw content, then excalidraw content, then</div><div class="diff-removed">-	// html content, then links, and finally text content.</div><div class="diff-added">+	// take first priority; then tldraw content; then excalidraw content; then html content; then links; and finally text content.</div><div> </div><div> 	// Try to paste tldraw content</div><div> 	for (const result of results) {</div><div class="diff-info">@@ -461,7 +413,7 @@ 			const bodyNode = rootNode.querySelector('body')</div><div> </div><div> 			// Edge on Windows 11 home appears to paste a link as a single <a/> in</div><div class="diff-removed">-			// the HTML document. If we're pasting a single like tag we'll just</div><div class="diff-added">+			// the HTML document. If we're pasting a single link tag we'll just</div><div> 			// assume the user meant to paste the URL.</div><div> 			const isHtmlSingleLink =</div><div> 				bodyNode &&</div><div class="diff-info">@@ -481,7 +433,7 @@ 			if (!results.some((r) => r.type === 'text' && r.subtype !== 'html') && result.data.trim()) {</div><div> 				const html = stripHtml(result.data) ?? ''</div><div> 				if (html) {</div><div class="diff-removed">-					handleText(editor, stripHtml(result.data), point, results)</div><div class="diff-added">+					handleText(editor, html, point, results)</div><div> 					return</div><div> 				}</div><div> 			}</div><div class="diff-info">@@ -502,8 +454,10 @@ 				}</div><div> 			}</div><div> 		}</div><div class="diff-removed">-</div><div class="diff-removed">-		// Allow you to paste YouTube or Google Maps embeds, for example.</div><div class="diff-added">+	}</div><div class="diff-added">+</div><div class="diff-added">+	// Allow you to paste YouTube or Google Maps embeds, for example.</div><div class="diff-added">+	for (const result of results) {</div><div> 		if (result.type === 'text' && result.subtype === 'text' && result.data.startsWith('<iframe ')) {</div><div> 			// try to find an iframe</div><div> 			const rootNode = new DOMParser().parseFromString(result.data, 'text/html')</div><div class="diff-info">@@ -536,7 +490,6 @@ 	// Finally, if we haven't bailed on anything yet, we can paste text content</div><div> 	for (const result of results) {</div><div> 		if (result.type === 'text' && result.subtype === 'text' && result.data.trim()) {</div><div class="diff-removed">-			// The clipboard may include multiple text items, but we only want to paste the first one</div><div> 			handleText(editor, result.data, point, results)</div><div> 			return</div><div> 		}</div><div class="diff-info">@@ -568,41 +521,32 @@ 		})</div><div> 	)</div><div> </div><div class="diff-removed">-	if (typeof navigator === 'undefined') {</div><div class="diff-removed">-		return</div><div class="diff-removed">-	} else {</div><div class="diff-removed">-		// Extract the text from the clipboard</div><div class="diff-removed">-		const textItems = content.shapes</div><div class="diff-removed">-			.map((shape) => {</div><div class="diff-removed">-				const util = editor.getShapeUtil(shape)</div><div class="diff-removed">-				return util.getText(shape)</div><div class="diff-removed">-			})</div><div class="diff-removed">-			.filter(isDefined)</div><div class="diff-removed">-</div><div class="diff-removed">-		if (navigator.clipboard?.write) {</div><div class="diff-removed">-			const htmlBlob = new Blob([`<div data-tldraw>${stringifiedClipboard}</div>`], {</div><div class="diff-removed">-				type: 'text/html',</div><div class="diff-removed">-			})</div><div class="diff-removed">-</div><div class="diff-removed">-			let textContent = textItems.join(' ')</div><div class="diff-removed">-</div><div class="diff-removed">-			// This is a bug in chrome android where it won't paste content if</div><div class="diff-removed">-			// the text/plain content is "" so we need to always add an empty</div><div class="diff-removed">-			// space ü§¨</div><div class="diff-removed">-			if (textContent === '') {</div><div class="diff-removed">-				textContent = ' '</div><div class="diff-removed">-			}</div><div class="diff-removed">-</div><div class="diff-removed">-			navigator.clipboard.write([</div><div class="diff-removed">-				new ClipboardItem({</div><div class="diff-removed">-					'text/html': htmlBlob,</div><div class="diff-removed">-					// What is this second blob used for?</div><div class="diff-removed">-					'text/plain': new Blob([textContent], { type: 'text/plain' }),</div><div class="diff-removed">-				}),</div><div class="diff-removed">-			])</div><div class="diff-removed">-		} else if (navigator.clipboard.writeText) {</div><div class="diff-removed">-			navigator.clipboard.writeText(`<div data-tldraw>${stringifiedClipboard}</div>`)</div><div class="diff-removed">-		}</div><div class="diff-added">+	// Extract the text from the clipboard</div><div class="diff-added">+	const textItems = content.shapes</div><div class="diff-added">+		.map((shape) => {</div><div class="diff-added">+			const util = editor.getShapeUtil(shape)</div><div class="diff-added">+			return util.getText(shape)</div><div class="diff-added">+		})</div><div class="diff-added">+		.filter(isDefined)</div><div class="diff-added">+</div><div class="diff-added">+	if (navigator.clipboard?.write) {</div><div class="diff-added">+		const htmlBlob = new Blob([`<div data-tldraw>${stringifiedClipboard}</div>`], {</div><div class="diff-added">+			type: 'text/html',</div><div class="diff-added">+		})</div><div class="diff-added">+</div><div class="diff-added">+		let textContent = textItems.join(' ')</div><div class="diff-added">+		if (textContent === '') {</div><div class="diff-added">+			textContent = ' '</div><div class="diff-added">+		}</div><div class="diff-added">+</div><div class="diff-added">+		navigator.clipboard.write([</div><div class="diff-added">+			new ClipboardItem({</div><div class="diff-added">+				'text/html': htmlBlob,</div><div class="diff-added">+				'text/plain': new Blob([textContent], { type: 'text/plain' }),</div><div class="diff-added">+			}),</div><div class="diff-added">+		])</div><div class="diff-added">+	} else if (navigator.clipboard.writeText) {</div><div class="diff-added">+		navigator.clipboard.writeText(`<div data-tldraw>${stringifiedClipboard}</div>`)</div><div> 	}</div><div> }</div><div> </div><div class="diff-info">@@ -635,22 +579,19 @@ 	)</div><div> </div><div> 	const paste = useCallback(</div><div class="diff-removed">-		async function onPaste(</div><div class="diff-added">+		function onPaste(</div><div> 			data: DataTransfer | ClipboardItem[],</div><div> 			source: TLUiEventSource,</div><div> 			point?: VecLike</div><div> 		) {</div><div> 			if (!editor) return</div><div class="diff-removed">-			// If we're editing a shape, or we are focusing an editable input, then</div><div class="diff-removed">-			// we would want the user's paste interaction to go to that element or</div><div class="diff-removed">-			// input instead; e.g. when pasting text into a text shape's content</div><div class="diff-added">+			// If we're editing a shape, we would want the user's paste to go to that shape</div><div> 			if (editor.getEditingShapeId() !== null) return</div><div> </div><div> 			if (Array.isArray(data) && data[0] instanceof ClipboardItem) {</div><div> 				handlePasteFromClipboardApi({ editor, clipboardItems: data, point })</div><div> 				trackEvent('paste', { source: 'menu' })</div><div> 			} else {</div><div class="diff-removed">-				// Read it first and then recurse, kind of weird</div><div> 				navigator.clipboard.read().then((clipboardItems) => {</div><div> 					paste(clipboardItems, source, point)</div><div> 				})</div><div class="diff-info">@@ -671,9 +612,7 @@ 	const editor = useEditor()</div><div> 	const trackEvent = useUiEvents()</div><div> </div><div class="diff-removed">-	const appIsFocused = useValue('editor.isFocused', () => editor.getInstanceState().isFocused, [</div><div class="diff-removed">-		editor,</div><div class="diff-removed">-	])</div><div class="diff-added">+	const appIsFocused = useValue('editor.isFocused', () => editor.getInstanceState().isFocused, [editor])</div><div> </div><div> 	useEffect(() => {</div><div> 		if (!appIsFocused) return</div><div class="diff-info">@@ -685,7 +624,6 @@ 			) {</div><div> 				return</div><div> 			}</div><div class="diff-removed">-</div><div> 			preventDefault(e)</div><div> 			await handleNativeOrMenuCopy(editor)</div><div> 			trackEvent('copy', { source: 'kbd' })</div><div class="diff-info">@@ -722,20 +660,17 @@ 				return</div><div> 			}</div><div> </div><div class="diff-removed">-			// If we're editing a shape, or we are focusing an editable input, then</div><div class="diff-removed">-			// we would want the user's paste interaction to go to that element or</div><div class="diff-removed">-			// input instead; e.g. when pasting text into a text shape's content</div><div> 			if (editor.getEditingShapeId() !== null || areShortcutsDisabled(editor)) return</div><div> </div><div> 			// Where should the shapes go?</div><div> 			let point: Vec | undefined = undefined</div><div> 			let pasteAtCursor = false</div><div> </div><div class="diff-removed">-			// | Shiftkey | Paste at cursor mode | Paste at point? |</div><div class="diff-removed">-			// |    N 		|         N            |       N 				 |</div><div class="diff-removed">-			// |    Y 		|         N            |       Y 				 |</div><div class="diff-removed">-			// |    N 		|         Y            |       Y 				 |</div><div class="diff-removed">-			// |    Y 		|         Y            |       N 				 |</div><div class="diff-added">+			// | ShiftKey | Paste at cursor mode | Paste at point? |</div><div class="diff-added">+			// |    N     |         N            |       N        |</div><div class="diff-added">+			// |    Y     |         N            |       Y        |</div><div class="diff-added">+			// |    N     |         Y            |       Y        |</div><div class="diff-added">+			// |    Y     |         Y            |       N        |</div><div> 			if (editor.inputs.shiftKey) pasteAtCursor = true</div><div> 			if (editor.user.getIsPasteAtCursorMode()) pasteAtCursor = !pasteAtCursor</div><div> 			if (pasteAtCursor) point = editor.inputs.currentPagePoint</div><div class="diff-info">@@ -746,13 +681,8 @@ 				}</div><div> 			}</div><div> </div><div class="diff-removed">-			// if we can read from the clipboard API, we want to try using that first. that allows</div><div class="diff-removed">-			// us to access most things, and doesn't strip out metadata added to tldraw's own</div><div class="diff-removed">-			// copy-as-png features - so copied shapes come back in at the correct size.</div><div class="diff-added">+			// Try the clipboard API first</div><div> 			if (navigator.clipboard?.read) {</div><div class="diff-removed">-				// We can't read files from the filesystem using the clipboard API though - they'll</div><div class="diff-removed">-				// just come in as the file names instead. So we'll use the clipboard event's files</div><div class="diff-removed">-				// as a fallback - if we only got text, but do have files, we use those instead.</div><div> 				const fallbackFiles = Array.from(e.clipboardData?.files || [])</div><div> 				navigator.clipboard.read().then(</div><div> 					(clipboardItems) => {</div><div class="diff-info">@@ -761,7 +691,6 @@ 						}</div><div> 					},</div><div> 					() => {</div><div class="diff-removed">-						// if reading from the clipboard fails, try to use the event clipboard data</div><div> 						pasteFromEvent()</div><div> 					}</div><div> 				)</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    