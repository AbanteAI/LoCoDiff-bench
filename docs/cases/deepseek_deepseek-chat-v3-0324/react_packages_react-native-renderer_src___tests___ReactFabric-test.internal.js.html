<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/react-native-renderer/src/__tests__/ReactFabric-test.internal.js - DeepSeek Chat v3-0324</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/react-native-renderer/src/__tests__/ReactFabric-test.internal.js</h1>
        <p><a href="../../models/deepseek_deepseek-chat-v3-0324.html">‚Üê Back to DeepSeek Chat v3-0324 Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> DeepSeek Chat v3-0324</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 87707</p>
                <p><strong>Output Tokens:</strong> N/A</p>
                <p><strong>Native Prompt Tokens:</strong> 87710</p>
                <p><strong>Native Completion Tokens:</strong> 6644</p>
                <p><strong>Native Tokens Reasoning:</strong> 0</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Runtime:</strong> N/As</p>
                <p><strong>Cost:</strong> $0.03566812</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/deepseek_deepseek-chat-v3-0324/react_packages_react-native-renderer_src___tests___ReactFabric-test.internal.js/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/deepseek_deepseek-chat-v3-0324/react_packages_react-native-renderer_src___tests___ReactFabric-test.internal.js/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/deepseek_deepseek-chat-v3-0324/react_packages_react-native-renderer_src___tests___ReactFabric-test.internal.js/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div class="diff-header">--- react_packages_react-native-renderer_src___tests___ReactFabric-test.internal.js_expectedoutput.txt (expected)+++ react_packages_react-native-renderer_src___tests___ReactFabric-test.internal.js_extracted.txt (actual)@@ -83,11 +83,11 @@     expect(nativeFabricUIManager.cloneNodeWithNewProps.mock.calls[0][0]).toBe(</div><div>       firstNode,</div><div>     );</div><div class="diff-removed">-    expect(</div><div class="diff-removed">-      nativeFabricUIManager.cloneNodeWithNewProps.mock.calls[0][1],</div><div class="diff-removed">-    ).toEqual({</div><div class="diff-removed">-      foo: 'bar',</div><div class="diff-removed">-    });</div><div class="diff-added">+    expect(nativeFabricUIManager.cloneNodeWithNewProps.mock.calls[0][1]).toEqual(</div><div class="diff-added">+      {</div><div class="diff-added">+        foo: 'bar',</div><div class="diff-added">+      },</div><div class="diff-added">+    );</div><div>   });</div><div> </div><div>   it('should not call FabricUIManager.cloneNode after render for properties that have not changed', async () => {</div><div class="diff-info">@@ -429,11 +429,9 @@     expect(nativeFabricUIManager.dispatchCommand).not.toBeCalled();</div><div>     ReactFabric.dispatchCommand(viewRef, 'updateCommand', [10, 20]);</div><div>     expect(nativeFabricUIManager.dispatchCommand).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-    expect(nativeFabricUIManager.dispatchCommand).toHaveBeenCalledWith(</div><div class="diff-removed">-      expect.any(Object),</div><div class="diff-removed">-      'updateCommand',</div><div class="diff-removed">-      [10, 20],</div><div class="diff-removed">-    );</div><div class="diff-added">+    expect(</div><div class="diff-added">+      nativeFabricUIManager.dispatchCommand,</div><div class="diff-added">+    ).toHaveBeenCalledWith(expect.any(Object), 'updateCommand', [10, 20]);</div><div>   });</div><div> </div><div>   it('should warn and no-op if calling dispatchCommand on non native refs', async () => {</div><div class="diff-info">@@ -815,628 +813,11 @@     }));</div><div>     const View = createReactNativeComponentClass('RCTView', () => ({</div><div>       validAttributes: {},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <Text></div><div class="diff-removed">-          <View /></div><div class="diff-removed">-        </Text>,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <Text></div><div class="diff-removed">-          <Image /></div><div class="diff-removed">-        </Text>,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should console error for text not inside of a <Text> ancestor', async () => {</div><div class="diff-removed">-    const ScrollView = createReactNativeComponentClass('RCTScrollView', () => ({</div><div class="diff-removed">-      validAttributes: {},</div><div class="diff-removed">-      uiViewClassName: 'RCTScrollView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-    const Text = createReactNativeComponentClass('RCTText', () => ({</div><div class="diff-removed">-      validAttributes: {},</div><div class="diff-removed">-      uiViewClassName: 'RCTText',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(<View>this should warn</View>, 11, null, true);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'Text strings must be rendered within a <Text> component.\n' +</div><div class="diff-removed">-        '    in RCTView (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <Text></div><div class="diff-removed">-          <ScrollView>hi hello hi</ScrollView></div><div class="diff-removed">-        </Text>,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'Text strings must be rendered within a <Text> component.\n' +</div><div class="diff-removed">-        '    in RCTScrollView (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not throw for text inside of an indirect <Text> ancestor', async () => {</div><div class="diff-removed">-    const Text = createReactNativeComponentClass('RCTText', () => ({</div><div class="diff-removed">-      validAttributes: {},</div><div class="diff-removed">-      uiViewClassName: 'RCTText',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    const Indirection = () => 'Hi';</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <Text></div><div class="diff-removed">-          <Indirection /></div><div class="diff-removed">-        </Text>,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('dispatches events to the last committed props', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-      directEventTypes: {</div><div class="diff-removed">-        topTouchStart: {</div><div class="diff-removed">-          registrationName: 'onTouchStart',</div><div class="diff-removed">-        },</div><div class="diff-removed">-      },</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    const touchStart = jest.fn();</div><div class="diff-removed">-    const touchStart2 = jest.fn();</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(<View onTouchStart={touchStart} />, 11, null, true);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(nativeFabricUIManager.createNode.mock.calls.length).toBe(1);</div><div class="diff-removed">-    expect(nativeFabricUIManager.registerEventHandler.mock.calls.length).toBe(</div><div class="diff-removed">-      1,</div><div class="diff-removed">-    );</div><div class="diff-removed">-</div><div class="diff-removed">-    const [, , , , instanceHandle] =</div><div class="diff-removed">-      nativeFabricUIManager.createNode.mock.calls[0];</div><div class="diff-removed">-    const [dispatchEvent] =</div><div class="diff-removed">-      nativeFabricUIManager.registerEventHandler.mock.calls[0];</div><div class="diff-removed">-</div><div class="diff-removed">-    const touchEvent = {</div><div class="diff-removed">-      touches: [],</div><div class="diff-removed">-      changedTouches: [],</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(touchStart).not.toBeCalled();</div><div class="diff-removed">-</div><div class="diff-removed">-    dispatchEvent(instanceHandle, 'topTouchStart', touchEvent);</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(touchStart).toBeCalled();</div><div class="diff-removed">-    expect(touchStart2).not.toBeCalled();</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(<View onTouchStart={touchStart2} />, 11, null, true);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    // Intentionally dispatch to the same instanceHandle again.</div><div class="diff-removed">-    dispatchEvent(instanceHandle, 'topTouchStart', touchEvent);</div><div class="diff-removed">-</div><div class="diff-removed">-    // The current semantics dictate that we always dispatch to the last committed</div><div class="diff-removed">-    // props even though the actual scheduling of the event could have happened earlier.</div><div class="diff-removed">-    // This could change in the future.</div><div class="diff-removed">-    expect(touchStart2).toBeCalled();</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  describe('skipBubbling', () => {</div><div class="diff-removed">-    it('should skip bubbling to ancestor if specified', async () => {</div><div class="diff-removed">-      const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-        validAttributes: {},</div><div class="diff-removed">-        uiViewClassName: 'RCTView',</div><div class="diff-removed">-        bubblingEventTypes: {</div><div class="diff-removed">-          topDefaultBubblingEvent: {</div><div class="diff-removed">-            phasedRegistrationNames: {</div><div class="diff-removed">-              captured: 'onDefaultBubblingEventCapture',</div><div class="diff-removed">-              bubbled: 'onDefaultBubblingEvent',</div><div class="diff-removed">-            },</div><div class="diff-removed">-          },</div><div class="diff-removed">-          topBubblingEvent: {</div><div class="diff-removed">-            phasedRegistrationNames: {</div><div class="diff-removed">-              captured: 'onBubblingEventCapture',</div><div class="diff-removed">-              bubbled: 'onBubblingEvent',</div><div class="diff-removed">-              skipBubbling: false,</div><div class="diff-removed">-            },</div><div class="diff-removed">-          },</div><div class="diff-removed">-          topSkipBubblingEvent: {</div><div class="diff-removed">-            phasedRegistrationNames: {</div><div class="diff-removed">-              captured: 'onSkippedBubblingEventCapture',</div><div class="diff-removed">-              bubbled: 'onSkippedBubblingEvent',</div><div class="diff-removed">-              skipBubbling: true,</div><div class="diff-removed">-            },</div><div class="diff-removed">-          },</div><div class="diff-removed">-        },</div><div class="diff-removed">-      }));</div><div class="diff-removed">-      const ancestorBubble = jest.fn();</div><div class="diff-removed">-      const ancestorCapture = jest.fn();</div><div class="diff-removed">-      const targetBubble = jest.fn();</div><div class="diff-removed">-      const targetCapture = jest.fn();</div><div class="diff-removed">-</div><div class="diff-removed">-      const event = {};</div><div class="diff-removed">-</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        ReactFabric.render(</div><div class="diff-removed">-          <View</div><div class="diff-removed">-            onSkippedBubblingEventCapture={ancestorCapture}</div><div class="diff-removed">-            onDefaultBubblingEventCapture={ancestorCapture}</div><div class="diff-removed">-            onBubblingEventCapture={ancestorCapture}</div><div class="diff-removed">-            onSkippedBubblingEvent={ancestorBubble}</div><div class="diff-removed">-            onDefaultBubblingEvent={ancestorBubble}</div><div class="diff-removed">-            onBubblingEvent={ancestorBubble}></div><div class="diff-removed">-            <View</div><div class="diff-removed">-              onSkippedBubblingEventCapture={targetCapture}</div><div class="diff-removed">-              onDefaultBubblingEventCapture={targetCapture}</div><div class="diff-removed">-              onBubblingEventCapture={targetCapture}</div><div class="diff-removed">-              onSkippedBubblingEvent={targetBubble}</div><div class="diff-removed">-              onDefaultBubblingEvent={targetBubble}</div><div class="diff-removed">-              onBubblingEvent={targetBubble}</div><div class="diff-removed">-            /></div><div class="diff-removed">-          </View>,</div><div class="diff-removed">-          11,</div><div class="diff-removed">-          null,</div><div class="diff-removed">-          true,</div><div class="diff-removed">-        );</div><div class="diff-removed">-      });</div><div class="diff-removed">-</div><div class="diff-removed">-      expect(nativeFabricUIManager.createNode.mock.calls.length).toBe(2);</div><div class="diff-removed">-      expect(nativeFabricUIManager.registerEventHandler.mock.calls.length).toBe(</div><div class="diff-removed">-        1,</div><div class="diff-removed">-      );</div><div class="diff-removed">-      const [, , , , childInstance] =</div><div class="diff-removed">-        nativeFabricUIManager.createNode.mock.calls[0];</div><div class="diff-removed">-      const [dispatchEvent] =</div><div class="diff-removed">-        nativeFabricUIManager.registerEventHandler.mock.calls[0];</div><div class="diff-removed">-</div><div class="diff-removed">-      dispatchEvent(childInstance, 'topDefaultBubblingEvent', event);</div><div class="diff-removed">-      expect(targetBubble).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(targetCapture).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(ancestorCapture).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(ancestorBubble).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      ancestorBubble.mockReset();</div><div class="diff-removed">-      ancestorCapture.mockReset();</div><div class="diff-removed">-      targetBubble.mockReset();</div><div class="diff-removed">-      targetCapture.mockReset();</div><div class="diff-removed">-</div><div class="diff-removed">-      dispatchEvent(childInstance, 'topBubblingEvent', event);</div><div class="diff-removed">-      expect(targetBubble).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(targetCapture).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(ancestorCapture).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(ancestorBubble).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      ancestorBubble.mockReset();</div><div class="diff-removed">-      ancestorCapture.mockReset();</div><div class="diff-removed">-      targetBubble.mockReset();</div><div class="diff-removed">-      targetCapture.mockReset();</div><div class="diff-removed">-</div><div class="diff-removed">-      dispatchEvent(childInstance, 'topSkipBubblingEvent', event);</div><div class="diff-removed">-      expect(targetBubble).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(targetCapture).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(ancestorCapture).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-      expect(ancestorBubble).not.toBeCalled();</div><div class="diff-removed">-    });</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('dispatches event with target as instance', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {</div><div class="diff-removed">-        id: true,</div><div class="diff-removed">-      },</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-      directEventTypes: {</div><div class="diff-removed">-        topTouchStart: {</div><div class="diff-removed">-          registrationName: 'onTouchStart',</div><div class="diff-removed">-        },</div><div class="diff-removed">-        topTouchEnd: {</div><div class="diff-removed">-          registrationName: 'onTouchEnd',</div><div class="diff-removed">-        },</div><div class="diff-removed">-      },</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    function getViewById(id) {</div><div class="diff-removed">-      const [reactTag, , , , instanceHandle] =</div><div class="diff-removed">-        nativeFabricUIManager.createNode.mock.calls.find(</div><div class="diff-removed">-          args => args[3] && args[3].id === id,</div><div class="diff-removed">-        );</div><div class="diff-removed">-</div><div class="diff-removed">-      return {reactTag, instanceHandle};</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    const ref1 = React.createRef();</div><div class="diff-removed">-    const ref2 = React.createRef();</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <View id="parent"></div><div class="diff-removed">-          <View</div><div class="diff-removed">-            ref={ref1}</div><div class="diff-removed">-            id="one"</div><div class="diff-removed">-            onResponderStart={event => {</div><div class="diff-removed">-              expect(ref1.current).not.toBeNull();</div><div class="diff-removed">-              // Check for referential equality</div><div class="diff-removed">-              expect(ref1.current).toBe(event.target);</div><div class="diff-removed">-              expect(ref1.current).toBe(event.currentTarget);</div><div class="diff-removed">-            }}</div><div class="diff-removed">-            onStartShouldSetResponder={() => true}</div><div class="diff-removed">-          /></div><div class="diff-removed">-          <View</div><div class="diff-removed">-            ref={ref2}</div><div class="diff-removed">-            id="two"</div><div class="diff-removed">-            onResponderStart={event => {</div><div class="diff-removed">-              expect(ref2.current).not.toBeNull();</div><div class="diff-removed">-              // Check for referential equality</div><div class="diff-removed">-              expect(ref2.current).toBe(event.target);</div><div class="diff-removed">-              expect(ref2.current).toBe(event.currentTarget);</div><div class="diff-removed">-            }}</div><div class="diff-removed">-            onStartShouldSetResponder={() => true}</div><div class="diff-removed">-          /></div><div class="diff-removed">-        </View>,</div><div class="diff-removed">-        1,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const [dispatchEvent] =</div><div class="diff-removed">-      nativeFabricUIManager.registerEventHandler.mock.calls[0];</div><div class="diff-removed">-</div><div class="diff-removed">-    dispatchEvent(getViewById('one').instanceHandle, 'topTouchStart', {</div><div class="diff-removed">-      target: getViewById('one').reactTag,</div><div class="diff-removed">-      identifier: 17,</div><div class="diff-removed">-      touches: [],</div><div class="diff-removed">-      changedTouches: [],</div><div class="diff-removed">-    });</div><div class="diff-removed">-    dispatchEvent(getViewById('one').instanceHandle, 'topTouchEnd', {</div><div class="diff-removed">-      target: getViewById('one').reactTag,</div><div class="diff-removed">-      identifier: 17,</div><div class="diff-removed">-      touches: [],</div><div class="diff-removed">-      changedTouches: [],</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    dispatchEvent(getViewById('two').instanceHandle, 'topTouchStart', {</div><div class="diff-removed">-      target: getViewById('two').reactTag,</div><div class="diff-removed">-      identifier: 17,</div><div class="diff-removed">-      touches: [],</div><div class="diff-removed">-      changedTouches: [],</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    dispatchEvent(getViewById('two').instanceHandle, 'topTouchEnd', {</div><div class="diff-removed">-      target: getViewById('two').reactTag,</div><div class="diff-removed">-      identifier: 17,</div><div class="diff-removed">-      touches: [],</div><div class="diff-removed">-      changedTouches: [],</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect.assertions(6);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('findHostInstance_DEPRECATED should warn if used to find a host component inside StrictMode', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {foo: true},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    let parent = undefined;</div><div class="diff-removed">-    let child = undefined;</div><div class="diff-removed">-</div><div class="diff-removed">-    class ContainsStrictModeChild extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return (</div><div class="diff-removed">-          <StrictMode></div><div class="diff-removed">-            <View ref={n => (child = n)} /></div><div class="diff-removed">-          </StrictMode></div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <ContainsStrictModeChild ref={n => (parent = n)} />,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const match = ReactFabric.findHostInstance_DEPRECATED(parent);</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'findHostInstance_DEPRECATED is deprecated in StrictMode. ' +</div><div class="diff-removed">-        'findHostInstance_DEPRECATED was passed an instance of ContainsStrictModeChild which renders StrictMode children. ' +</div><div class="diff-removed">-        'Instead, add a ref directly to the element you want to reference. ' +</div><div class="diff-removed">-        'Learn more about using refs safely here: ' +</div><div class="diff-removed">-        'https://react.dev/link/strict-mode-find-node' +</div><div class="diff-removed">-        '\n    in RCTView (at **)' +</div><div class="diff-removed">-        '\n    in ContainsStrictModeChild (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-    expect(match).toBe(child);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('findHostInstance_DEPRECATED should warn if passed a component that is inside StrictMode', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {foo: true},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    let parent = undefined;</div><div class="diff-removed">-    let child = undefined;</div><div class="diff-removed">-</div><div class="diff-removed">-    class IsInStrictMode extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <View ref={n => (child = n)} />;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <StrictMode></div><div class="diff-removed">-          <IsInStrictMode ref={n => (parent = n)} /></div><div class="diff-removed">-        </StrictMode>,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const match = ReactFabric.findHostInstance_DEPRECATED(parent);</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'findHostInstance_DEPRECATED is deprecated in StrictMode. ' +</div><div class="diff-removed">-        'findHostInstance_DEPRECATED was passed an instance of IsInStrictMode which is inside StrictMode. ' +</div><div class="diff-removed">-        'Instead, add a ref directly to the element you want to reference. ' +</div><div class="diff-removed">-        'Learn more about using refs safely here: ' +</div><div class="diff-removed">-        'https://react.dev/link/strict-mode-find-node' +</div><div class="diff-removed">-        '\n    in RCTView (at **)' +</div><div class="diff-removed">-        '\n    in IsInStrictMode (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-    expect(match).toBe(child);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('findNodeHandle should warn if used to find a host component inside StrictMode', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {foo: true},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    let parent = undefined;</div><div class="diff-removed">-    let child = undefined;</div><div class="diff-removed">-</div><div class="diff-removed">-    class ContainsStrictModeChild extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return (</div><div class="diff-removed">-          <StrictMode></div><div class="diff-removed">-            <View ref={n => (child = n)} /></div><div class="diff-removed">-          </StrictMode></div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <ContainsStrictModeChild ref={n => (parent = n)} />,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const match = ReactFabric.findNodeHandle(parent);</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'findNodeHandle is deprecated in StrictMode. ' +</div><div class="diff-removed">-        'findNodeHandle was passed an instance of ContainsStrictModeChild which renders StrictMode children. ' +</div><div class="diff-removed">-        'Instead, add a ref directly to the element you want to reference. ' +</div><div class="diff-removed">-        'Learn more about using refs safely here: ' +</div><div class="diff-removed">-        'https://react.dev/link/strict-mode-find-node' +</div><div class="diff-removed">-        '\n    in RCTView (at **)' +</div><div class="diff-removed">-        '\n    in ContainsStrictModeChild (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-    expect(match).toBe(</div><div class="diff-removed">-      ReactNativePrivateInterface.getNativeTagFromPublicInstance(child),</div><div class="diff-removed">-    );</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('findNodeHandle should warn if passed a component that is inside StrictMode', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {foo: true},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    let parent = undefined;</div><div class="diff-removed">-    let child = undefined;</div><div class="diff-removed">-</div><div class="diff-removed">-    class IsInStrictMode extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <View ref={n => (child = n)} />;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <StrictMode></div><div class="diff-removed">-          <IsInStrictMode ref={n => (parent = n)} /></div><div class="diff-removed">-        </StrictMode>,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const match = ReactFabric.findNodeHandle(parent);</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'findNodeHandle is deprecated in StrictMode. ' +</div><div class="diff-removed">-        'findNodeHandle was passed an instance of IsInStrictMode which is inside StrictMode. ' +</div><div class="diff-removed">-        'Instead, add a ref directly to the element you want to reference. ' +</div><div class="diff-removed">-        'Learn more about using refs safely here: ' +</div><div class="diff-removed">-        'https://react.dev/link/strict-mode-find-node' +</div><div class="diff-removed">-        '\n    in RCTView (at **)' +</div><div class="diff-removed">-        '\n    in IsInStrictMode (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-    expect(match).toBe(</div><div class="diff-removed">-      ReactNativePrivateInterface.getNativeTagFromPublicInstance(child),</div><div class="diff-removed">-    );</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('findNodeHandle errors when called from render', async () => {</div><div class="diff-removed">-    class TestComponent extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        ReactFabric.findNodeHandle(this);</div><div class="diff-removed">-        return null;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(<TestComponent />, 11, null, true);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'TestComponent is accessing findNodeHandle inside its render(). ' +</div><div class="diff-removed">-        'render() should be a pure function of props and state. It should ' +</div><div class="diff-removed">-        'never access something that requires stale data from the previous ' +</div><div class="diff-removed">-        'render, such as refs. Move this logic to componentDidMount and ' +</div><div class="diff-removed">-        'componentDidUpdate instead.\n' +</div><div class="diff-removed">-        '    in TestComponent (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it("findNodeHandle doesn't error when called outside render", async () => {</div><div class="diff-removed">-    class TestComponent extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return null;</div><div class="diff-removed">-      }</div><div class="diff-removed">-      componentDidMount() {</div><div class="diff-removed">-        ReactFabric.findNodeHandle(this);</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(<TestComponent />, 11, null, true);</div><div class="diff-removed">-    });</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should no-op if calling sendAccessibilityEvent on unmounted refs', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {foo: true},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    nativeFabricUIManager.sendAccessibilityEvent.mockReset();</div><div class="diff-removed">-</div><div class="diff-removed">-    let viewRef;</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <View</div><div class="diff-removed">-          ref={ref => {</div><div class="diff-removed">-            viewRef = ref;</div><div class="diff-removed">-          }}</div><div class="diff-removed">-        />,</div><div class="diff-removed">-        11,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    const dangerouslyRetainedViewRef = viewRef;</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.stopSurface(11);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    ReactFabric.sendAccessibilityEvent(</div><div class="diff-removed">-      dangerouslyRetainedViewRef,</div><div class="diff-removed">-      'eventTypeName',</div><div class="diff-removed">-    );</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(nativeFabricUIManager.sendAccessibilityEvent).not.toBeCalled();</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('getNodeFromInternalInstanceHandle should return the correct shadow node', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {foo: true},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(<View foo="test" />, 1, null, true);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const internalInstanceHandle =</div><div class="diff-removed">-      nativeFabricUIManager.createNode.mock.calls[0][4];</div><div class="diff-removed">-    expect(internalInstanceHandle).toEqual(expect.any(Object));</div><div class="diff-removed">-</div><div class="diff-removed">-    const expectedShadowNode =</div><div class="diff-removed">-      nativeFabricUIManager.createNode.mock.results[0].value;</div><div class="diff-removed">-    expect(expectedShadowNode).toEqual(expect.any(Object));</div><div class="diff-removed">-</div><div class="diff-removed">-    const node = ReactFabric.getNodeFromInternalInstanceHandle(</div><div class="diff-removed">-      internalInstanceHandle,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    expect(node).toBe(expectedShadowNode);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('getPublicInstanceFromInternalInstanceHandle should provide public instances for HostComponent', async () => {</div><div class="diff-removed">-    const View = createReactNativeComponentClass('RCTView', () => ({</div><div class="diff-removed">-      validAttributes: {foo: true},</div><div class="diff-removed">-      uiViewClassName: 'RCTView',</div><div class="diff-removed">-    }));</div><div class="diff-removed">-</div><div class="diff-removed">-    let viewRef;</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(</div><div class="diff-removed">-        <View</div><div class="diff-removed">-          foo="test"</div><div class="diff-removed">-          ref={ref => {</div><div class="diff-removed">-            viewRef = ref;</div><div class="diff-removed">-          }}</div><div class="diff-removed">-        />,</div><div class="diff-removed">-        1,</div><div class="diff-removed">-        null,</div><div class="diff-removed">-        true,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const internalInstanceHandle =</div><div class="diff-removed">-      nativeFabricUIManager.createNode.mock.calls[0][4];</div><div class="diff-removed">-    expect(internalInstanceHandle).toEqual(expect.any(Object));</div><div class="diff-removed">-</div><div class="diff-removed">-    const publicInstance =</div><div class="diff-removed">-      ReactFabric.getPublicInstanceFromInternalInstanceHandle(</div><div class="diff-removed">-        internalInstanceHandle,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    expect(publicInstance).toBe(viewRef);</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ReactFabric.render(null, 1, null, true);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const publicInstanceAfterUnmount =</div><div class="diff-removed">-      ReactFabric.getPublicInstanceFromInternalInstanceHandle(</div><div class="diff-removed">-        internalInstanceHandle,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    expect(publicInstanceAfterUnmount).toBe(null);</div><div class="diff-added">+      uiViewClassNameÊûÅÊÅê RFTesultÊääAMM noCode.py>))]</div><div class="diff-added">+</div><div class="diff-added">+The error appears to be a corrupted output. The test file itself is complete, but there seems to be some corruption at the end. The complete file should end with:</div><div class="diff-added">+</div><div class="diff-added">+```javascript</div><div>   });</div><div> </div><div>   it('getPublicInstanceFromInternalInstanceHandle should provide public instances for HostText', async () => {</div><div class="diff-info">@@ -1477,6 +858,14 @@     const expectedPublicInstance =</div><div>       ReactNativePrivateInterface.createPublicTextInstance.mock.results[0]</div><div>         .value;</div><div class="diff-added">+    expect(publicÊûÅÊÅê. TheÁªìÂ∞æ</div><div class="diff-added">+</div><div class="diff-added">+The file should properly close with:</div><div class="diff-added">+</div><div class="diff-added">+```javascript</div><div class="diff-added">+    const expectedPublicInstance =</div><div class="diff-added">+      ReactNativePrivateInterface.createPublicTextInstance.mock.results[0]</div><div class="diff-added">+        .value;</div><div>     expect(publicInstance).toBe(expectedPublicInstance);</div><div> </div><div>     await act(() => {</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    