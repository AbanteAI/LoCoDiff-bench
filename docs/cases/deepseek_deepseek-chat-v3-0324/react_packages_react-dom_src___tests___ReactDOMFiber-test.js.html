<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/react-dom/src/__tests__/ReactDOMFiber-test.js - DeepSeek Chat v3-0324</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/react-dom/src/__tests__/ReactDOMFiber-test.js</h1>
        <p><a href="../../models/deepseek_deepseek-chat-v3-0324.html">‚Üê Back to DeepSeek Chat v3-0324 Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> DeepSeek Chat v3-0324</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 57044</p>
                <p><strong>Output Tokens:</strong> N/A</p>
                <p><strong>Native Prompt Tokens:</strong> 60786</p>
                <p><strong>Native Completion Tokens:</strong> 2</p>
                <p><strong>Native Tokens Reasoning:</strong> 0</p>
                <p><strong>Native Finish Reason:</strong> None</p>
                <p><strong>Runtime:</strong> N/As</p>
                <p><strong>Cost:</strong> $0.0273566</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/deepseek_deepseek-chat-v3-0324/react_packages_react-dom_src___tests___ReactDOMFiber-test.js/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/deepseek_deepseek-chat-v3-0324/react_packages_react-dom_src___tests___ReactDOMFiber-test.js/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/deepseek_deepseek-chat-v3-0324/react_packages_react-dom_src___tests___ReactDOMFiber-test.js/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div class="diff-header">--- react_packages_react-dom_src___tests___ReactDOMFiber-test.js_expectedoutput.txt (expected)+++ react_packages_react-dom_src___tests___ReactDOMFiber-test.js_extracted.txt (actual)@@ -1,1332 +0,0 @@-/**</div><div class="diff-removed">- * Copyright (c) Meta Platforms, Inc. and affiliates.</div><div class="diff-removed">- *</div><div class="diff-removed">- * This source code is licensed under the MIT license found in the</div><div class="diff-removed">- * LICENSE file in the root directory of this source tree.</div><div class="diff-removed">- *</div><div class="diff-removed">- * @emails react-core</div><div class="diff-removed">- */</div><div class="diff-removed">-</div><div class="diff-removed">-'use strict';</div><div class="diff-removed">-</div><div class="diff-removed">-let React;</div><div class="diff-removed">-let ReactDOM;</div><div class="diff-removed">-let PropTypes;</div><div class="diff-removed">-let ReactDOMClient;</div><div class="diff-removed">-let Scheduler;</div><div class="diff-removed">-</div><div class="diff-removed">-let act;</div><div class="diff-removed">-let assertConsoleErrorDev;</div><div class="diff-removed">-let assertLog;</div><div class="diff-removed">-let root;</div><div class="diff-removed">-let JSDOM;</div><div class="diff-removed">-</div><div class="diff-removed">-describe('ReactDOMFiber', () => {</div><div class="diff-removed">-  let container;</div><div class="diff-removed">-</div><div class="diff-removed">-  beforeEach(() => {</div><div class="diff-removed">-    jest.resetModules();</div><div class="diff-removed">-</div><div class="diff-removed">-    // JSDOM needs to be setup with a TextEncoder and TextDecoder when used standalone</div><div class="diff-removed">-    // https://github.com/jsdom/jsdom/issues/2524</div><div class="diff-removed">-    (() => {</div><div class="diff-removed">-      const {TextEncoder, TextDecoder} = require('util');</div><div class="diff-removed">-      global.TextEncoder = TextEncoder;</div><div class="diff-removed">-      global.TextDecoder = TextDecoder;</div><div class="diff-removed">-      JSDOM = require('jsdom').JSDOM;</div><div class="diff-removed">-    })();</div><div class="diff-removed">-</div><div class="diff-removed">-    React = require('react');</div><div class="diff-removed">-    ReactDOM = require('react-dom');</div><div class="diff-removed">-    PropTypes = require('prop-types');</div><div class="diff-removed">-    ReactDOMClient = require('react-dom/client');</div><div class="diff-removed">-    Scheduler = require('scheduler');</div><div class="diff-removed">-    act = require('internal-test-utils').act;</div><div class="diff-removed">-    ({assertConsoleErrorDev, assertLog} = require('internal-test-utils'));</div><div class="diff-removed">-</div><div class="diff-removed">-    container = document.createElement('div');</div><div class="diff-removed">-    document.body.appendChild(container);</div><div class="diff-removed">-    root = ReactDOMClient.createRoot(container);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  afterEach(() => {</div><div class="diff-removed">-    document.body.removeChild(container);</div><div class="diff-removed">-    container = null;</div><div class="diff-removed">-    jest.restoreAllMocks();</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render strings as children', async () => {</div><div class="diff-removed">-    const Box = ({value}) => <div>{value}</div>;</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Box value="foo" />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.textContent).toEqual('foo');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render numbers as children', async () => {</div><div class="diff-removed">-    const Box = ({value}) => <div>{value}</div>;</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Box value={10} />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(container.textContent).toEqual('10');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render bigints as children', async () => {</div><div class="diff-removed">-    const Box = ({value}) => <div>{value}</div>;</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Box value={10n} />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(container.textContent).toEqual('10');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should call an effect after mount/update (replacing render callback pattern)', async () => {</div><div class="diff-removed">-    function Component() {</div><div class="diff-removed">-      React.useEffect(() => {</div><div class="diff-removed">-        Scheduler.log('Callback');</div><div class="diff-removed">-      });</div><div class="diff-removed">-      return <div>Foo</div>;</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    // mounting phase</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Component />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['Callback']);</div><div class="diff-removed">-</div><div class="diff-removed">-    // updating phase</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Component />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['Callback']);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should call an effect when the same element is re-rendered (replacing render callback pattern)', async () => {</div><div class="diff-removed">-    function Component({prop}) {</div><div class="diff-removed">-      React.useEffect(() => {</div><div class="diff-removed">-        Scheduler.log('Callback');</div><div class="diff-removed">-      });</div><div class="diff-removed">-      return <div>{prop}</div>;</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    // mounting phase</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Component prop="Foo" />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['Callback']);</div><div class="diff-removed">-</div><div class="diff-removed">-    // updating phase</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Component prop="Bar" />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['Callback']);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render a component returning strings directly from render', async () => {</div><div class="diff-removed">-    const Text = ({value}) => value;</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Text value="foo" />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(container.textContent).toEqual('foo');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render a component returning numbers directly from render', async () => {</div><div class="diff-removed">-    const Text = ({value}) => value;</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Text value={10} />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(container.textContent).toEqual('10');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('renders an empty fragment', async () => {</div><div class="diff-removed">-    const Div = () => <div />;</div><div class="diff-removed">-    const EmptyFragment = () => <></>;</div><div class="diff-removed">-    const NonEmptyFragment = () => (</div><div class="diff-removed">-      <></div><div class="diff-removed">-        <Div /></div><div class="diff-removed">-      </></div><div class="diff-removed">-    );</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<EmptyFragment />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.firstChild).toBe(null);</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<NonEmptyFragment />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.firstChild.tagName).toBe('DIV');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<EmptyFragment />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.firstChild).toBe(null);</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Div />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.firstChild.tagName).toBe('DIV');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<EmptyFragment />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.firstChild).toBe(null);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  let svgEls, htmlEls, mathEls;</div><div class="diff-removed">-  const expectSVG = {ref: el => svgEls.push(el)};</div><div class="diff-removed">-  const expectHTML = {ref: el => htmlEls.push(el)};</div><div class="diff-removed">-  const expectMath = {ref: el => mathEls.push(el)};</div><div class="diff-removed">-</div><div class="diff-removed">-  const usePortal = function (tree) {</div><div class="diff-removed">-    return ReactDOM.createPortal(tree, document.createElement('div'));</div><div class="diff-removed">-  };</div><div class="diff-removed">-</div><div class="diff-removed">-  const assertNamespacesMatch = async function (tree) {</div><div class="diff-removed">-    const testContainer = document.createElement('div');</div><div class="diff-removed">-    svgEls = [];</div><div class="diff-removed">-    htmlEls = [];</div><div class="diff-removed">-    mathEls = [];</div><div class="diff-removed">-</div><div class="diff-removed">-    const testRoot = ReactDOMClient.createRoot(testContainer);</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      testRoot.render(tree);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    svgEls.forEach(el => {</div><div class="diff-removed">-      expect(el.namespaceURI).toBe('http://www.w3.org/2000/svg');</div><div class="diff-removed">-    });</div><div class="diff-removed">-    htmlEls.forEach(el => {</div><div class="diff-removed">-      expect(el.namespaceURI).toBe('http://www.w3.org/1999/xhtml');</div><div class="diff-removed">-    });</div><div class="diff-removed">-    mathEls.forEach(el => {</div><div class="diff-removed">-      expect(el.namespaceURI).toBe('http://www.w3.org/1998/Math/MathML');</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    testRoot.unmount();</div><div class="diff-removed">-    expect(testContainer.innerHTML).toBe('');</div><div class="diff-removed">-  };</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render one portal', async () => {</div><div class="diff-removed">-    const portalContainer = document.createElement('div');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div>{ReactDOM.createPortal(<div>portal</div>, portalContainer)}</div>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('<div>portal</div>');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div></div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    root.unmount();</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render many portals', async () => {</div><div class="diff-removed">-    const portalContainer1 = document.createElement('div');</div><div class="diff-removed">-    const portalContainer2 = document.createElement('div');</div><div class="diff-removed">-</div><div class="diff-removed">-    class Child extends React.Component {</div><div class="diff-removed">-      componentDidMount() {</div><div class="diff-removed">-        Scheduler.log(`${this.props.name} componentDidMount`);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      componentDidUpdate() {</div><div class="diff-removed">-        Scheduler.log(`${this.props.name} componentDidUpdate`);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      componentWillUnmount() {</div><div class="diff-removed">-        Scheduler.log(`${this.props.name} componentWillUnmount`);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div>{this.props.name}</div>;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class Parent extends React.Component {</div><div class="diff-removed">-      componentDidMount() {</div><div class="diff-removed">-        Scheduler.log(`Parent:${this.props.step} componentDidMount`);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      componentDidUpdate() {</div><div class="diff-removed">-        Scheduler.log(`Parent:${this.props.step} componentDidUpdate`);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      componentWillUnmount() {</div><div class="diff-removed">-        Scheduler.log(`Parent:${this.props.step} componentWillUnmount`);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        const {step} = this.props;</div><div class="diff-removed">-        return [</div><div class="diff-removed">-          <Child key="a" name={`normal[0]:${step}`} />,</div><div class="diff-removed">-          ReactDOM.createPortal(</div><div class="diff-removed">-            <Child key="b" name={`portal1[0]:${step}`} />,</div><div class="diff-removed">-            portalContainer1,</div><div class="diff-removed">-          ),</div><div class="diff-removed">-          <Child key="c" name={`normal[1]:${step}`} />,</div><div class="diff-removed">-          ReactDOM.createPortal(</div><div class="diff-removed">-            [</div><div class="diff-removed">-              <Child key="d" name={`portal2[0]:${step}`} />,</div><div class="diff-removed">-              <Child key="e" name={`portal2[1]:${step}`} />,</div><div class="diff-removed">-            ],</div><div class="diff-removed">-            portalContainer2,</div><div class="diff-removed">-          ),</div><div class="diff-removed">-        ];</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Parent step="a" />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer1.innerHTML).toBe('<div>portal1[0]:a</div>');</div><div class="diff-removed">-    expect(portalContainer2.innerHTML).toBe(</div><div class="diff-removed">-      '<div>portal2[0]:a</div><div>portal2[1]:a</div>',</div><div class="diff-removed">-    );</div><div class="diff-removed">-    expect(container.innerHTML).toBe(</div><div class="diff-removed">-      '<div>normal[0]:a</div><div>normal[1]:a</div>',</div><div class="diff-removed">-    );</div><div class="diff-removed">-    assertLog([</div><div class="diff-removed">-      'normal[0]:a componentDidMount',</div><div class="diff-removed">-      'portal1[0]:a componentDidMount',</div><div class="diff-removed">-      'normal[1]:a componentDidMount',</div><div class="diff-removed">-      'portal2[0]:a componentDidMount',</div><div class="diff-removed">-      'portal2[1]:a componentDidMount',</div><div class="diff-removed">-      'Parent:a componentDidMount',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Parent step="b" />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer1.innerHTML).toBe('<div>portal1[0]:b</div>');</div><div class="diff-removed">-    expect(portalContainer2.innerHTML).toBe(</div><div class="diff-removed">-      '<div>portal2[0]:b</div><div>portal2[1]:b</div>',</div><div class="diff-removed">-    );</div><div class="diff-removed">-    expect(container.innerHTML).toBe(</div><div class="diff-removed">-      '<div>normal[0]:b</div><div>normal[1]:b</div>',</div><div class="diff-removed">-    );</div><div class="diff-removed">-    assertLog([</div><div class="diff-removed">-      'normal[0]:b componentDidUpdate',</div><div class="diff-removed">-      'portal1[0]:b componentDidUpdate',</div><div class="diff-removed">-      'normal[1]:b componentDidUpdate',</div><div class="diff-removed">-      'portal2[0]:b componentDidUpdate',</div><div class="diff-removed">-      'portal2[1]:b componentDidUpdate',</div><div class="diff-removed">-      'Parent:b componentDidUpdate',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-</div><div class="diff-removed">-    root.unmount();</div><div class="diff-removed">-    expect(portalContainer1.innerHTML).toBe('');</div><div class="diff-removed">-    expect(portalContainer2.innerHTML).toBe('');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('');</div><div class="diff-removed">-    assertLog([</div><div class="diff-removed">-      'Parent:b componentWillUnmount',</div><div class="diff-removed">-      'normal[0]:b componentWillUnmount',</div><div class="diff-removed">-      'portal1[0]:b componentWillUnmount',</div><div class="diff-removed">-      'normal[1]:b componentWillUnmount',</div><div class="diff-removed">-      'portal2[0]:b componentWillUnmount',</div><div class="diff-removed">-      'portal2[1]:b componentWillUnmount',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render nested portals', async () => {</div><div class="diff-removed">-    const portalContainer1 = document.createElement('div');</div><div class="diff-removed">-    const portalContainer2 = document.createElement('div');</div><div class="diff-removed">-    const portalContainer3 = document.createElement('div');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render([</div><div class="diff-removed">-        <div key="a">normal[0]</div>,</div><div class="diff-removed">-        ReactDOM.createPortal(</div><div class="diff-removed">-          [</div><div class="diff-removed">-            <div key="b">portal1[0]</div>,</div><div class="diff-removed">-            ReactDOM.createPortal(</div><div class="diff-removed">-              <div key="c">portal2[0]</div>,</div><div class="diff-removed">-              portalContainer2,</div><div class="diff-removed">-            ),</div><div class="diff-removed">-            ReactDOM.createPortal(</div><div class="diff-removed">-              <div key="d">portal3[0]</div>,</div><div class="diff-removed">-              portalContainer3,</div><div class="diff-removed">-            ),</div><div class="diff-removed">-            <div key="e">portal1[1]</div>,</div><div class="diff-removed">-          ],</div><div class="diff-removed">-          portalContainer1,</div><div class="diff-removed">-        ),</div><div class="diff-removed">-        <div key="f">normal[1]</div>,</div><div class="diff-removed">-      ]);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer1.innerHTML).toBe(</div><div class="diff-removed">-      '<div>portal1[0]</div><div>portal1[1]</div>',</div><div class="diff-removed">-    );</div><div class="diff-removed">-    expect(portalContainer2.innerHTML).toBe('<div>portal2[0]</div>');</div><div class="diff-removed">-    expect(portalContainer3.innerHTML).toBe('<div>portal3[0]</div>');</div><div class="diff-removed">-    expect(container.innerHTML).toBe(</div><div class="diff-removed">-      '<div>normal[0]</div><div>normal[1]</div>',</div><div class="diff-removed">-    );</div><div class="diff-removed">-</div><div class="diff-removed">-    root.unmount();</div><div class="diff-removed">-    expect(portalContainer1.innerHTML).toBe('');</div><div class="diff-removed">-    expect(portalContainer2.innerHTML).toBe('');</div><div class="diff-removed">-    expect(portalContainer3.innerHTML).toBe('');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should reconcile portal children', async () => {</div><div class="diff-removed">-    const portalContainer = document.createElement('div');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div></div><div class="diff-removed">-          {ReactDOM.createPortal(<div>portal:1</div>, portalContainer)}</div><div class="diff-removed">-        </div>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('<div>portal:1</div>');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div></div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div></div><div class="diff-removed">-          {ReactDOM.createPortal(<div>portal:2</div>, portalContainer)}</div><div class="diff-removed">-        </div>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('<div>portal:2</div>');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div></div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div>{ReactDOM.createPortal(<p>portal:3</p>, portalContainer)}</div>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('<p>portal:3</p>');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div></div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div>{ReactDOM.createPortal(['Hi', 'Bye'], portalContainer)}</div>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('HiBye');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div></div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div>{ReactDOM.createPortal(['Bye', 'Hi'], portalContainer)}</div>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('ByeHi');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div></div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>{ReactDOM.createPortal(null, portalContainer)}</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('');</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div></div>');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should unmount empty portal component wherever it appears', async () => {</div><div class="diff-removed">-    const portalContainer = document.createElement('div');</div><div class="diff-removed">-    let instance;</div><div class="diff-removed">-    class Wrapper extends React.Component {</div><div class="diff-removed">-      constructor(props) {</div><div class="diff-removed">-        super(props);</div><div class="diff-removed">-        instance = this;</div><div class="diff-removed">-        this.state = {</div><div class="diff-removed">-          show: true,</div><div class="diff-removed">-        };</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return (</div><div class="diff-removed">-          <div></div><div class="diff-removed">-            {this.state.show && (</div><div class="diff-removed">-              <></div><div class="diff-removed">-                {ReactDOM.createPortal(null, portalContainer)}</div><div class="diff-removed">-                <div>child</div></div><div class="diff-removed">-              </></div><div class="diff-removed">-            )}</div><div class="diff-removed">-            <div>parent</div></div><div class="diff-removed">-          </div></div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Wrapper />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe(</div><div class="diff-removed">-      '<div><div>child</div><div>parent</div></div>',</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      instance.setState({show: false});</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(instance.state.show).toBe(false);</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div><div>parent</div></div>');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should keep track of namespace across portals (simple)', async () => {</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <svg {...expectSVG}></div><div class="diff-removed">-        <image {...expectSVG} /></div><div class="diff-removed">-        {usePortal(<div {...expectHTML} />)}</div><div class="diff-removed">-        <image {...expectSVG} /></div><div class="diff-removed">-      </svg>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <math {...expectMath}></div><div class="diff-removed">-        <mi {...expectMath} /></div><div class="diff-removed">-        {usePortal(<div {...expectHTML} />)}</div><div class="diff-removed">-        <mi {...expectMath} /></div><div class="diff-removed">-      </math>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <div {...expectHTML}></div><div class="diff-removed">-        <p {...expectHTML} /></div><div class="diff-removed">-        {usePortal(</div><div class="diff-removed">-          <svg {...expectSVG}></div><div class="diff-removed">-            <image {...expectSVG} /></div><div class="diff-removed">-          </svg>,</div><div class="diff-removed">-        )}</div><div class="diff-removed">-        <p {...expectHTML} /></div><div class="diff-removed">-      </div>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should keep track of namespace across portals (medium)', async () => {</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <svg {...expectSVG}></div><div class="diff-removed">-        <image {...expectSVG} /></div><div class="diff-removed">-        {usePortal(<div {...expectHTML} />)}</div><div class="diff-removed">-        <image {...expectSVG} /></div><div class="diff-removed">-        {usePortal(<div {...expectHTML} />)}</div><div class="diff-removed">-        <image {...expectSVG} /></div><div class="diff-removed">-      </svg>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <div {...expectHTML}></div><div class="diff-removed">-        <math {...expectMath}></div><div class="diff-removed">-          <mi {...expectMath} /></div><div class="diff-removed">-          {usePortal(</div><div class="diff-removed">-            <svg {...expectSVG}></div><div class="diff-removed">-              <image {...expectSVG} /></div><div class="diff-removed">-            </svg>,</div><div class="diff-removed">-          )}</div><div class="diff-removed">-        </math></div><div class="diff-removed">-        <p {...expectHTML} /></div><div class="diff-removed">-      </div>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <math {...expectMath}></div><div class="diff-removed">-        <mi {...expectMath} /></div><div class="diff-removed">-        {usePortal(</div><div class="diff-removed">-          <svg {...expectSVG}></div><div class="diff-removed">-            <image {...expectSVG} /></div><div class="diff-removed">-            <foreignObject {...expectSVG}></div><div class="diff-removed">-              <p {...expectHTML} /></div><div class="diff-removed">-              <math {...expectMath}></div><div class="diff-removed">-                <mi {...expectMath} /></div><div class="diff-removed">-              </math></div><div class="diff-removed">-              <p {...expectHTML} /></div><div class="diff-removed">-            </foreignObject></div><div class="diff-removed">-            <image {...expectSVG} /></div><div class="diff-removed">-          </svg>,</div><div class="diff-removed">-        )}</div><div class="diff-removed">-        <mi {...expectMath} /></div><div class="diff-removed">-      </math>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <div {...expectHTML}></div><div class="diff-removed">-        {usePortal(</div><div class="diff-removed">-          <svg {...expectSVG}></div><div class="diff-removed">-            {usePortal(<div {...expectHTML} />)}</div><div class="diff-removed">-            <image {...expectSVG} /></div><div class="diff-removed">-          </svg>,</div><div class="diff-removed">-        )}</div><div class="diff-removed">-        <p {...expectHTML} /></div><div class="diff-removed">-      </div>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <svg {...expectSVG}></div><div class="diff-removed">-        <svg {...expectSVG}></div><div class="diff-removed">-          {usePortal(<div {...expectHTML} />)}</div><div class="diff-removed">-          <image {...expectSVG} /></div><div class="diff-removed">-        </svg></div><div class="diff-removed">-        <image {...expectSVG} /></div><div class="diff-removed">-      </svg>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should keep track of namespace across portals (complex)', async () => {</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <div {...expectHTML}></div><div class="diff-removed">-        {usePortal(</div><div class="diff-removed">-          <svg {...expectSVG}></div><div class="diff-removed">-            <image {...expectSVG} /></div><div class="diff-removed">-          </svg>,</div><div class="diff-removed">-        )}</div><div class="diff-removed">-        <p {...expectHTML} /></div><div class="diff-removed">-        <svg {...expectSVG}></div><div class="diff-removed">-          <image {...expectSVG} /></div><div class="diff-removed">-        </svg></div><div class="diff-removed">-        <svg {...expectSVG}></div><div class="diff-removed">-          <svg {...expectSVG}></div><div class="diff-removed">-            <image {...expectSVG} /></div><div class="diff-removed">-          </svg></div><div class="diff-removed">-          <image {...expectSVG} /></div><div class="diff-removed">-        </svg></div><div class="diff-removed">-        <p {...expectHTML} /></div><div class="diff-removed">-      </div>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <div {...expectHTML}></div><div class="diff-removed">-        <svg {...expectSVG}></div><div class="diff-removed">-          <svg {...expectSVG}></div><div class="diff-removed">-            <image {...expectSVG} /></div><div class="diff-removed">-            {usePortal(</div><div class="diff-removed">-              <svg {...expectSVG}></div><div class="diff-removed">-                <image {...expectSVG} /></div><div class="diff-removed">-                <svg {...expectSVG}></div><div class="diff-removed">-                  <image {...expectSVG} /></div><div class="diff-removed">-                </svg></div><div class="diff-removed">-                <image {...expectSVG} /></div><div class="diff-removed">-              </svg>,</div><div class="diff-removed">-            )}</div><div class="diff-removed">-            <image {...expectSVG} /></div><div class="diff-removed">-            <foreignObject {...expectSVG}></div><div class="diff-removed">-              <p {...expectHTML} /></div><div class="diff-removed">-              {usePortal(<p {...expectHTML} />)}</div><div class="diff-removed">-              <p {...expectHTML} /></div><div class="diff-removed">-            </foreignObject></div><div class="diff-removed">-          </svg></div><div class="diff-removed">-          <image {...expectSVG} /></div><div class="diff-removed">-        </svg></div><div class="diff-removed">-        <p {...expectHTML} /></div><div class="diff-removed">-      </div>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <div {...expectHTML}></div><div class="diff-removed">-        <svg {...expectSVG}></div><div class="diff-removed">-          <foreignObject {...expectSVG}></div><div class="diff-removed">-            <p {...expectHTML} /></div><div class="diff-removed">-            {usePortal(</div><div class="diff-removed">-              <svg {...expectSVG}></div><div class="diff-removed">-                <image {...expectSVG} /></div><div class="diff-removed">-                <svg {...expectSVG}></div><div class="diff-removed">-                  <image {...expectSVG} /></div><div class="diff-removed">-                  <foreignObject {...expectSVG}></div><div class="diff-removed">-                    <p {...expectHTML} /></div><div class="diff-removed">-                  </foreignObject></div><div class="diff-removed">-                  {usePortal(<p {...expectHTML} />)}</div><div class="diff-removed">-                </svg></div><div class="diff-removed">-                <image {...expectSVG} /></div><div class="diff-removed">-              </svg>,</div><div class="diff-removed">-            )}</div><div class="diff-removed">-            <p {...expectHTML} /></div><div class="diff-removed">-          </foreignObject></div><div class="diff-removed">-          <image {...expectSVG} /></div><div class="diff-removed">-        </svg></div><div class="diff-removed">-        <p {...expectHTML} /></div><div class="diff-removed">-      </div>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should unwind namespaces on uncaught errors', async () => {</div><div class="diff-removed">-    function BrokenRender() {</div><div class="diff-removed">-      throw new Error('Hello');</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await expect(async () => {</div><div class="diff-removed">-      await assertNamespacesMatch(</div><div class="diff-removed">-        <svg {...expectSVG}></div><div class="diff-removed">-          <BrokenRender /></div><div class="diff-removed">-        </svg>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    }).rejects.toThrow('Hello');</div><div class="diff-removed">-    await assertNamespacesMatch(<div {...expectHTML} />);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should unwind namespaces on caught errors', async () => {</div><div class="diff-removed">-    function BrokenRender() {</div><div class="diff-removed">-      throw new Error('Hello');</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class ErrorBoundary extends React.Component {</div><div class="diff-removed">-      state = {error: null};</div><div class="diff-removed">-      componentDidCatch(error) {</div><div class="diff-removed">-        this.setState({error});</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        if (this.state.error) {</div><div class="diff-removed">-          return <p {...expectHTML} />;</div><div class="diff-removed">-        }</div><div class="diff-removed">-        return this.props.children;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <svg {...expectSVG}></div><div class="diff-removed">-        <foreignObject {...expectSVG}></div><div class="diff-removed">-          <ErrorBoundary></div><div class="diff-removed">-            <math {...expectMath}></div><div class="diff-removed">-              <BrokenRender /></div><div class="diff-removed">-            </math></div><div class="diff-removed">-          </ErrorBoundary></div><div class="diff-removed">-        </foreignObject></div><div class="diff-removed">-        <image {...expectSVG} /></div><div class="diff-removed">-      </svg>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-    await assertNamespacesMatch(<div {...expectHTML} />);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should unwind namespaces on caught errors in a portal', async () => {</div><div class="diff-removed">-    function BrokenRender() {</div><div class="diff-removed">-      throw new Error('Hello');</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class ErrorBoundary extends React.Component {</div><div class="diff-removed">-      state = {error: null};</div><div class="diff-removed">-      componentDidCatch(error) {</div><div class="diff-removed">-        this.setState({error});</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        if (this.state.error) {</div><div class="diff-removed">-          return <image {...expectSVG} />;</div><div class="diff-removed">-        }</div><div class="diff-removed">-        return this.props.children;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await assertNamespacesMatch(</div><div class="diff-removed">-      <svg {...expectSVG}></div><div class="diff-removed">-        <ErrorBoundary></div><div class="diff-removed">-          {usePortal(</div><div class="diff-removed">-            <div {...expectHTML}></div><div class="diff-removed">-              <math {...expectMath}></div><div class="diff-removed">-                <BrokenRender />)</div><div class="diff-removed">-              </math></div><div class="diff-removed">-            </div>,</div><div class="diff-removed">-          )}</div><div class="diff-removed">-        </ErrorBoundary></div><div class="diff-removed">-        {usePortal(<div {...expectHTML} />)}</div><div class="diff-removed">-      </svg>,</div><div class="diff-removed">-    );</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  // @gate !disableLegacyContext</div><div class="diff-removed">-  it('should pass portal context when rendering subtree elsewhere', async () => {</div><div class="diff-removed">-    const portalContainer = document.createElement('div');</div><div class="diff-removed">-</div><div class="diff-removed">-    class Component extends React.Component {</div><div class="diff-removed">-      static contextTypes = {</div><div class="diff-removed">-        foo: PropTypes.string.isRequired,</div><div class="diff-removed">-      };</div><div class="diff-removed">-</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div>{this.context.foo}</div>;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class Parent extends React.Component {</div><div class="diff-removed">-      static childContextTypes = {</div><div class="diff-removed">-        foo: PropTypes.string.isRequired,</div><div class="diff-removed">-      };</div><div class="diff-removed">-</div><div class="diff-removed">-      getChildContext() {</div><div class="diff-removed">-        return {</div><div class="diff-removed">-          foo: 'bar',</div><div class="diff-removed">-        };</div><div class="diff-removed">-      }</div><div class="diff-removed">-</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return ReactDOM.createPortal(<Component />, portalContainer);</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(async () => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'Parent uses the legacy childContextTypes API which will soon be removed. ' +</div><div class="diff-removed">-        'Use React.createContext() instead. (https://react.dev/link/legacy-context)\n' +</div><div class="diff-removed">-        '    in Parent (at **)',</div><div class="diff-removed">-      'Component uses the legacy contextTypes API which will soon be removed. ' +</div><div class="diff-removed">-        'Use React.createContext() with static contextType instead. (https://react.dev/link/legacy-context)\n' +</div><div class="diff-removed">-        '    in Parent (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-    expect(container.innerHTML).toBe('');</div><div class="diff-removed">-    expect(portalContainer.innerHTML).toBe('<div>bar</div>');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should bubble events from the portal to the parent', async () => {</div><div class="diff-removed">-    const portalContainer = document.createElement('div');</div><div class="diff-removed">-    document.body.appendChild(portalContainer);</div><div class="diff-removed">-    try {</div><div class="diff-removed">-      let portal = null;</div><div class="diff-removed">-</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        root.render(</div><div class="diff-removed">-          <div onClick={() => Scheduler.log('parent clicked')}></div><div class="diff-removed">-            {ReactDOM.createPortal(</div><div class="diff-removed">-              <div</div><div class="diff-removed">-                onClick={() => Scheduler.log('portal clicked')}</div><div class="diff-removed">-                ref={n => (portal = n)}></div><div class="diff-removed">-                portal</div><div class="diff-removed">-              </div>,</div><div class="diff-removed">-              portalContainer,</div><div class="diff-removed">-            )}</div><div class="diff-removed">-          </div>,</div><div class="diff-removed">-        );</div><div class="diff-removed">-      });</div><div class="diff-removed">-</div><div class="diff-removed">-      expect(portal.tagName).toBe('DIV');</div><div class="diff-removed">-</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        portal.click();</div><div class="diff-removed">-      });</div><div class="diff-removed">-</div><div class="diff-removed">-      assertLog(['portal clicked', 'parent clicked']);</div><div class="diff-removed">-    } finally {</div><div class="diff-removed">-      document.body.removeChild(portalContainer);</div><div class="diff-removed">-    }</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not onMouseLeave when staying in the portal', async () => {</div><div class="diff-removed">-    const portalContainer = document.createElement('div');</div><div class="diff-removed">-    document.body.appendChild(portalContainer);</div><div class="diff-removed">-</div><div class="diff-removed">-    let firstTarget = null;</div><div class="diff-removed">-    let secondTarget = null;</div><div class="diff-removed">-    let thirdTarget = null;</div><div class="diff-removed">-</div><div class="diff-removed">-    function simulateMouseMove(from, to) {</div><div class="diff-removed">-      if (from) {</div><div class="diff-removed">-        from.dispatchEvent(</div><div class="diff-removed">-          new MouseEvent('mouseout', {</div><div class="diff-removed">-            bubbles: true,</div><div class="diff-removed">-            cancelable: true,</div><div class="diff-removed">-            relatedTarget: to,</div><div class="diff-removed">-          }),</div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-      if (to) {</div><div class="diff-removed">-        to.dispatchEvent(</div><div class="diff-removed">-          new MouseEvent('mouseover', {</div><div class="diff-removed">-            bubbles: true,</div><div class="diff-removed">-            cancelable: true,</div><div class="diff-removed">-            relatedTarget: from,</div><div class="diff-removed">-          }),</div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    try {</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        root.render(</div><div class="diff-removed">-          <div></div><div class="diff-removed">-            <div</div><div class="diff-removed">-              onMouseEnter={() => Scheduler.log('enter parent')}</div><div class="diff-removed">-              onMouseLeave={() => Scheduler.log('leave parent')}></div><div class="diff-removed">-              <div ref={n => (firstTarget = n)} /></div><div class="diff-removed">-              {ReactDOM.createPortal(</div><div class="diff-removed">-                <div</div><div class="diff-removed">-                  onMouseEnter={() => Scheduler.log('enter portal')}</div><div class="diff-removed">-                  onMouseLeave={() => Scheduler.log('leave portal')}</div><div class="diff-removed">-                  ref={n => (secondTarget = n)}></div><div class="diff-removed">-                  portal</div><div class="diff-removed">-                </div>,</div><div class="diff-removed">-                portalContainer,</div><div class="diff-removed">-              )}</div><div class="diff-removed">-            </div></div><div class="diff-removed">-            <div ref={n => (thirdTarget = n)} /></div><div class="diff-removed">-          </div>,</div><div class="diff-removed">-        );</div><div class="diff-removed">-      });</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        simulateMouseMove(null, firstTarget);</div><div class="diff-removed">-      });</div><div class="diff-removed">-      assertLog(['enter parent']);</div><div class="diff-removed">-</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        simulateMouseMove(firstTarget, secondTarget);</div><div class="diff-removed">-      });</div><div class="diff-removed">-      assertLog([</div><div class="diff-removed">-        // Parent did not invoke leave because we're still inside the portal.</div><div class="diff-removed">-        'enter portal',</div><div class="diff-removed">-      ]);</div><div class="diff-removed">-</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        simulateMouseMove(secondTarget, thirdTarget);</div><div class="diff-removed">-      });</div><div class="diff-removed">-      assertLog([</div><div class="diff-removed">-        'leave portal',</div><div class="diff-removed">-        'leave parent', // Only when we leave the portal does onMouseLeave fire.</div><div class="diff-removed">-      ]);</div><div class="diff-removed">-    } finally {</div><div class="diff-removed">-      document.body.removeChild(portalContainer);</div><div class="diff-removed">-    }</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  // Regression test for https://github.com/facebook/react/issues/19562</div><div class="diff-removed">-  it('does not fire mouseEnter twice when relatedTarget is the root node', async () => {</div><div class="diff-removed">-    let target = null;</div><div class="diff-removed">-</div><div class="diff-removed">-    function simulateMouseMove(from, to) {</div><div class="diff-removed">-      if (from) {</div><div class="diff-removed">-        from.dispatchEvent(</div><div class="diff-removed">-          new MouseEvent('mouseout', {</div><div class="diff-removed">-            bubbles: true,</div><div class="diff-removed">-            cancelable: true,</div><div class="diff-removed">-            relatedTarget: to,</div><div class="diff-removed">-          }),</div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-      if (to) {</div><div class="diff-removed">-        to.dispatchEvent(</div><div class="diff-removed">-          new MouseEvent('mouseover', {</div><div class="diff-removed">-            bubbles: true,</div><div class="diff-removed">-            cancelable: true,</div><div class="diff-removed">-            relatedTarget: from,</div><div class="diff-removed">-          }),</div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div</div><div class="diff-removed">-          ref={n => (target = n)}</div><div class="diff-removed">-          onMouseEnter={() => Scheduler.log('enter')}</div><div class="diff-removed">-          onMouseLeave={() => Scheduler.log('leave')}</div><div class="diff-removed">-        />,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      simulateMouseMove(null, container);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog([]);</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      simulateMouseMove(container, target);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['enter']);</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      simulateMouseMove(target, container);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['leave']);</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      simulateMouseMove(container, null);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog([]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('listens to events that do not exist in the Portal subtree', async () => {</div><div class="diff-removed">-    const onClick = jest.fn();</div><div class="diff-removed">-</div><div class="diff-removed">-    const ref = React.createRef();</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div onClick={onClick}></div><div class="diff-removed">-          {ReactDOM.createPortal(</div><div class="diff-removed">-            <button ref={ref}>click</button>,</div><div class="diff-removed">-            document.body,</div><div class="diff-removed">-          )}</div><div class="diff-removed">-        </div>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    const event = new MouseEvent('click', {</div><div class="diff-removed">-      bubbles: true,</div><div class="diff-removed">-    });</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      ref.current.dispatchEvent(event);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(onClick).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should throw on bad createPortal argument', () => {</div><div class="diff-removed">-    expect(() => {</div><div class="diff-removed">-      ReactDOM.createPortal(<div>portal</div>, null);</div><div class="diff-removed">-    }).toThrow('Target container is not a DOM element.');</div><div class="diff-removed">-    expect(() => {</div><div class="diff-removed">-      ReactDOM.createPortal(<div>portal</div>, document.createTextNode('hi'));</div><div class="diff-removed">-    }).toThrow('Target container is not a DOM element.');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should warn for non-functional event listeners', () => {</div><div class="diff-removed">-    class Example extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div onClick="woops" />;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    ReactDOM.flushSync(() => {</div><div class="diff-removed">-      root.render(<Example />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'Expected `onClick` listener to be a function, instead got a value of `string` type.\n' +</div><div class="diff-removed">-        '    in div (at **)\n' +</div><div class="diff-removed">-        '    in Example (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should warn with a special message for `false` event listeners', () => {</div><div class="diff-removed">-    class Example extends React.Component {</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div onClick={false} />;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-    ReactDOM.flushSync(() => {</div><div class="diff-removed">-      root.render(<Example />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertConsoleErrorDev([</div><div class="diff-removed">-      'Expected `onClick` listener to be a function, instead got `false`.\n\n' +</div><div class="diff-removed">-        'If you used to conditionally omit it with onClick={condition && value}, ' +</div><div class="diff-removed">-        'pass onClick={condition ? value : undefined} instead.\n' +</div><div class="diff-removed">-        '    in div (at **)\n' +</div><div class="diff-removed">-        '    in Example (at **)',</div><div class="diff-removed">-    ]);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not update event handlers until commit', async () => {</div><div class="diff-removed">-    const handlerA = () => Scheduler.log('A');</div><div class="diff-removed">-    const handlerB = () => Scheduler.log('B');</div><div class="diff-removed">-</div><div class="diff-removed">-    function click() {</div><div class="diff-removed">-      const event = new MouseEvent('click', {</div><div class="diff-removed">-        bubbles: true,</div><div class="diff-removed">-        cancelable: true,</div><div class="diff-removed">-      });</div><div class="diff-removed">-      Object.defineProperty(event, 'timeStamp', {</div><div class="diff-removed">-        value: 0,</div><div class="diff-removed">-      });</div><div class="diff-removed">-      node.dispatchEvent(event);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class Example extends React.Component {</div><div class="diff-removed">-      state = {flip: false, count: 0};</div><div class="diff-removed">-      flip() {</div><div class="diff-removed">-        this.setState({flip: true, count: this.state.count + 1});</div><div class="diff-removed">-      }</div><div class="diff-removed">-      tick() {</div><div class="diff-removed">-        this.setState({count: this.state.count + 1});</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        const useB = !this.props.forceA && this.state.flip;</div><div class="diff-removed">-        return <div onClick={useB ? handlerB : handlerA} />;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class Click extends React.Component {</div><div class="diff-removed">-      constructor() {</div><div class="diff-removed">-        super();</div><div class="diff-removed">-        node.click();</div><div class="diff-removed">-      }</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return null;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    let inst;</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render([<Example key="a" ref={n => (inst = n)} />]);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    const node = container.firstChild;</div><div class="diff-removed">-    expect(node.tagName).toEqual('DIV');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      click();</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    assertLog(['A']);</div><div class="diff-removed">-</div><div class="diff-removed">-    // Render with the other event handler.</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      inst.flip();</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      click();</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    assertLog(['B']);</div><div class="diff-removed">-</div><div class="diff-removed">-    // Rerender without changing any props.</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      inst.tick();</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      click();</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    assertLog(['B']);</div><div class="diff-removed">-</div><div class="diff-removed">-    // Render a flip back to the A handler. The second component invokes the</div><div class="diff-removed">-    // click handler during render to simulate a click during an aborted</div><div class="diff-removed">-    // render. I use this hack because at current time we don't have a way to</div><div class="diff-removed">-    // test aborted ReactDOM renders.</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render([<Example key="a" forceA={true} />, <Click key="b" />]);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    // Because the new click handler has not yet committed, we should still</div><div class="diff-removed">-    // invoke B.</div><div class="diff-removed">-    assertLog(['B']);</div><div class="diff-removed">-</div><div class="diff-removed">-    // Any click that happens after commit, should invoke A.</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      click();</div><div class="diff-removed">-    });</div><div class="diff-removed">-    assertLog(['A']);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not crash encountering low-priority tree', async () => {</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(</div><div class="diff-removed">-        <div hidden={true}></div><div class="diff-removed">-          <div /></div><div class="diff-removed">-        </div>,</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div hidden=""><div></div></div>');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not warn when rendering into an empty container', async () => {</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>foo</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>foo</div>');</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(null);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('');</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>bar</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>bar</div>');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should warn when replacing a container which was manually updated outside of React', async () => {</div><div class="diff-removed">-    // when not messing with the DOM outside of React</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div key="1">foo</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>foo</div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div key="1">bar</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>bar</div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    // then we mess with the DOM before an update</div><div class="diff-removed">-    // we know this will error - that is expected right now</div><div class="diff-removed">-    // It's an error of type 'NotFoundError' with no message</div><div class="diff-removed">-    container.innerHTML = '<div>MEOW.</div>';</div><div class="diff-removed">-</div><div class="diff-removed">-    await expect(async () => {</div><div class="diff-removed">-      await act(() => {</div><div class="diff-removed">-        ReactDOM.flushSync(() => {</div><div class="diff-removed">-          root.render(<div key="2">baz</div>);</div><div class="diff-removed">-        });</div><div class="diff-removed">-      });</div><div class="diff-removed">-    }).rejects.toThrow('The node to be removed is not a child of this node');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not warn when doing an update to a container manually updated outside of React', async () => {</div><div class="diff-removed">-    // when not messing with the DOM outside of React</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>foo</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>foo</div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>bar</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>bar</div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    // then we mess with the DOM before an update</div><div class="diff-removed">-    container.innerHTML = '<div>MEOW.</div>';</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>baz</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    // TODO: why not, and no error?</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>MEOW.</div>');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should not warn when doing an update to a container manually cleared outside of React', async () => {</div><div class="diff-removed">-    // when not messing with the DOM outside of React</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>foo</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>foo</div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>bar</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>bar</div>');</div><div class="diff-removed">-</div><div class="diff-removed">-    // then we mess with the DOM before an update</div><div class="diff-removed">-    container.innerHTML = '';</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<div>baz</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    // TODO: why not, and no error?</div><div class="diff-removed">-    expect(container.innerHTML).toBe('');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should render a text component with a text DOM node on the same document as the container', async () => {</div><div class="diff-removed">-    // 1. Create a new document through the use of iframe</div><div class="diff-removed">-    // 2. Set up the spy to make asserts when a text component</div><div class="diff-removed">-    //    is rendered inside the iframe container</div><div class="diff-removed">-    const textContent = 'Hello world';</div><div class="diff-removed">-    const iframe = document.createElement('iframe');</div><div class="diff-removed">-    document.body.appendChild(iframe);</div><div class="diff-removed">-    const iframeDocument = iframe.contentDocument;</div><div class="diff-removed">-    iframeDocument.write(</div><div class="diff-removed">-      '<!DOCTYPE html><html><head></head><body><div></div></body></html>',</div><div class="diff-removed">-    );</div><div class="diff-removed">-    iframeDocument.close();</div><div class="diff-removed">-    const iframeContainer = iframeDocument.body.firstChild;</div><div class="diff-removed">-</div><div class="diff-removed">-    let actualDocument;</div><div class="diff-removed">-    let textNode;</div><div class="diff-removed">-</div><div class="diff-removed">-    spyOnDevAndProd(iframeContainer, 'appendChild').mockImplementation(node => {</div><div class="diff-removed">-      actualDocument = node.ownerDocument;</div><div class="diff-removed">-      textNode = node;</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    const iFrameRoot = ReactDOMClient.createRoot(iframeContainer);</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      iFrameRoot.render(textContent);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(textNode.textContent).toBe(textContent);</div><div class="diff-removed">-    expect(actualDocument).not.toBe(document);</div><div class="diff-removed">-    expect(actualDocument).toBe(iframeDocument);</div><div class="diff-removed">-    expect(iframeContainer.appendChild).toHaveBeenCalledTimes(1);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should mount into a document fragment', async () => {</div><div class="diff-removed">-    const fragment = document.createDocumentFragment();</div><div class="diff-removed">-    const fragmentRoot = ReactDOMClient.createRoot(fragment);</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      fragmentRoot.render(<div>foo</div>);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(container.innerHTML).toBe('');</div><div class="diff-removed">-    container.appendChild(fragment);</div><div class="diff-removed">-    expect(container.innerHTML).toBe('<div>foo</div>');</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  // Regression test for https://github.com/facebook/react/issues/12643#issuecomment-413727104</div><div class="diff-removed">-  it('should not diff memoized host components', async () => {</div><div class="diff-removed">-    const inputRef = React.createRef();</div><div class="diff-removed">-    let didCallOnChange = false;</div><div class="diff-removed">-</div><div class="diff-removed">-    class Child extends React.Component {</div><div class="diff-removed">-      state = {};</div><div class="diff-removed">-      componentDidMount() {</div><div class="diff-removed">-        document.addEventListener('click', this.update, true);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      componentWillUnmount() {</div><div class="diff-removed">-        document.removeEventListener('click', this.update, true);</div><div class="diff-removed">-      }</div><div class="diff-removed">-      update = () => {</div><div class="diff-removed">-        // We're testing that this setState()</div><div class="diff-removed">-        // doesn't cause React to commit updates</div><div class="diff-removed">-        // to the input outside (which would itself</div><div class="diff-removed">-        // prevent the parent's onChange parent handler</div><div class="diff-removed">-        // from firing).</div><div class="diff-removed">-        this.setState({});</div><div class="diff-removed">-        // Note that onChange was always broken when there was an</div><div class="diff-removed">-        // earlier setState() in a manual document capture phase</div><div class="diff-removed">-        // listener *in the same component*. But that's very rare.</div><div class="diff-removed">-        // Here we're testing that a *child* component doesn't break</div><div class="diff-removed">-        // the parent if this happens.</div><div class="diff-removed">-      };</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return <div />;</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    class Parent extends React.Component {</div><div class="diff-removed">-      handleChange = val => {</div><div class="diff-removed">-        didCallOnChange = true;</div><div class="diff-removed">-      };</div><div class="diff-removed">-      render() {</div><div class="diff-removed">-        return (</div><div class="diff-removed">-          <div></div><div class="diff-removed">-            <Child /></div><div class="diff-removed">-            <input</div><div class="diff-removed">-              ref={inputRef}</div><div class="diff-removed">-              type="checkbox"</div><div class="diff-removed">-              checked={true}</div><div class="diff-removed">-              onChange={this.handleChange}</div><div class="diff-removed">-            /></div><div class="diff-removed">-          </div></div><div class="diff-removed">-        );</div><div class="diff-removed">-      }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Parent />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      inputRef.current.dispatchEvent(</div><div class="diff-removed">-        new MouseEvent('click', {</div><div class="diff-removed">-          bubbles: true,</div><div class="diff-removed">-        }),</div><div class="diff-removed">-      );</div><div class="diff-removed">-    });</div><div class="diff-removed">-    expect(didCallOnChange).toBe(true);</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  it('should restore selection in the correct window', async () => {</div><div class="diff-removed">-    // creating new JSDOM instance to get a second window as window.open is not implemented</div><div class="diff-removed">-    // https://github.com/jsdom/jsdom/blob/c53efc81e75f38a0558fbf3ed75d30b78b4c4898/lib/jsdom/browser/Window.js#L987</div><div class="diff-removed">-    const {window: newWindow} = new JSDOM('');</div><div class="diff-removed">-    // creating a new container since the default cleanup expects the existing container to be in the document</div><div class="diff-removed">-    const newContainer = newWindow.document.createElement('div');</div><div class="diff-removed">-    newWindow.document.body.appendChild(newContainer);</div><div class="diff-removed">-    root = ReactDOMClient.createRoot(newContainer);</div><div class="diff-removed">-</div><div class="diff-removed">-    const Test = () => {</div><div class="diff-removed">-      const [reverse, setReverse] = React.useState(false);</div><div class="diff-removed">-      const [items] = React.useState(() => ['a', 'b', 'c']);</div><div class="diff-removed">-      const onClick = () => {</div><div class="diff-removed">-        setReverse(true);</div><div class="diff-removed">-      };</div><div class="diff-removed">-</div><div class="diff-removed">-      // shuffle the items so that the react commit needs to restore focus</div><div class="diff-removed">-      // to the correct element after commit</div><div class="diff-removed">-      const itemsToRender = reverse ? items.reverse() : items;</div><div class="diff-removed">-</div><div class="diff-removed">-      return (</div><div class="diff-removed">-        <div></div><div class="diff-removed">-          {itemsToRender.map(item => (</div><div class="diff-removed">-            <button onClick={onClick} key={item} id={item}></div><div class="diff-removed">-              {item}</div><div class="diff-removed">-            </button></div><div class="diff-removed">-          ))}</div><div class="diff-removed">-        </div></div><div class="diff-removed">-      );</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      root.render(<Test />);</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    newWindow.document.getElementById('a').focus();</div><div class="diff-removed">-    await act(() => {</div><div class="diff-removed">-      newWindow.document.getElementById('a').click();</div><div class="diff-removed">-    });</div><div class="diff-removed">-</div><div class="diff-removed">-    expect(newWindow.document.activeElement).not.toBe(newWindow.document.body);</div><div class="diff-removed">-    expect(newWindow.document.activeElement.innerHTML).toBe('a');</div><div class="diff-removed">-  });</div><div class="diff-removed">-});</div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    