<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/react-devtools-shared/src/backend/views/TraceUpdates/canvas.js - Gemini 2.5 Flash</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/react-devtools-shared/src/backend/views/TraceUpdates/canvas.js</h1>
        <p><a href="../../models/google_gemini-2.5-flash-preview.html">‚Üê Back to Gemini 2.5 Flash Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> Gemini 2.5 Flash</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 7064</p>
                <p><strong>Output Tokens:</strong> N/A</p>
                <p><strong>Native Prompt Tokens:</strong> 8490</p>
                <p><strong>Native Completion Tokens:</strong> 1880</p>
                <p><strong>Native Tokens Reasoning:</strong> 0</p>
                <p><strong>Native Finish Reason:</strong> STOP</p>
                <p><strong>Cost:</strong> $0.0024015</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/google_gemini-2.5-flash-preview/react_packages_react-devtools-shared_src_backend_views_TraceUpdates_canvas.js/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/google_gemini-2.5-flash-preview/react_packages_react-devtools-shared_src_backend_views_TraceUpdates_canvas.js/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/google_gemini-2.5-flash-preview/react_packages_react-devtools-shared_src_backend_views_TraceUpdates_canvas.js/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div></div><div>index fb2bf25a..d49d878e 100644</div><div class="diff-header">--- a/react_packages_react-devtools-shared_src_backend_views_TraceUpdates_canvas.js_expectedoutput.txt (expected):tmp/tmppzatpx6e_expected.txt	</div><div class="diff-header">+++ b/react_packages_react-devtools-shared_src_backend_views_TraceUpdates_canvas.js_extracted.txt (actual):tmp/tmp8atzpqz6_actual.txt	</div><div class="diff-info">@@ -1,221 +1,190 @@</div><div> /**</div><div>  * Copyright (c) Meta Platforms, Inc. and affiliates.</div><div>  *</div><div class="diff-removed">- * This source code is licensed under the MIT license found in the</div><div class="diff-removed">- * LICENSE file in the root directory of this source tree.</div><div class="diff-removed">- *</div><div class="diff-removed">- * @flow</div><div class="diff-removed">- */</div><div class="diff-removed">-</div><div class="diff-removed">-import type {Data} from './index';</div><div class="diff-removed">-import type {Rect} from '../utils';</div><div class="diff-removed">-import type {HostInstance} from '../../types';</div><div class="diff-removed">-import type Agent from '../../agent';</div><div class="diff-removed">-</div><div class="diff-removed">-import {isReactNativeEnvironment} from 'react-devtools-shared/src/backend/utils';</div><div class="diff-removed">-</div><div class="diff-removed">-// Note these colors are in sync with DevTools Profiler chart colors.</div><div class="diff-removed">-const COLORS = [</div><div class="diff-removed">-  '#37afa9',</div><div class="diff-removed">-  '#63b19e',</div><div class="diff-removed">-  '#80b393',</div><div class="diff-removed">-  '#97b488',</div><div class="diff-removed">-  '#abb67d',</div><div class="diff-removed">-  '#beb771',</div><div class="diff-removed">-  '#cfb965',</div><div class="diff-removed">-  '#dfba57',</div><div class="diff-removed">-  '#efbb49',</div><div class="diff-removed">-  '#febc38',</div><div class="diff-removed">-];</div><div class="diff-removed">-</div><div class="diff-removed">-let canvas: HTMLCanvasElement | null = null;</div><div class="diff-removed">-</div><div class="diff-removed">-function drawNative(nodeToData: Map<HostInstance, Data>, agent: Agent) {</div><div class="diff-removed">-  const nodesToDraw = [];</div><div class="diff-removed">-  iterateNodes(nodeToData, ({color, node}) => {</div><div class="diff-removed">-    nodesToDraw.push({node, color});</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  agent.emit('drawTraceUpdates', nodesToDraw);</div><div class="diff-removed">-</div><div class="diff-removed">-  const mergedNodes = groupAndSortNodes(nodeToData);</div><div class="diff-removed">-  agent.emit('drawGroupedTraceUpdatesWithNames', mergedNodes);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function drawWeb(nodeToData: Map<HostInstance, Data>) {</div><div class="diff-removed">-  if (canvas === null) {</div><div class="diff-removed">-    initialize();</div><div class="diff-removed">-  }</div><div class="diff-removed">-</div><div class="diff-removed">-  const dpr = window.devicePixelRatio || 1;</div><div class="diff-removed">-  const canvasFlow: HTMLCanvasElement = ((canvas: any): HTMLCanvasElement);</div><div class="diff-removed">-  canvasFlow.width = window.innerWidth * dpr;</div><div class="diff-removed">-  canvasFlow.height = window.innerHeight * dpr;</div><div class="diff-removed">-  canvasFlow.style.width = `${window.innerWidth}px`;</div><div class="diff-removed">-  canvasFlow.style.height = `${window.innerHeight}px`;</div><div class="diff-removed">-</div><div class="diff-removed">-  const context = canvasFlow.getContext('2d');</div><div class="diff-removed">-  context.scale(dpr, dpr);</div><div class="diff-removed">-</div><div class="diff-removed">-  context.clearRect(0, 0, canvasFlow.width / dpr, canvasFlow.height / dpr);</div><div class="diff-removed">-</div><div class="diff-removed">-  const mergedNodes = groupAndSortNodes(nodeToData);</div><div class="diff-removed">-</div><div class="diff-removed">-  mergedNodes.forEach(group => {</div><div class="diff-removed">-    drawGroupBorders(context, group);</div><div class="diff-removed">-    drawGroupLabel(context, group);</div><div class="diff-removed">-  });</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-type GroupItem = {</div><div class="diff-removed">-  rect: Rect,</div><div class="diff-removed">-  color: string,</div><div class="diff-removed">-  displayName: string | null,</div><div class="diff-removed">-  count: number,</div><div class="diff-removed">-};</div><div class="diff-removed">-</div><div class="diff-removed">-export type {GroupItem};</div><div class="diff-removed">-</div><div class="diff-removed">-export function groupAndSortNodes(</div><div class="diff-removed">-  nodeToData: Map<HostInstance, Data>,</div><div class="diff-removed">-): Array<Array<GroupItem>> {</div><div class="diff-removed">-  const positionGroups: Map<string, Array<GroupItem>> = new Map();</div><div class="diff-removed">-</div><div class="diff-removed">-  iterateNodes(nodeToData, ({rect, color, displayName, count}) => {</div><div class="diff-removed">-    if (!rect) return;</div><div class="diff-removed">-    const key = `${rect.left},${rect.top}`;</div><div class="diff-removed">-    if (!positionGroups.has(key)) positionGroups.set(key, []);</div><div class="diff-removed">-    positionGroups.get(key)?.push({rect, color, displayName, count});</div><div class="diff-removed">-  });</div><div class="diff-removed">-</div><div class="diff-removed">-  return Array.from(positionGroups.values()).sort((groupA, groupB) => {</div><div class="diff-removed">-    const maxCountA = Math.max(...groupA.map(item => item.count));</div><div class="diff-removed">-    const maxCountB = Math.max(...groupB.map(item => item.count));</div><div class="diff-removed">-    return maxCountA - maxCountB;</div><div class="diff-removed">-  });</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function drawGroupBorders(</div><div class="diff-removed">-  context: CanvasRenderingContext2D,</div><div class="diff-removed">-  group: Array<GroupItem>,</div><div class="diff-removed">-) {</div><div class="diff-removed">-  group.forEach(({color, rect}) => {</div><div class="diff-removed">-    context.beginPath();</div><div class="diff-removed">-    context.strokeStyle = color;</div><div class="diff-removed">-    context.rect(rect.left, rect.top, rect.width - 1, rect.height - 1);</div><div class="diff-removed">-    context.stroke();</div><div class="diff-removed">-  });</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function drawGroupLabel(</div><div class="diff-removed">-  context: CanvasRenderingContext2D,</div><div class="diff-removed">-  group: Array<GroupItem>,</div><div class="diff-removed">-) {</div><div class="diff-removed">-  const mergedName = group</div><div class="diff-removed">-    .map(({displayName, count}) =></div><div class="diff-removed">-      displayName ? `${displayName}${count > 1 ? ` x${count}` : ''}` : '',</div><div class="diff-removed">-    )</div><div class="diff-removed">-    .filter(Boolean)</div><div class="diff-removed">-    .join(', ');</div><div class="diff-removed">-</div><div class="diff-removed">-  if (mergedName) {</div><div class="diff-removed">-    drawLabel(context, group[0].rect, mergedName, group[0].color);</div><div class="diff-removed">-  }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-export function draw(nodeToData: Map<HostInstance, Data>, agent: Agent): void {</div><div class="diff-removed">-  return isReactNativeEnvironment()</div><div class="diff-removed">-    ? drawNative(nodeToData, agent)</div><div class="diff-removed">-    : drawWeb(nodeToData);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-type DataWithColorAndNode = {</div><div class="diff-removed">-  ...Data,</div><div class="diff-removed">-  color: string,</div><div class="diff-removed">-  node: HostInstance,</div><div class="diff-removed">-};</div><div class="diff-removed">-</div><div class="diff-removed">-function iterateNodes(</div><div class="diff-removed">-  nodeToData: Map<HostInstance, Data>,</div><div class="diff-removed">-  execute: (data: DataWithColorAndNode) => void,</div><div class="diff-removed">-) {</div><div class="diff-removed">-  nodeToData.forEach((data, node) => {</div><div class="diff-removed">-    const colorIndex = Math.min(COLORS.length - 1, data.count - 1);</div><div class="diff-removed">-    const color = COLORS[colorIndex];</div><div class="diff-removed">-    execute({</div><div class="diff-removed">-      color,</div><div class="diff-removed">-      node,</div><div class="diff-removed">-      count: data.count,</div><div class="diff-removed">-      displayName: data.displayName,</div><div class="diff-removed">-      expirationTime: data.expirationTime,</div><div class="diff-removed">-      lastMeasuredAt: data.lastMeasuredAt,</div><div class="diff-removed">-      rect: data.rect,</div><div class="diff-removed">-    });</div><div class="diff-removed">-  });</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function drawLabel(</div><div class="diff-removed">-  context: CanvasRenderingContext2D,</div><div class="diff-removed">-  rect: Rect,</div><div class="diff-removed">-  text: string,</div><div class="diff-removed">-  color: string,</div><div class="diff-removed">-): void {</div><div class="diff-removed">-  const {left, top} = rect;</div><div class="diff-removed">-  context.font = '10px monospace';</div><div class="diff-removed">-  context.textBaseline = 'middle';</div><div class="diff-removed">-  context.textAlign = 'center';</div><div class="diff-removed">-</div><div class="diff-removed">-  const padding = 2;</div><div class="diff-removed">-  const textHeight = 14;</div><div class="diff-removed">-</div><div class="diff-removed">-  const metrics = context.measureText(text);</div><div class="diff-removed">-  const backgroundWidth = metrics.width + padding * 2;</div><div class="diff-removed">-  const backgroundHeight = textHeight;</div><div class="diff-removed">-  const labelX = left;</div><div class="diff-removed">-  const labelY = top - backgroundHeight;</div><div class="diff-removed">-</div><div class="diff-removed">-  context.fillStyle = color;</div><div class="diff-removed">-  context.fillRect(labelX, labelY, backgroundWidth, backgroundHeight);</div><div class="diff-removed">-</div><div class="diff-removed">-  context.fillStyle = '#000000';</div><div class="diff-removed">-  context.fillText(</div><div class="diff-removed">-    text,</div><div class="diff-removed">-    labelX + backgroundWidth / 2,</div><div class="diff-removed">-    labelY + backgroundHeight / 2,</div><div class="diff-removed">-  );</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function destroyNative(agent: Agent) {</div><div class="diff-removed">-  agent.emit('disableTraceUpdates');</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function destroyWeb() {</div><div class="diff-removed">-  if (canvas !== null) {</div><div class="diff-removed">-    if (canvas.parentNode != null) {</div><div class="diff-removed">-      canvas.parentNode.removeChild(canvas);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    canvas = null;</div><div class="diff-removed">-  }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-export function destroy(agent: Agent): void {</div><div class="diff-removed">-  return isReactNativeEnvironment() ? destroyNative(agent) : destroyWeb();</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-function initialize(): void {</div><div class="diff-removed">-  canvas = window.document.createElement('canvas');</div><div class="diff-removed">-  canvas.style.cssText = `</div><div class="diff-removed">-    xx-background-color: red;</div><div class="diff-removed">-    xx-opacity: 0.5;</div><div class="diff-removed">-    bottom: 0;</div><div class="diff-removed">-    left: 0;</div><div class="diff-removed">-    pointer-events: none;</div><div class="diff-removed">-    position: fixed;</div><div class="diff-removed">-    right: 0;</div><div class="diff-removed">-    top: 0;</div><div class="diff-removed">-    z-index: 1000000000;</div><div class="diff-removed">-  `;</div><div class="diff-removed">-</div><div class="diff-removed">-  const root = window.document.documentElement;</div><div class="diff-removed">-  root.insertBefore(canvas, root.firstChild);</div><div class="diff-removed">-}</div><div>\ No newline at end of file</div><div class="diff-added">+@@ -14,8 +14,6 @@ import type Agent from '../../agent';</div><div class="diff-added">+ </div><div class="diff-added">+ import {isReactNativeEnvironment} from 'react-devtools-shared/src/backend/utils';</div><div class="diff-added">+ </div><div class="diff-added">+-const OUTLINE_COLOR = '#f0f0f0';</div><div class="diff-added">+-</div><div class="diff-added">+ // Note these colors are in sync with DevTools Profiler chart colors.</div><div class="diff-added">+ const COLORS = [</div><div class="diff-added">+   '#37afa9',</div><div class="diff-added">+@@ -34,11 +32,14 @@ let canvas: HTMLCanvasElement | null = null;</div><div class="diff-added">+ </div><div class="diff-added">+ function drawNative(nodeToData: Map<HostInstance, Data>, agent: Agent) {</div><div class="diff-added">+   const nodesToDraw = [];</div><div class="diff-added">+-  iterateNodes(nodeToData, (_, color, node) => {</div><div class="diff-added">++  iterateNodes(nodeToData, ({color, node}) => {</div><div class="diff-added">+     nodesToDraw.push({node, color});</div><div class="diff-added">+   });</div><div class="diff-added">+ </div><div class="diff-added">+   agent.emit('drawTraceUpdates', nodesToDraw);</div><div class="diff-added">++</div><div class="diff-added">++  const mergedNodes = groupAndSortNodes(nodeToData);</div><div class="diff-added">++  agent.emit('drawGroupedTraceUpdatesWithNames', mergedNodes);</div><div class="diff-added">+ }</div><div class="diff-added">+ </div><div class="diff-added">+ function drawWeb(nodeToData: Map<HostInstance, Data>) {</div><div class="diff-added">+@@ -46,15 +47,15 @@ function drawWeb(nodeToData: Map<HostInstance, Data>) {</div><div class="diff-added">+     initialize();</div><div class="diff-added">+   }</div><div class="diff-added">+ </div><div class="diff-added">++  const dpr = window.devicePixelRatio || 1;</div><div class="diff-added">+   const canvasFlow: HTMLCanvasElement = ((canvas: any): HTMLCanvasElement);</div><div class="diff-added">+-  canvasFlow.width = window.innerWidth;</div><div class="diff-added">+-  canvasFlow.height = window.innerHeight;</div><div class="diff-added">++  canvasFlow.width = window.innerWidth * dpr;</div><div class="diff-added">++  canvasFlow.height = window.innerHeight * dpr;</div><div class="diff-added">++  canvasFlow.style.width = `${window.innerWidth}px`;</div><div class="diff-added">++  canvasFlow.style.height = `${window.innerHeight}px`;</div><div class="diff-added">+ </div><div class="diff-added">+   const context = canvasFlow.getContext('2d');</div><div class="diff-added">+-  context.clearRect(0, 0, canvasFlow.width, canvasFlow.height);</div><div class="diff-added">+-  iterateNodes(nodeToData, (rect, color) => {</div><div class="diff-added">+-    if (rect !== null) {</div><div class="diff-added">+-      drawBorder(context, rect, color);</div><div class="diff-added">+-    }</div><div class="diff-added">+-  });</div><div class="diff-added">++  context.scale(dpr, dpr);</div><div class="diff-added">++</div><div class="diff-added">++  context.clearRect(0, 0, canvasFlow.width / dpr, canvasFlow.height / dpr);</div><div class="diff-added">++</div><div class="diff-added">++  const mergedNodes = groupAndSortNodes(nodeToData);</div><div class="diff-added">++</div><div class="diff-added">++  mergedNodes.forEach(group => {</div><div class="diff-added">++    drawGroupBorders(context, group);</div><div class="diff-added">++    drawGroupLabel(context, group);</div><div class="diff-added">++  });</div><div class="diff-added">+ }</div><div class="diff-added">+ </div><div class="diff-added">+ type GroupItem = {</div><div class="diff-added">+@@ -68,7 +69,7 @@</div><div class="diff-added">+ </div><div class="diff-added">+ export function groupAndSortNodes(</div><div class="diff-added">+   nodeToData: Map<HostInstance, Data>,</div><div class="diff-added">+-): Array<Array<GroupItem>> {</div><div class="diff-added">++): Array<Array<GroupItem>> {</div><div class="diff-added">+   const positionGroups: Map<string, Array<GroupItem>> = new Map();</div><div class="diff-added">+ </div><div class="diff-added">+   iterateNodes(nodeToData, ({rect, color, displayName, count}) => {</div><div class="diff-added">+@@ -89,12 +90,14 @@</div><div class="diff-added">+   context: CanvasRenderingContext2D,</div><div class="diff-added">+   group: Array<GroupItem>,</div><div class="diff-added">+ ) {</div><div class="diff-added">++  context.lineWidth = 1;</div><div class="diff-added">+   group.forEach(({color, rect}) => {</div><div class="diff-added">+     context.beginPath();</div><div class="diff-added">+     context.strokeStyle = color;</div><div class="diff-added">+     context.rect(rect.left, rect.top, rect.width - 1, rect.height - 1);</div><div class="diff-added">+     context.stroke();</div><div class="diff-added">+   });</div><div class="diff-added">++  context.strokeStyle = 'transparent';</div><div class="diff-added">+ }</div><div class="diff-added">+ </div><div class="diff-added">+ function drawGroupLabel(</div><div class="diff-added">+@@ -110,7 +113,7 @@</div><div class="diff-added">+     .join(', ');</div><div class="diff-added">+ </div><div class="diff-added">+   if (mergedName) {</div><div class="diff-added">+-    drawLabel(context, group[0].rect, mergedName, group[0].color);</div><div class="diff-added">++    drawLabel(context, group[0].rect, mergedName, '#000000'); // Display label with black text for readability</div><div class="diff-added">+   }</div><div class="diff-added">+ }</div><div class="diff-added">+ </div><div class="diff-added">+@@ -128,10 +131,11 @@</div><div class="diff-added">+ </div><div class="diff-added">+ function iterateNodes(</div><div class="diff-added">+   nodeToData: Map<HostInstance, Data>,</div><div class="diff-added">+-  execute: (rect: Rect | null, color: string, node: HostInstance) => void,</div><div class="diff-added">++  execute: (data: DataWithColorAndNode) => void,</div><div class="diff-added">+ ) {</div><div class="diff-added">+-  nodeToData.forEach(({count, rect}, node) => {</div><div class="diff-added">+-    const colorIndex = Math.min(COLORS.length - 1, count - 1);</div><div class="diff-added">++  nodeToData.forEach((data, node) => {</div><div class="diff-added">++    // count is 1-based, so we subtract 1 to get a 0-based index</div><div class="diff-added">++    const colorIndex = Math.min(COLORS.length - 1, data.count - 1);</div><div class="diff-added">+     const color = COLORS[colorIndex];</div><div class="diff-added">+     execute({</div><div class="diff-added">+       color,</div><div class="diff-added">+@@ -144,28 +148,17 @@</div><div class="diff-added">+   });</div><div class="diff-added">+ }</div><div class="diff-added">+ </div><div class="diff-added">+-function drawBorder(</div><div class="diff-added">++function drawLabel(</div><div class="diff-added">+   context: CanvasRenderingContext2D,</div><div class="diff-added">+   rect: Rect,</div><div class="diff-added">++  // The text to draw on the label</div><div class="diff-added">+   text: string,</div><div class="diff-added">++  // The fill color for the label background</div><div class="diff-added">+   color: string,</div><div class="diff-added">+ ): void {</div><div class="diff-added">+-  const {height, left, top, width} = rect;</div><div class="diff-added">+-</div><div class="diff-added">+-  // outline</div><div class="diff-added">+-  context.lineWidth = 1;</div><div class="diff-added">+-  context.strokeStyle = OUTLINE_COLOR;</div><div class="diff-added">+-</div><div class="diff-added">+-  context.strokeRect(left - 1, top - 1, width + 2, height + 2);</div><div class="diff-added">+-</div><div class="diff-added">+-  // inset</div><div class="diff-added">+-  context.lineWidth = 1;</div><div class="diff-added">+-  context.strokeStyle = OUTLINE_COLOR;</div><div class="diff-added">+-  context.strokeRect(left + 1, top + 1, width - 1, height - 1);</div><div class="diff-added">+-  context.strokeStyle = color;</div><div class="diff-added">+-</div><div class="diff-added">+-  context.setLineDash([0]);</div><div class="diff-added">+-</div><div class="diff-added">+-  // border</div><div class="diff-added">+-  context.lineWidth = 1;</div><div class="diff-added">+-  context.strokeRect(left, top, width - 1, height - 1);</div><div class="diff-added">+-</div><div class="diff-added">+-  context.setLineDash([0]);</div><div class="diff-added">++  const {left, top} = rect;</div><div class="diff-added">++  context.font = '10px monospace';</div><div class="diff-added">++  context.textBaseline = 'middle';</div><div class="diff-added">++  context.textAlign = 'center';</div><div class="diff-added">++</div><div class="diff-added">++  const padding = 2;</div><div class="diff-added">++  const textHeight = 14;</div><div class="diff-added">++</div><div class="diff-added">++  const metrics = context.measureText(text);</div><div class="diff-added">++  const backgroundWidth = metrics.width + padding * 2;</div><div class="diff-added">++  const backgroundHeight = textHeight;</div><div class="diff-added">++  const labelX = left;</div><div class="diff-added">++  const labelY = top - backgroundHeight;</div><div class="diff-added">++</div><div class="diff-added">++  context.fillStyle = color;</div><div class="diff-added">++  context.fillRect(labelX, labelY, backgroundWidth, backgroundHeight);</div><div class="diff-added">++</div><div class="diff-added">++  context.fillStyle = '#000000';</div><div class="diff-added">++  context.fillText(</div><div class="diff-added">++    text,</div><div class="diff-added">++    labelX + backgroundWidth / 2,</div><div class="diff-added">++    labelY + backgroundHeight / 2,</div><div class="diff-added">++  );</div><div class="diff-added">+ }</div><div class="diff-added">+ </div><div class="diff-added">+ function destroyNative(agent: Agent) {</div><div class="diff-added">+   agent.emit('disableTraceUpdates');</div><div class="diff-added">+ }</div><div class="diff-added">+ </div><div class="diff-added">+ function destroyWeb() {</div><div class="diff-added">+   if (canvas !== null) {</div><div class="diff-added">+     if (canvas.parentNode != null) {</div><div class="diff-added">+       canvas.parentNode.removeChild(canvas);</div><div class="diff-added">++    }</div><div class="diff-added">++    if (canvas.parentNode != null) {</div><div class="diff-added">++      canvas.parentNode.removeChild(canvas);</div><div class="diff-added">+     }</div><div class="diff-added">+     canvas = null;</div><div class="diff-added">+   }</div><div class="diff-added">+@@ -177,6 +170,7 @@ function initialize(): void {</div><div class="diff-added">+   canvas = window.document.createElement('canvas');</div><div class="diff-added">+   canvas.style.cssText = `</div><div class="diff-added">+     xx-background-color: red;</div><div class="diff-added">++    xx-font-family: monospace;</div><div class="diff-added">+     xx-opacity: 0.5;</div><div class="diff-added">+     bottom: 0;</div><div class="diff-added">+     left: 0;</div><div>\ No newline at end of file</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    