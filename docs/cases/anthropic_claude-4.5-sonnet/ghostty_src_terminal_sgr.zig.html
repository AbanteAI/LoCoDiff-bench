<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: src/terminal/sgr.zig - Sonnet 4.5</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: src/terminal/sgr.zig</h1>
        <h2>Model: Sonnet 4.5</h2>
        <p><a href="../../models/anthropic_claude-4.5-sonnet.html">All Sonnet 4.5 Cases</a> | <a href="../../cases.html">All Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> Sonnet 4.5</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 30022</p>
                <p><strong>Native Prompt Tokens:</strong> 37560</p>
                <p><strong>Native Completion Tokens:</strong> 1</p>
                <p><strong>Native Tokens Reasoning:</strong> 0</p>
                <p><strong>Native Finish Reason:</strong> None</p>
                <p><strong>Cost:</strong> $0.112695</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/anthropic_claude-4.5-sonnet/ghostty_src_terminal_sgr.zig/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/anthropic_claude-4.5-sonnet/ghostty_src_terminal_sgr.zig/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/anthropic_claude-4.5-sonnet/ghostty_src_terminal_sgr.zig/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div></div><div>index d82d3f385..9fe4f1ec6 100644</div><div class="diff-header">--- a/ghostty_src_terminal_sgr.zig_expectedoutput.txt (expected):tmp/tmp_p5_e3if_expected.txt	</div><div class="diff-header">+++ b/ghostty_src_terminal_sgr.zig_extracted.txt (actual):tmp/tmphn2oodb4_actual.txt	</div><div class="diff-info">@@ -106,811 +106,4 @@ pub const Parser = struct {</div><div>         if (self.idx >= self.params.len) {</div><div>             // If we're at index zero it means we must have an empty</div><div>             // list and an empty list implicitly means unset.</div><div class="diff-removed">-            if (self.idx == 0) {</div><div class="diff-removed">-                // Add one to ensure we don't loop on unset</div><div class="diff-removed">-                self.idx += 1;</div><div class="diff-removed">-                return .unset;</div><div class="diff-removed">-            }</div><div class="diff-removed">-</div><div class="diff-removed">-            return null;</div><div class="diff-removed">-        }</div><div class="diff-removed">-</div><div class="diff-removed">-        const slice = self.params[self.idx..self.params.len];</div><div class="diff-removed">-        const colon = self.params_sep.isSet(self.idx);</div><div class="diff-removed">-        self.idx += 1;</div><div class="diff-removed">-</div><div class="diff-removed">-        // Our last one will have an idx be the last value.</div><div class="diff-removed">-        if (slice.len == 0) return null;</div><div class="diff-removed">-</div><div class="diff-removed">-        // If we have a colon separator then we need to ensure we're</div><div class="diff-removed">-        // parsing a value that allows it.</div><div class="diff-removed">-        if (colon) switch (slice[0]) {</div><div class="diff-removed">-            4, 38, 48, 58 => {},</div><div class="diff-removed">-</div><div class="diff-removed">-            else => {</div><div class="diff-removed">-                // Consume all the colon separated values.</div><div class="diff-removed">-                const start = self.idx;</div><div class="diff-removed">-                while (self.params_sep.isSet(self.idx)) self.idx += 1;</div><div class="diff-removed">-                self.idx += 1;</div><div class="diff-removed">-                return .{ .unknown = .{</div><div class="diff-removed">-                    .full = self.params,</div><div class="diff-removed">-                    .partial = slice[0 .. self.idx - start + 1],</div><div class="diff-removed">-                } };</div><div class="diff-removed">-            },</div><div class="diff-removed">-        };</div><div class="diff-removed">-</div><div class="diff-removed">-        switch (slice[0]) {</div><div class="diff-removed">-            0 => return .unset,</div><div class="diff-removed">-</div><div class="diff-removed">-            1 => return .bold,</div><div class="diff-removed">-</div><div class="diff-removed">-            2 => return .faint,</div><div class="diff-removed">-</div><div class="diff-removed">-            3 => return .italic,</div><div class="diff-removed">-</div><div class="diff-removed">-            4 => underline: {</div><div class="diff-removed">-                if (colon) {</div><div class="diff-removed">-                    assert(slice.len >= 2);</div><div class="diff-removed">-                    if (self.isColon()) {</div><div class="diff-removed">-                        self.consumeUnknownColon();</div><div class="diff-removed">-                        break :underline;</div><div class="diff-removed">-                    }</div><div class="diff-removed">-</div><div class="diff-removed">-                    self.idx += 1;</div><div class="diff-removed">-                    switch (slice[1]) {</div><div class="diff-removed">-                        0 => return .reset_underline,</div><div class="diff-removed">-                        1 => return .{ .underline = .single },</div><div class="diff-removed">-                        2 => return .{ .underline = .double },</div><div class="diff-removed">-                        3 => return .{ .underline = .curly },</div><div class="diff-removed">-                        4 => return .{ .underline = .dotted },</div><div class="diff-removed">-                        5 => return .{ .underline = .dashed },</div><div class="diff-removed">-</div><div class="diff-removed">-                        // For unknown underline styles, just render</div><div class="diff-removed">-                        // a single underline.</div><div class="diff-removed">-                        else => return .{ .underline = .single },</div><div class="diff-removed">-                    }</div><div class="diff-removed">-                }</div><div class="diff-removed">-</div><div class="diff-removed">-                return .{ .underline = .single };</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            5 => return .blink,</div><div class="diff-removed">-</div><div class="diff-removed">-            6 => return .blink,</div><div class="diff-removed">-</div><div class="diff-removed">-            7 => return .inverse,</div><div class="diff-removed">-</div><div class="diff-removed">-            8 => return .invisible,</div><div class="diff-removed">-</div><div class="diff-removed">-            9 => return .strikethrough,</div><div class="diff-removed">-</div><div class="diff-removed">-            21 => return .{ .underline = .double },</div><div class="diff-removed">-</div><div class="diff-removed">-            22 => return .reset_bold,</div><div class="diff-removed">-</div><div class="diff-removed">-            23 => return .reset_italic,</div><div class="diff-removed">-</div><div class="diff-removed">-            24 => return .reset_underline,</div><div class="diff-removed">-</div><div class="diff-removed">-            25 => return .reset_blink,</div><div class="diff-removed">-</div><div class="diff-removed">-            27 => return .reset_inverse,</div><div class="diff-removed">-</div><div class="diff-removed">-            28 => return .reset_invisible,</div><div class="diff-removed">-</div><div class="diff-removed">-            29 => return .reset_strikethrough,</div><div class="diff-removed">-</div><div class="diff-removed">-            30...37 => return .{</div><div class="diff-removed">-                .@"8_fg" = @enumFromInt(slice[0] - 30),</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            38 => if (slice.len >= 2) switch (slice[1]) {</div><div class="diff-removed">-                // `2` indicates direct-color (r, g, b).</div><div class="diff-removed">-                // We need at least 3 more params for this to make sense.</div><div class="diff-removed">-                2 => if (self.parseDirectColor(</div><div class="diff-removed">-                    .direct_color_fg,</div><div class="diff-removed">-                    slice,</div><div class="diff-removed">-                    colon,</div><div class="diff-removed">-                )) |v| return v,</div><div class="diff-removed">-</div><div class="diff-removed">-                // `5` indicates indexed color.</div><div class="diff-removed">-                5 => if (slice.len >= 3) {</div><div class="diff-removed">-                    self.idx += 2;</div><div class="diff-removed">-                    return .{</div><div class="diff-removed">-                        .@"256_fg" = @truncate(slice[2]),</div><div class="diff-removed">-                    };</div><div class="diff-removed">-                },</div><div class="diff-removed">-                else => {},</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            39 => return .reset_fg,</div><div class="diff-removed">-</div><div class="diff-removed">-            40...47 => return .{</div><div class="diff-removed">-                .@"8_bg" = @enumFromInt(slice[0] - 40),</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            48 => if (slice.len >= 2) switch (slice[1]) {</div><div class="diff-removed">-                // `2` indicates direct-color (r, g, b).</div><div class="diff-removed">-                // We need at least 3 more params for this to make sense.</div><div class="diff-removed">-                2 => if (self.parseDirectColor(</div><div class="diff-removed">-                    .direct_color_bg,</div><div class="diff-removed">-                    slice,</div><div class="diff-removed">-                    colon,</div><div class="diff-removed">-                )) |v| return v,</div><div class="diff-removed">-</div><div class="diff-removed">-                // `5` indicates indexed color.</div><div class="diff-removed">-                5 => if (slice.len >= 3) {</div><div class="diff-removed">-                    self.idx += 2;</div><div class="diff-removed">-                    return .{</div><div class="diff-removed">-                        .@"256_bg" = @truncate(slice[2]),</div><div class="diff-removed">-                    };</div><div class="diff-removed">-                },</div><div class="diff-removed">-                else => {},</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            49 => return .reset_bg,</div><div class="diff-removed">-</div><div class="diff-removed">-            53 => return .overline,</div><div class="diff-removed">-            55 => return .reset_overline,</div><div class="diff-removed">-</div><div class="diff-removed">-            58 => if (slice.len >= 2) switch (slice[1]) {</div><div class="diff-removed">-                // `2` indicates direct-color (r, g, b).</div><div class="diff-removed">-                // We need at least 3 more params for this to make sense.</div><div class="diff-removed">-                2 => if (self.parseDirectColor(</div><div class="diff-removed">-                    .underline_color,</div><div class="diff-removed">-                    slice,</div><div class="diff-removed">-                    colon,</div><div class="diff-removed">-                )) |v| return v,</div><div class="diff-removed">-</div><div class="diff-removed">-                // `5` indicates indexed color.</div><div class="diff-removed">-                5 => if (slice.len >= 3) {</div><div class="diff-removed">-                    self.idx += 2;</div><div class="diff-removed">-                    return .{</div><div class="diff-removed">-                        .@"256_underline_color" = @truncate(slice[2]),</div><div class="diff-removed">-                    };</div><div class="diff-removed">-                },</div><div class="diff-removed">-                else => {},</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            59 => return .reset_underline_color,</div><div class="diff-removed">-</div><div class="diff-removed">-            90...97 => return .{</div><div class="diff-removed">-                // 82 instead of 90 to offset to "bright" colors</div><div class="diff-removed">-                .@"8_bright_fg" = @enumFromInt(slice[0] - 82),</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            100...107 => return .{</div><div class="diff-removed">-                .@"8_bright_bg" = @enumFromInt(slice[0] - 92),</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            else => {},</div><div class="diff-removed">-        }</div><div class="diff-removed">-</div><div class="diff-removed">-        return .{ .unknown = .{ .full = self.params, .partial = slice } };</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    fn parseDirectColor(</div><div class="diff-removed">-        self: *Parser,</div><div class="diff-removed">-        comptime tag: Attribute.Tag,</div><div class="diff-removed">-        slice: []const u16,</div><div class="diff-removed">-        colon: bool,</div><div class="diff-removed">-    ) ?Attribute {</div><div class="diff-removed">-        // Any direct color style must have at least 5 values.</div><div class="diff-removed">-        if (slice.len < 5) return null;</div><div class="diff-removed">-</div><div class="diff-removed">-        // Only used for direct color sets (38, 48, 58) and subparam 2.</div><div class="diff-removed">-        assert(slice[1] == 2);</div><div class="diff-removed">-</div><div class="diff-removed">-        // Note: We use @truncate because the value should be 0 to 255. If</div><div class="diff-removed">-        // it isn't, the behavior is undefined so we just... truncate it.</div><div class="diff-removed">-</div><div class="diff-removed">-        // If we don't have a colon, then we expect exactly 3 semicolon</div><div class="diff-removed">-        // separated values.</div><div class="diff-removed">-        if (!colon) {</div><div class="diff-removed">-            self.idx += 4;</div><div class="diff-removed">-            return @unionInit(Attribute, @tagName(tag), .{</div><div class="diff-removed">-                .r = @truncate(slice[2]),</div><div class="diff-removed">-                .g = @truncate(slice[3]),</div><div class="diff-removed">-                .b = @truncate(slice[4]),</div><div class="diff-removed">-            });</div><div class="diff-removed">-        }</div><div class="diff-removed">-</div><div class="diff-removed">-        // We have a colon, we might have either 5 or 6 values depending</div><div class="diff-removed">-        // on if the colorspace is present.</div><div class="diff-removed">-        const count = self.countColon();</div><div class="diff-removed">-        switch (count) {</div><div class="diff-removed">-            3 => {</div><div class="diff-removed">-                self.idx += 4;</div><div class="diff-removed">-                return @unionInit(Attribute, @tagName(tag), .{</div><div class="diff-removed">-                    .r = @truncate(slice[2]),</div><div class="diff-removed">-                    .g = @truncate(slice[3]),</div><div class="diff-removed">-                    .b = @truncate(slice[4]),</div><div class="diff-removed">-                });</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            4 => {</div><div class="diff-removed">-                self.idx += 5;</div><div class="diff-removed">-                return @unionInit(Attribute, @tagName(tag), .{</div><div class="diff-removed">-                    .r = @truncate(slice[3]),</div><div class="diff-removed">-                    .g = @truncate(slice[4]),</div><div class="diff-removed">-                    .b = @truncate(slice[5]),</div><div class="diff-removed">-                });</div><div class="diff-removed">-            },</div><div class="diff-removed">-</div><div class="diff-removed">-            else => {</div><div class="diff-removed">-                self.consumeUnknownColon();</div><div class="diff-removed">-                return null;</div><div class="diff-removed">-            },</div><div class="diff-removed">-        }</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    /// Returns true if the present position has a colon separator.</div><div class="diff-removed">-    /// This always returns false for the last value since it has no</div><div class="diff-removed">-    /// separator.</div><div class="diff-removed">-    fn isColon(self: *Parser) bool {</div><div class="diff-removed">-        // The `- 1` here is because the last value has no separator.</div><div class="diff-removed">-        if (self.idx >= self.params.len - 1) return false;</div><div class="diff-removed">-        return self.params_sep.isSet(self.idx);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    fn countColon(self: *Parser) usize {</div><div class="diff-removed">-        var count: usize = 0;</div><div class="diff-removed">-        var idx = self.idx;</div><div class="diff-removed">-        while (idx < self.params.len - 1 and self.params_sep.isSet(idx)) : (idx += 1) {</div><div class="diff-removed">-            count += 1;</div><div class="diff-removed">-        }</div><div class="diff-removed">-        return count;</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    /// Consumes all the remaining parameters separated by a colon and</div><div class="diff-removed">-    /// returns an unknown attribute.</div><div class="diff-removed">-    fn consumeUnknownColon(self: *Parser) void {</div><div class="diff-removed">-        const count = self.countColon();</div><div class="diff-removed">-        self.idx += count + 1;</div><div class="diff-removed">-    }</div><div class="diff-removed">-};</div><div class="diff-removed">-</div><div class="diff-removed">-fn testParse(params: []const u16) Attribute {</div><div class="diff-removed">-    var p: Parser = .{ .params = params };</div><div class="diff-removed">-    return p.next().?;</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-fn testParseColon(params: []const u16) Attribute {</div><div class="diff-removed">-    var p: Parser = .{ .params = params, .params_sep = SepList.initFull() };</div><div class="diff-removed">-    return p.next().?;</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: Parser" {</div><div class="diff-removed">-    try testing.expect(testParse(&[_]u16{}) == .unset);</div><div class="diff-removed">-    try testing.expect(testParse(&[_]u16{0}) == .unset);</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{ 38, 2, 40, 44, 52 });</div><div class="diff-removed">-        try testing.expect(v == .direct_color_fg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 40), v.direct_color_fg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 44), v.direct_color_fg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 52), v.direct_color_fg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    try testing.expect(testParse(&[_]u16{ 38, 2, 44, 52 }) == .unknown);</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{ 48, 2, 40, 44, 52 });</div><div class="diff-removed">-        try testing.expect(v == .direct_color_bg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 40), v.direct_color_bg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 44), v.direct_color_bg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 52), v.direct_color_bg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    try testing.expect(testParse(&[_]u16{ 48, 2, 44, 52 }) == .unknown);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: Parser multiple" {</div><div class="diff-removed">-    var p: Parser = .{ .params = &[_]u16{ 0, 38, 2, 40, 44, 52 } };</div><div class="diff-removed">-    try testing.expect(p.next().? == .unset);</div><div class="diff-removed">-    try testing.expect(p.next().? == .direct_color_fg);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: unsupported with colon" {</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 0, 4, 1 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            list.set(0);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-    try testing.expect(p.next().? == .unknown);</div><div class="diff-removed">-    try testing.expect(p.next().? == .bold);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: unsupported with multiple colon" {</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 0, 4, 2, 1 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            list.set(0);</div><div class="diff-removed">-            list.set(1);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-    try testing.expect(p.next().? == .unknown);</div><div class="diff-removed">-    try testing.expect(p.next().? == .bold);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: bold" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{1});</div><div class="diff-removed">-        try testing.expect(v == .bold);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{22});</div><div class="diff-removed">-        try testing.expect(v == .reset_bold);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: italic" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{3});</div><div class="diff-removed">-        try testing.expect(v == .italic);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{23});</div><div class="diff-removed">-        try testing.expect(v == .reset_italic);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: underline" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{4});</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{24});</div><div class="diff-removed">-        try testing.expect(v == .reset_underline);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: underline styles" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 4, 2 });</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expect(v.underline == .double);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 4, 0 });</div><div class="diff-removed">-        try testing.expect(v == .reset_underline);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 4, 1 });</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expect(v.underline == .single);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 4, 3 });</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expect(v.underline == .curly);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 4, 4 });</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expect(v.underline == .dotted);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 4, 5 });</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expect(v.underline == .dashed);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: underline style with more" {</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 4, 2, 1 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            list.set(0);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    try testing.expect(p.next().? == .underline);</div><div class="diff-removed">-    try testing.expect(p.next().? == .bold);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: underline style with too many colons" {</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 4, 2, 3, 1 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            list.set(0);</div><div class="diff-removed">-            list.set(1);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    try testing.expect(p.next().? == .unknown);</div><div class="diff-removed">-    try testing.expect(p.next().? == .bold);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: blink" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{5});</div><div class="diff-removed">-        try testing.expect(v == .blink);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{6});</div><div class="diff-removed">-        try testing.expect(v == .blink);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{25});</div><div class="diff-removed">-        try testing.expect(v == .reset_blink);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: inverse" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{7});</div><div class="diff-removed">-        try testing.expect(v == .inverse);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{27});</div><div class="diff-removed">-        try testing.expect(v == .reset_inverse);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: strikethrough" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{9});</div><div class="diff-removed">-        try testing.expect(v == .strikethrough);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParse(&[_]u16{29});</div><div class="diff-removed">-        try testing.expect(v == .reset_strikethrough);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: 8 color" {</div><div class="diff-removed">-    var p: Parser = .{ .params = &[_]u16{ 31, 43, 90, 103 } };</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .@"8_fg");</div><div class="diff-removed">-        try testing.expect(v.@"8_fg" == .red);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .@"8_bg");</div><div class="diff-removed">-        try testing.expect(v.@"8_bg" == .yellow);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .@"8_bright_fg");</div><div class="diff-removed">-        try testing.expect(v.@"8_bright_fg" == .bright_black);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .@"8_bright_bg");</div><div class="diff-removed">-        try testing.expect(v.@"8_bright_bg" == .bright_yellow);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: 256 color" {</div><div class="diff-removed">-    var p: Parser = .{ .params = &[_]u16{ 38, 5, 161, 48, 5, 236 } };</div><div class="diff-removed">-    try testing.expect(p.next().? == .@"256_fg");</div><div class="diff-removed">-    try testing.expect(p.next().? == .@"256_bg");</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: 256 color underline" {</div><div class="diff-removed">-    var p: Parser = .{ .params = &[_]u16{ 58, 5, 9 } };</div><div class="diff-removed">-    try testing.expect(p.next().? == .@"256_underline_color");</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: 24-bit bg color" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 48, 2, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .direct_color_bg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.direct_color_bg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.direct_color_bg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 3), v.direct_color_bg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: underline color" {</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 58, 2, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .underline_color);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.underline_color.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.underline_color.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 3), v.underline_color.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 58, 2, 0, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .underline_color);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.underline_color.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.underline_color.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 3), v.underline_color.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: reset underline color" {</div><div class="diff-removed">-    var p: Parser = .{ .params = &[_]u16{59} };</div><div class="diff-removed">-    try testing.expect(p.next().? == .reset_underline_color);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: invisible" {</div><div class="diff-removed">-    var p: Parser = .{ .params = &[_]u16{ 8, 28 } };</div><div class="diff-removed">-    try testing.expect(p.next().? == .invisible);</div><div class="diff-removed">-    try testing.expect(p.next().? == .reset_invisible);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: underline, bg, and fg" {</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 4, 38, 2, 255, 247, 219, 48, 2, 242, 93, 147, 4 },</div><div class="diff-removed">-    };</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expectEqual(Attribute.Underline.single, v.underline);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .direct_color_fg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 255), v.direct_color_fg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 247), v.direct_color_fg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 219), v.direct_color_fg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .direct_color_bg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 242), v.direct_color_bg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 93), v.direct_color_bg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 147), v.direct_color_bg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expectEqual(Attribute.Underline.single, v.underline);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: direct color fg missing color" {</div><div class="diff-removed">-    // This used to crash</div><div class="diff-removed">-    var p: Parser = .{ .params = &[_]u16{ 38, 5 } };</div><div class="diff-removed">-    while (p.next()) |_| {}</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: direct color bg missing color" {</div><div class="diff-removed">-    // This used to crash</div><div class="diff-removed">-    var p: Parser = .{ .params = &[_]u16{ 48, 5 } };</div><div class="diff-removed">-    while (p.next()) |_| {}</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: direct fg/bg/underline ignore optional color space" {</div><div class="diff-removed">-    // These behaviors have been verified against xterm.</div><div class="diff-removed">-</div><div class="diff-removed">-    // Colon version should skip the optional color space identifier</div><div class="diff-removed">-    {</div><div class="diff-removed">-        // 3 8 : 2 : Pi : Pr : Pg : Pb</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 38, 2, 0, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .direct_color_fg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.direct_color_fg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.direct_color_fg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 3), v.direct_color_fg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        // 4 8 : 2 : Pi : Pr : Pg : Pb</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 48, 2, 0, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .direct_color_bg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.direct_color_bg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.direct_color_bg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 3), v.direct_color_bg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        // 5 8 : 2 : Pi : Pr : Pg : Pb</div><div class="diff-removed">-        const v = testParseColon(&[_]u16{ 58, 2, 0, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .underline_color);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.underline_color.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.underline_color.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 3), v.underline_color.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    // Semicolon version should not parse optional color space identifier</div><div class="diff-removed">-    {</div><div class="diff-removed">-        // 3 8 ; 2 ; Pr ; Pg ; Pb</div><div class="diff-removed">-        const v = testParse(&[_]u16{ 38, 2, 0, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .direct_color_fg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 0), v.direct_color_fg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.direct_color_fg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.direct_color_fg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        // 4 8 ; 2 ; Pr ; Pg ; Pb</div><div class="diff-removed">-        const v = testParse(&[_]u16{ 48, 2, 0, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .direct_color_bg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 0), v.direct_color_bg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.direct_color_bg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.direct_color_bg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        // 5 8 ; 2 ; Pr ; Pg ; Pb</div><div class="diff-removed">-        const v = testParse(&[_]u16{ 58, 2, 0, 1, 2, 3 });</div><div class="diff-removed">-        try testing.expect(v == .underline_color);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 0), v.underline_color.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.underline_color.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.underline_color.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: direct fg colon with too many colons" {</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 38, 2, 0, 1, 2, 3, 4, 1 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            for (0..6) |idx| list.set(idx);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    try testing.expect(p.next().? == .unknown);</div><div class="diff-removed">-    try testing.expect(p.next().? == .bold);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: direct fg colon with colorspace and extra param" {</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 38, 2, 0, 1, 2, 3, 1 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            for (0..5) |idx| list.set(idx);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .direct_color_fg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.direct_color_fg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.direct_color_fg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 3), v.direct_color_fg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    try testing.expect(p.next().? == .bold);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-test "sgr: direct fg colon no colorspace and extra param" {</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 38, 2, 1, 2, 3, 1 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            for (0..4) |idx| list.set(idx);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .direct_color_fg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 1), v.direct_color_fg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 2), v.direct_color_fg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 3), v.direct_color_fg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    try testing.expect(p.next().? == .bold);</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-// Kakoune sent this complex SGR sequence that caused invalid behavior.</div><div class="diff-removed">-test "sgr: kakoune input" {</div><div class="diff-removed">-    // This used to crash</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 0, 4, 3, 38, 2, 175, 175, 215, 58, 2, 0, 190, 80, 70 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            list.set(1);</div><div class="diff-removed">-            list.set(8);</div><div class="diff-removed">-            list.set(9);</div><div class="diff-removed">-            list.set(10);</div><div class="diff-removed">-            list.set(11);</div><div class="diff-removed">-            list.set(12);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .unset);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expectEqual(Attribute.Underline.curly, v.underline);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .direct_color_fg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 175), v.direct_color_fg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 175), v.direct_color_fg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 215), v.direct_color_fg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .underline_color);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 190), v.underline_color.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 80), v.underline_color.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 70), v.underline_color.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    //try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div class="diff-removed">-</div><div class="diff-removed">-// Discussion #5930, another input sent by kakoune</div><div class="diff-removed">-test "sgr: kakoune input issue underline, fg, and bg" {</div><div class="diff-removed">-    // echo -e "\033[4:3;38;2;51;51;51;48;2;170;170;170;58;2;255;97;136mset everything in one sequence, broken\033[m"</div><div class="diff-removed">-</div><div class="diff-removed">-    // This used to crash</div><div class="diff-removed">-    var p: Parser = .{</div><div class="diff-removed">-        .params = &[_]u16{ 4, 3, 38, 2, 51, 51, 51, 48, 2, 170, 170, 170, 58, 2, 255, 97, 136 },</div><div class="diff-removed">-        .params_sep = sep: {</div><div class="diff-removed">-            var list = SepList.initEmpty();</div><div class="diff-removed">-            list.set(0);</div><div class="diff-removed">-            break :sep list;</div><div class="diff-removed">-        },</div><div class="diff-removed">-    };</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .underline);</div><div class="diff-removed">-        try testing.expectEqual(Attribute.Underline.curly, v.underline);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .direct_color_fg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 51), v.direct_color_fg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 51), v.direct_color_fg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 51), v.direct_color_fg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .direct_color_bg);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 170), v.direct_color_bg.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 170), v.direct_color_bg.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 170), v.direct_color_bg.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    {</div><div class="diff-removed">-        const v = p.next().?;</div><div class="diff-removed">-        try testing.expect(v == .underline_color);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 255), v.underline_color.r);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 97), v.underline_color.g);</div><div class="diff-removed">-        try testing.expectEqual(@as(u8, 136), v.underline_color.b);</div><div class="diff-removed">-    }</div><div class="diff-removed">-</div><div class="diff-removed">-    try testing.expect(p.next() == null);</div><div class="diff-removed">-}</div><div>\ No newline at end of file</div><div class="diff-added">+            if</div><div>\ No newline at end of file</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    