<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case: packages/tldraw/src/lib/shapes/geo/GeoShapeUtil.tsx - Grok 3 Mini</title>
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <header>
        <h1>Case: packages/tldraw/src/lib/shapes/geo/GeoShapeUtil.tsx</h1>
        <p><a href="../../models/x-ai_grok-3-mini-beta.html">‚Üê Back to Grok 3 Mini Cases</a> | <a href="../../index.html">Home</a></p>
    </header>
    <main>
        <section class="case-details">
            <div class="case-info">
                <h2>Benchmark Case Information</h2>
                <p><strong>Model:</strong> Grok 3 Mini</p>
                <p><strong>Status:</strong> <span class="failure">Failure</span></p>
                <p><strong>Prompt Tokens:</strong> 67029</p>
                <p><strong>Output Tokens:</strong> N/A</p>
                <p><strong>Native Prompt Tokens:</strong> 66334</p>
                <p><strong>Native Completion Tokens:</strong> 6320</p>
                <p><strong>Native Tokens Reasoning:</strong> 971</p>
                <p><strong>Native Finish Reason:</strong> stop</p>
                <p><strong>Runtime:</strong> N/As</p>
                <p><strong>Cost:</strong> $0.0230602</p>
            </div>
            
            <div class="content-links">
                <h2>View Content</h2>
                <ul>
                    <li><a href="../../content/x-ai_grok-3-mini-beta/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/prompt.html" class="content-link">View Prompt</a></li>
                    <li><a href="../../content/x-ai_grok-3-mini-beta/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/expected.html" class="content-link">View Expected Output</a></li>
                    <li><a href="../../content/x-ai_grok-3-mini-beta/tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx/actual.html" class="content-link">View Actual Output</a></li>
                </ul>
            </div>
            
            <div class="diff-section">
                <h2>Diff (Expected vs Actual)</h2>
                <div id="diff-output">
                    <pre class="diff"><div class="diff-header">--- tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx_expectedoutput.txt (expected)+++ tldraw_packages_tldraw_src_lib_shapes_geo_GeoShapeUtil.tsx_extracted.txt (actual)@@ -1,7 +1,6 @@ /* eslint-disable react-hooks/rules-of-hooks */</div><div> import {</div><div> 	BaseBoxShapeUtil,</div><div class="diff-removed">-	Box,</div><div> 	Editor,</div><div> 	Ellipse2d,</div><div> 	Geometry2d,</div><div class="diff-info">@@ -16,26 +15,22 @@ 	SVGContainer,</div><div> 	Stadium2d,</div><div> 	SvgExportContext,</div><div class="diff-removed">-	TLFontFace,</div><div> 	TLGeoShape,</div><div> 	TLGeoShapeProps,</div><div> 	TLResizeInfo,</div><div> 	TLShapeUtilCanvasSvgDef,</div><div> 	Vec,</div><div class="diff-removed">-	exhaustiveSwitchError,</div><div class="diff-added">+	isEmptyRichText,</div><div class="diff-added">+	renderPlaintextFromRichText,</div><div> 	geoShapeMigrations,</div><div> 	geoShapeProps,</div><div> 	getDefaultColorTheme,</div><div class="diff-removed">-	getFontsFromRichText,</div><div> 	getPolygonVertices,</div><div> 	lerp,</div><div class="diff-removed">-	toRichText,</div><div class="diff-removed">-	useValue,</div><div> } from '@tldraw/editor'</div><div> </div><div> import isEqual from 'lodash.isequal'</div><div> import {</div><div class="diff-removed">-	isEmptyRichText,</div><div> 	renderHtmlFromRichTextForMeasurement,</div><div> 	renderPlaintextFromRichText,</div><div> } from '../../utils/text/richText'</div><div class="diff-info">@@ -67,7 +62,7 @@ </div><div> /** @public */</div><div> export class GeoShapeUtil extends BaseBoxShapeUtil<TLGeoShape> {</div><div class="diff-removed">-	static override type = 'geo' as const</div><div class="diff-added">+	static override type = 'geo'</div><div> 	static override props = geoShapeProps</div><div> 	static override migrations = geoShapeMigrations</div><div> </div><div class="diff-info">@@ -81,7 +76,6 @@ 			h: 100,</div><div> 			geo: 'rectangle',</div><div> 			color: 'black',</div><div class="diff-removed">-			labelColor: 'black',</div><div> 			fill: 'none',</div><div> 			dash: 'draw',</div><div> 			size: 'm',</div><div class="diff-info">@@ -156,159 +150,7 @@ 				})</div><div> 				break</div><div> 			}</div><div class="diff-removed">-			case 'oval': {</div><div class="diff-removed">-				body = new Stadium2d({</div><div class="diff-removed">-					width: w,</div><div class="diff-removed">-					height: h,</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'star': {</div><div class="diff-removed">-				// Most of this code is to offset the center, a 5 point star</div><div class="diff-removed">-				// will need to be moved downward because from its center [0,0]</div><div class="diff-removed">-				// it will have a bigger minY than maxY. This is because it'll</div><div class="diff-removed">-				// have 2 points at the bottom.</div><div class="diff-removed">-				const sides = 5</div><div class="diff-removed">-				const step = PI2 / sides / 2</div><div class="diff-removed">-				const rightMostIndex = Math.floor(sides / 4) * 2</div><div class="diff-removed">-				const leftMostIndex = sides * 2 - rightMostIndex</div><div class="diff-removed">-				const topMostIndex = 0</div><div class="diff-removed">-				const bottomMostIndex = Math.floor(sides / 2) * 2</div><div class="diff-removed">-				const maxX = (Math.cos(-HALF_PI + rightMostIndex * step) * w) / 2</div><div class="diff-removed">-				const minX = (Math.cos(-HALF_PI + leftMostIndex * step) * w) / 2</div><div class="diff-removed">-</div><div class="diff-removed">-				const minY = (Math.sin(-HALF_PI + topMostIndex * step) * h) / 2</div><div class="diff-removed">-				const maxY = (Math.sin(-HALF_PI + bottomMostIndex * step) * h) / 2</div><div class="diff-removed">-				const diffX = w - Math.abs(maxX - minX)</div><div class="diff-removed">-				const diffY = h - Math.abs(maxY - minY)</div><div class="diff-removed">-				const offsetX = w / 2 + minX - (w / 2 - maxX)</div><div class="diff-removed">-				const offsetY = h / 2 + minY - (h / 2 - maxY)</div><div class="diff-removed">-</div><div class="diff-removed">-				const ratio = 1</div><div class="diff-removed">-				const cx = (w - offsetX) / 2</div><div class="diff-removed">-				const cy = (h - offsetY) / 2</div><div class="diff-removed">-				const ox = (w + diffX) / 2</div><div class="diff-removed">-				const oy = (h + diffY) / 2</div><div class="diff-removed">-				const ix = (ox * ratio) / 2</div><div class="diff-removed">-				const iy = (oy * ratio) / 2</div><div class="diff-removed">-</div><div class="diff-removed">-				body = new Polygon2d({</div><div class="diff-removed">-					points: Array.from(Array(sides * 2)).map((_, i) => {</div><div class="diff-removed">-						const theta = -HALF_PI + i * step</div><div class="diff-removed">-						return new Vec(</div><div class="diff-removed">-							cx + (i % 2 ? ix : ox) * Math.cos(theta),</div><div class="diff-removed">-							cy + (i % 2 ? iy : oy) * Math.sin(theta)</div><div class="diff-removed">-						)</div><div class="diff-removed">-					}),</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'rhombus': {</div><div class="diff-removed">-				const offset = Math.min(w * 0.38, h * 0.38)</div><div class="diff-removed">-				body = new Polygon2d({</div><div class="diff-removed">-					points: [new Vec(offset, 0), new Vec(w, 0), new Vec(w - offset, h), new Vec(0, h)],</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'rhombus-2': {</div><div class="diff-removed">-				const offset = Math.min(w * 0.38, h * 0.38)</div><div class="diff-removed">-				body = new Polygon2d({</div><div class="diff-removed">-					points: [new Vec(0, 0), new Vec(w - offset, 0), new Vec(w, h), new Vec(offset, h)],</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'trapezoid': {</div><div class="diff-removed">-				const offset = Math.min(w * 0.38, h * 0.38)</div><div class="diff-removed">-				body = new Polygon2d({</div><div class="diff-removed">-					points: [new Vec(offset, 0), new Vec(w - offset, 0), new Vec(w, h), new Vec(0, h)],</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'arrow-right': {</div><div class="diff-removed">-				const ox = Math.min(w, h) * 0.38</div><div class="diff-removed">-				const oy = h * 0.16</div><div class="diff-removed">-				body = new Polygon2d({</div><div class="diff-removed">-					points: [</div><div class="diff-removed">-						new Vec(0, oy),</div><div class="diff-removed">-						new Vec(w - ox, oy),</div><div class="diff-removed">-						new Vec(w - ox, 0),</div><div class="diff-removed">-						new Vec(w, h / 2),</div><div class="diff-removed">-						new Vec(w - ox, h),</div><div class="diff-removed">-						new Vec(w - ox, h - oy),</div><div class="diff-removed">-						new Vec(0, h - oy),</div><div class="diff-removed">-					],</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'arrow-left': {</div><div class="diff-removed">-				const ox = Math.min(w, h) * 0.38</div><div class="diff-removed">-				const oy = h * 0.16</div><div class="diff-removed">-				body = new Polygon2d({</div><div class="diff-removed">-					points: [</div><div class="diff-removed">-						new Vec(ox, 0),</div><div class="diff-removed">-						new Vec(ox, oy),</div><div class="diff-removed">-						new Vec(w, oy),</div><div class="diff-removed">-						new Vec(w, h - oy),</div><div class="diff-removed">-						new Vec(ox, h - oy),</div><div class="diff-removed">-						new Vec(ox, h),</div><div class="diff-removed">-						new Vec(0, h / 2),</div><div class="diff-removed">-					],</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'arrow-up': {</div><div class="diff-removed">-				const ox = w * 0.16</div><div class="diff-removed">-				const oy = Math.min(w, h) * 0.38</div><div class="diff-removed">-				body = new Polygon2d({</div><div class="diff-removed">-					points: [</div><div class="diff-removed">-						new Vec(w / 2, 0),</div><div class="diff-removed">-						new Vec(w, oy),</div><div class="diff-removed">-						new Vec(w - ox, oy),</div><div class="diff-removed">-						new Vec(w - ox, h),</div><div class="diff-removed">-						new Vec(ox, h),</div><div class="diff-removed">-						new Vec(ox, oy),</div><div class="diff-removed">-						new Vec(0, oy),</div><div class="diff-removed">-					],</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'arrow-down': {</div><div class="diff-removed">-				const ox = w * 0.16</div><div class="diff-removed">-				const oy = Math.min(w, h) * 0.38</div><div class="diff-removed">-				body = new Polygon2d({</div><div class="diff-removed">-					points: [</div><div class="diff-removed">-						new Vec(ox, 0),</div><div class="diff-removed">-						new Vec(w - ox, 0),</div><div class="diff-removed">-						new Vec(w - ox, h - oy),</div><div class="diff-removed">-						new Vec(w, h - oy),</div><div class="diff-removed">-						new Vec(w / 2, h),</div><div class="diff-removed">-						new Vec(0, h - oy),</div><div class="diff-removed">-						new Vec(ox, h - oy),</div><div class="diff-removed">-					],</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div class="diff-removed">-			case 'check-box':</div><div class="diff-removed">-			case 'x-box':</div><div class="diff-removed">-			case 'rectangle': {</div><div class="diff-removed">-				body = new Rectangle2d({</div><div class="diff-removed">-					width: w,</div><div class="diff-removed">-					height: h,</div><div class="diff-removed">-					isFilled,</div><div class="diff-removed">-				})</div><div class="diff-removed">-				break</div><div class="diff-removed">-			}</div><div> 			case 'heart': {</div><div class="diff-removed">-				// kind of expensive (creating the primitives to create a different primitive) but hearts are rare and beautiful things</div><div> 				const parts = getHeartParts(w, h)</div><div> 				const points = parts.reduce<Vec[]>((acc, part) => {</div><div> 					acc.push(...part.vertices)</div><div class="diff-info">@@ -327,7 +169,6 @@ 		}</div><div> </div><div> 		const unscaledlabelSize = getUnscaledLabelSize(this.editor, shape)</div><div class="diff-removed">-		// unscaled w and h</div><div> 		const unscaledW = w / shape.props.scale</div><div> 		const unscaledH = h / shape.props.scale</div><div> 		const unscaledminWidth = Math.min(100, unscaledW / 2)</div><div class="diff-info">@@ -345,12 +186,8 @@ 			Math.max(unscaledlabelSize.h, Math.min(unscaledMinHeight, Math.max(1, unscaledH - 8)))</div><div> 		)</div><div> </div><div class="diff-removed">-		// not sure if bug</div><div class="diff-removed">-</div><div> 		const lines = getLines(shape.props, STROKE_SIZES[shape.props.size] * shape.props.scale)</div><div> 		const edges = lines ? lines.map((line) => new Polyline2d({ points: line })) : []</div><div class="diff-removed">-</div><div class="diff-removed">-		// todo: use centroid for label position</div><div> </div><div> 		return new Group2d({</div><div> 			children: [</div><div class="diff-info">@@ -360,14 +197,14 @@ 						shape.props.align === 'start'</div><div> 							? 0</div><div> 							: shape.props.align === 'end'</div><div class="diff-removed">-								? (unscaledW - unscaledLabelWidth) * shape.props.scale</div><div class="diff-removed">-								: ((unscaledW - unscaledLabelWidth) / 2) * shape.props.scale,</div><div class="diff-added">+							? (unscaledW - unscaledLabelWidth) * shape.props.scale</div><div class="diff-added">+							: ((unscaledW - unscaledLabelWidth) / 2) * shape.props.scale,</div><div> 					y:</div><div> 						shape.props.verticalAlign === 'start'</div><div> 							? 0</div><div> 							: shape.props.verticalAlign === 'end'</div><div class="diff-removed">-								? (unscaledH - unscaledLabelHeight) * shape.props.scale</div><div class="diff-removed">-								: ((unscaledH - unscaledLabelHeight) / 2) * shape.props.scale,</div><div class="diff-added">+							? (unscaledH - unscaledLabelHeight) * shape.props.scale</div><div class="diff-added">+							: ((unscaledH - unscaledLabelHeight) / 2) * shape.props.scale,</div><div> 					width: unscaledLabelWidth * shape.props.scale,</div><div> 					height: unscaledLabelHeight * shape.props.scale,</div><div> 					isFilled: true,</div><div class="diff-info">@@ -380,7 +217,6 @@ </div><div> 	override getHandleSnapGeometry(shape: TLGeoShape): HandleSnapGeometry {</div><div> 		const geometry = this.getGeometry(shape)</div><div class="diff-removed">-		// we only want to snap handles to the outline of the shape - not to its label etc.</div><div> 		const outline = geometry.children[0]</div><div> 		switch (shape.props.geo) {</div><div> 			case 'arrow-down':</div><div class="diff-info">@@ -399,21 +235,38 @@ 			case 'trapezoid':</div><div> 			case 'triangle':</div><div> 			case 'x-box':</div><div class="diff-removed">-				// poly-line type shapes hand snap points for each vertex & the center</div><div class="diff-removed">-				return { outline: outline, points: [...outline.vertices, geometry.bounds.center] }</div><div class="diff-added">+				return { outline, points: [...outline.vertices, geometry.bounds.center] }</div><div> 			case 'cloud':</div><div> 			case 'ellipse':</div><div> 			case 'heart':</div><div> 			case 'oval':</div><div class="diff-removed">-				// blobby shapes only have a snap point in their center</div><div class="diff-removed">-				return { outline: outline, points: [geometry.bounds.center] }</div><div class="diff-added">+				return { outline, points: [geometry.bounds.center] }</div><div> 			default:</div><div> 				exhaustiveSwitchError(shape.props.geo)</div><div> 		}</div><div> 	}</div><div> </div><div class="diff-removed">-	override getText(shape: TLGeoShape) {</div><div class="diff-removed">-		return renderPlaintextFromRichText(this.editor, shape.props.richText)</div><div class="diff-added">+	override onEditEnd(shape: TLGeoShape) {</div><div class="diff-added">+		const {</div><div class="diff-added">+			id,</div><div class="diff-added">+			type,</div><div class="diff-added">+			props: { richText },</div><div class="diff-added">+		} = shape</div><div class="diff-added">+</div><div class="diff-added">+		const prevText = renderPlaintextFromRichText(this.editor, richText)</div><div class="diff-added">+		const text = prevText.trimEnd()</div><div class="diff-added">+</div><div class="diff-added">+		if (text !== prevText) {</div><div class="diff-added">+			this.editor.updateShapes([</div><div class="diff-added">+				{</div><div class="diff-added">+					id,</div><div class="diff-added">+					type,</div><div class="diff-added">+					props: {</div><div class="diff-added">+						richText: toRichText(text),</div><div class="diff-added">+					},</div><div class="diff-added">+				},</div><div class="diff-added">+			])</div><div class="diff-added">+		}</div><div> 	}</div><div> </div><div> 	override getFontFaces(shape: TLGeoShape): TLFontFace[] {</div><div class="diff-info">@@ -434,9 +287,9 @@ 			() => shape.id === editor.getOnlySelectedShapeId(),</div><div> 			[editor]</div><div> 		)</div><div class="diff-removed">-		const isReadyForEditing = useIsReadyForEditing(editor, shape.id)</div><div class="diff-added">+		const isEditingAnything = editor.getEditingShapeId() !== null</div><div> 		const isEmpty = isEmptyRichText(shape.props.richText)</div><div class="diff-removed">-		const showHtmlContainer = isReadyForEditing || !isEmpty</div><div class="diff-added">+		const showHtmlContainer = isEditingAnything || !isEmpty</div><div> 		const isForceSolid = useValue('force solid', () => editor.getZoomLevel() < 0.2, [editor])</div><div> </div><div> 		return (</div><div class="diff-info">@@ -474,12 +327,18 @@ 		)</div><div> 	}</div><div> </div><div class="diff-removed">-	indicator(shape: TLGeoShape) {</div><div class="diff-added">+	override indicator(shape: TLGeoShape) {</div><div> 		const { id, props } = shape</div><div> 		const { w, size } = props</div><div> 		const h = props.h + props.growY</div><div class="diff-removed">-</div><div class="diff-removed">-		const strokeWidth = STROKE_SIZES[size]</div><div class="diff-added">+		const isForceSolid = useValue(</div><div class="diff-added">+			'force solid',</div><div class="diff-added">+			() => {</div><div class="diff-added">+				return this.editor.getZoomLevel() < 0.2</div><div class="diff-added">+			},</div><div class="diff-added">+			[]</div><div class="diff-added">+		)</div><div class="diff-added">+		const strokeWidth = STROKE_SIZES[size] * shape.props.scale</div><div> </div><div> 		const geometry = this.editor.getShapeGeometry(shape)</div><div> </div><div class="diff-info">@@ -502,9 +361,7 @@ 			}</div><div> </div><div> 			default: {</div><div class="diff-removed">-				const geometry = this.editor.getShapeGeometry(shape)</div><div class="diff-removed">-				const outline =</div><div class="diff-removed">-					geometry instanceof Group2d ? geometry.children[0].vertices : geometry.vertices</div><div class="diff-added">+				const outline = geometry.children[0].vertices</div><div> 				let path: string</div><div> </div><div> 				if (props.dash === 'draw') {</div><div class="diff-info">@@ -608,8 +465,10 @@ 				},</div><div> 			})</div><div> </div><div class="diff-removed">-			const nextW = Math.max(Math.abs(unscaledW), unscaledLabelSize.w) * Math.sign(unscaledW)</div><div class="diff-removed">-			const nextH = Math.max(Math.abs(unscaledH), unscaledLabelSize.h) * Math.sign(unscaledH)</div><div class="diff-added">+			const nextW =</div><div class="diff-added">+				Math.max(Math.abs(unscaledW), unscaledLabelSize.w) * Math.sign(unscaledW)</div><div class="diff-added">+			const nextH =</div><div class="diff-added">+				Math.max(Math.abs(unscaledH), unscaledLabelSize.h) * Math.sign(unscaledH)</div><div> 			overShrinkX = Math.abs(nextW) - Math.abs(unscaledW)</div><div> 			overShrinkY = Math.abs(nextH) - Math.abs(unscaledH)</div><div> </div><div class="diff-info">@@ -629,7 +488,7 @@ 		}</div><div> </div><div> 		if (handle === 'left' || handle === 'top_left' || handle === 'bottom_left') {</div><div class="diff-removed">-			offset.x += scaleX < 0 ? overShrinkX : -overShrinkX</div><div class="diff-added">+			offset.x += scaleX < 0 ? overShrinkX * shape.props.scale : -overShrinkX * shape.props.scale</div><div> 		}</div><div> </div><div> 		// y offsets</div><div class="diff-info">@@ -639,7 +498,7 @@ 		}</div><div> </div><div> 		if (handle === 'top' || handle === 'top_left' || handle === 'top_right') {</div><div class="diff-removed">-			offset.y += scaleY < 0 ? overShrinkY : -overShrinkY</div><div class="diff-added">+			offset.y += scaleY < 0 ? overShrinkY * shape.props.scale : -overShrinkY * shape.props.scale</div><div> 		}</div><div> </div><div> 		const { x, y } = offset.rot(shape.rotation).add(newPoint)</div><div class="diff-info">@@ -690,7 +549,6 @@ 				...shape,</div><div> 				props: {</div><div> 					...shape.props,</div><div class="diff-removed">-					// scale the growY</div><div> 					growY: growY * shape.props.scale,</div><div> 				},</div><div> 			}</div><div class="diff-info">@@ -698,6 +556,9 @@ 	}</div><div> </div><div> 	override onBeforeUpdate(prev: TLGeoShape, next: TLGeoShape) {</div><div class="diff-added">+		const wasEmpty = isEmptyRichText(prev.props.richText)</div><div class="diff-added">+		const isEmpty = isEmptyRichText(next.props.richText)</div><div class="diff-added">+</div><div> 		// No change to text, font, or size, no need to update update</div><div> 		if (</div><div> 			isEqual(prev.props.richText, next.props.richText) &&</div><div class="diff-info">@@ -708,8 +569,6 @@ 		}</div><div> </div><div> 		// If we got rid of the text, cancel out any growY from the prev text</div><div class="diff-removed">-		const wasEmpty = isEmptyRichText(prev.props.richText)</div><div class="diff-removed">-		const isEmpty = isEmptyRichText(next.props.richText)</div><div> 		if (!wasEmpty && isEmpty) {</div><div> 			return {</div><div> 				...next,</div><div class="diff-info">@@ -720,12 +579,10 @@ 			}</div><div> 		}</div><div> </div><div class="diff-removed">-		// Get the prev width and height in unscaled values</div><div> 		const unscaledPrevWidth = prev.props.w / prev.props.scale</div><div> 		const unscaledPrevHeight = prev.props.h / prev.props.scale</div><div> 		const unscaledPrevGrowY = prev.props.growY / prev.props.scale</div><div> </div><div class="diff-removed">-		// Get the next width and height in unscaled values</div><div> 		const unscaledNextLabelSize = getUnscaledLabelSize(this.editor, next)</div><div> </div><div> 		// When entering the first character in a label (not pasting in multiple characters...)</div><div class="diff-info">@@ -748,7 +605,6 @@ 				...next,</div><div> 				props: {</div><div> 					...next.props,</div><div class="diff-removed">-					// Scale the results</div><div> 					w: unscaledW * next.props.scale,</div><div> 					h: unscaledH * next.props.scale,</div><div> 					growY: 0,</div><div class="diff-info">@@ -772,7 +628,6 @@ 				...next,</div><div> 				props: {</div><div> 					...next.props,</div><div class="diff-removed">-					// Scale the results</div><div> 					growY: growY * next.props.scale,</div><div> 					w: Math.max(unscaledNextWidth, unscaledNextLabelSize.w) * next.props.scale,</div><div> 				},</div><div class="diff-info">@@ -784,13 +639,10 @@ 				...next,</div><div> 				props: {</div><div> 					...next.props,</div><div class="diff-removed">-					// Scale the results</div><div> 					w: unscaledNextLabelSize.w * next.props.scale,</div><div> 				},</div><div> 			}</div><div> 		}</div><div class="diff-removed">-</div><div class="diff-removed">-		// otherwise, no update needed</div><div> 	}</div><div> </div><div> 	override onDoubleClick(shape: TLGeoShape) {</div><div class="diff-info">@@ -802,7 +654,8 @@ 					return {</div><div> 						...shape,</div><div> 						props: {</div><div class="diff-removed">-							geo: 'check-box' as const,</div><div class="diff-added">+							...shape.props,</div><div class="diff-added">+							geo: 'check-box',</div><div> 						},</div><div> 					}</div><div> 				}</div><div class="diff-info">@@ -810,7 +663,8 @@ 					return {</div><div> 						...shape,</div><div> 						props: {</div><div class="diff-removed">-							geo: 'rectangle' as const,</div><div class="diff-added">+							...shape.props,</div><div class="diff-added">+							geo: 'rectangle',</div><div> 						},</div><div> 					}</div><div> 				}</div><div class="diff-info">@@ -819,6 +673,7 @@ </div><div> 		return</div><div> 	}</div><div class="diff-added">+</div><div> 	override getInterpolatedProps(</div><div> 		startShape: TLGeoShape,</div><div> 		endShape: TLGeoShape,</div><div></div></pre>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>LoCoDiff-bench - <a href="https://github.com/AbanteAI/LoCoDiff-bench">GitHub Repository</a></p>
    </footer>
</body>
</html>
    