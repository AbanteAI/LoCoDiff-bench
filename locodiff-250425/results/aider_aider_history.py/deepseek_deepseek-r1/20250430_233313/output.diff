--- aider_aider_history.py_expectedoutput.txt (expected)+++ aider_aider_history.py_extracted.txt (actual)@@ -57,7 +57,7 @@                 break
 
         # Ensure the head ends with an assistant message
-        while messages[split_index - 1]["role"] != "assistant" and split_index > 1:
+        while split_index > 1 and messages[split_index - 1]["role"] != "assistant":
             split_index -= 1
 
         if split_index <= min_split:
