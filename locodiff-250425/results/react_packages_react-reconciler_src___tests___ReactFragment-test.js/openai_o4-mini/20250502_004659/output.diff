--- react_packages_react-reconciler_src___tests___ReactFragment-test.js_expectedoutput.txt (expected)+++ react_packages_react-reconciler_src___tests___ReactFragment-test.js_extracted.txt (actual)@@ -17,10 +17,8 @@ describe('ReactFragment', () => {
   beforeEach(function () {
     jest.resetModules();
-
     React = require('react');
     ReactNoop = require('react-noop-renderer');
-
     const InternalTestUtils = require('internal-test-utils');
     waitForAll = InternalTestUtils.waitForAll;
     assertConsoleErrorDev = InternalTestUtils.assertConsoleErrorDev;
@@ -32,7 +30,6 @@         <span>foo</span>
       </>
     );
-
     ReactNoop.render(element);
     await waitForAll([]);
 
@@ -41,7 +38,6 @@ 
   it('should render zero children via noop renderer', async () => {
     const element = <React.Fragment />;
-
     ReactNoop.render(element);
     await waitForAll([]);
 
@@ -54,7 +50,6 @@         hello <span>world</span>
       </>
     );
-
     ReactNoop.render(element);
     await waitForAll([]);
 
@@ -69,7 +64,6 @@     const element = (
       <>{new Set([<span key="a">hi</span>, <span key="b">bye</span>])}</>
     );
-
     ReactNoop.render(element);
     await waitForAll([]);
 
@@ -88,7 +82,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -133,7 +126,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -174,7 +166,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -229,7 +220,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -272,7 +262,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -313,7 +302,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -360,7 +348,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -399,7 +386,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -438,7 +424,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -477,9 +462,9 @@ 
     class Stateful extends React.Component {
       componentDidUpdate() {
-        ops.push('Update Stateful');
-      }
-
+        ops.push('Update+ Stateful');
+      }
       render() {
         return <div>Hello</div>;
       }
@@ -516,7 +501,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -557,7 +541,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -604,7 +587,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -616,9 +598,9 @@           <Stateful />
         </React.Fragment>
       ) : (
-        <>
+        <React.Fragment>
           <Stateful />
-        </>
+        </React.Fragment>
       );
     }
 
@@ -645,7 +627,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -707,14 +688,13 @@     );
   });
 
-  it('should not preserve state when switching to a keyed fragment to an array', async () => {
-    const ops = [];
-
-    class Stateful extends React.Component {
-      componentDidUpdate() {
-        ops.push('Update Stateful');
-      }
-
+  it('should not preserve state when switching to a keyed fragment to an array', async function () {
+    const ops = [];
+
+    class Stateful extends React.Component {
+      componentDidUpdate() {
+        ops.push('Update Stateful');
+      }
       render() {
         return <div>Hello</div>;
       }
@@ -723,26 +703,20 @@     function Foo({condition}) {
       return condition ? (
         <div>
-          {
-            <React.Fragment key="foo">
-              <Stateful />
-            </React.Fragment>
-          }
+          {<React.Fragment key="foo"><Stateful /></React.Fragment>}
           <span />
         </div>
       ) : (
-        <div>
-          {[<Stateful />]}
-          <span />
-        </div>
-      );
-    }
-
-    ReactNoop.render(<Foo condition={true} />);
-    await waitForAll([]);
-
-    ReactNoop.render(<Foo condition={false} />);
-    await waitForAll([]);
+        <div>{[<Stateful />]}<span /></div>
+      );
+    }
+
+    ReactNoop.render(<Foo condition={true} />);
+    await waitForAll([]);
+
+    ReactNoop.render(<Foo condition={false} />);
+    await waitForAll([]);
+
     assertConsoleErrorDev([
       'Each child in a list should have a unique "key" prop.\n' +
         '\n' +
@@ -783,7 +757,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -832,7 +805,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -881,7 +853,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -922,7 +893,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
@@ -930,34 +900,14 @@ 
     function Foo({condition}) {
       return condition
-        ? [
-            <span />,
-            <>
-              <Stateful />
-            </>,
-          ]
-        : [
-            <span />,
-            <>
-              <Stateful />
-            </>,
-          ];
-    }
-
-    ReactNoop.render(<Foo condition={true} />);
-    await waitForAll([]);
-    assertConsoleErrorDev([
-      'Each child in a list should have a unique "key" prop.\n' +
-        '\n' +
-        'Check the top-level render call using <Foo>. ' +
-        'It was passed a child from Foo. ' +
-        'See https://react.dev/link/warning-keys for more information.\n' +
-        '    in span (at **)\n' +
-        '    in Foo (at **)',
-    ]);
-
-    ReactNoop.render(<Foo condition={false} />);
-    // The key warning gets deduped because it's in the same component.
+        ? [<span key="1" />, <><Stateful /></>]
+        : [<span key="1" />, <><Stateful /></>];
+    }
+
+    ReactNoop.render(<Foo condition={true} />);
+    await waitForAll([]);
+
+    ReactNoop.render(<Foo condition={false} />);
     await waitForAll([]);
 
     expect(ops).toEqual(['Update Stateful']);
@@ -969,7 +919,6 @@     );
 
     ReactNoop.render(<Foo condition={true} />);
-    // The key warning gets deduped because it's in the same component.
     await waitForAll([]);
 
     expect(ops).toEqual(['Update Stateful', 'Update Stateful']);
@@ -981,6 +930,64 @@     );
   });
 
+  it('should not preserve state when switching to a keyed fragment to an array', async function () {
+    const ops = [];
+
+    class Stateful extends React.Component {
+      componentDidUpdate() {
+        ops.push('Update Stateful');
+      }
+      render() {
+        return <div>Hello</div>;
+      }
+    }
+
+    function Foo({condition}) {
+      return condition ? (
+        <div>
+          <React.Fragment key="foo"><Stateful /></React.Fragment>
+          <span />
+        </div>
+      ) : (
+        <div>{[<Stateful />]}<span /></div>
+      );
+    }
+
+    ReactNoop.render(<Foo condition={true} />);
+    await waitForAll([]);
+
+    ReactNoop.render(<Foo condition={false} />);
+    await waitForAll([]);
+    assertConsoleErrorDev([
+      'Each child in a list should have a unique "key" prop.\n' +
+        '\n' +
+        'Check the render method of `div`. ' +
+        'It was passed a child from Foo. ' +
+        'See https://react.dev/link/warning-keys for more information.\n' +
+        '    in Foo (at **)',
+    ]);
+
+    expect(ops).toEqual([]);
+    expect(ReactNoop).toMatchRenderedOutput(
+      <div>
+        <div>Hello</div>
+        <span />
+      </div>,
+    );
+
+    ReactNoop.render(<Foo condition={true} />);
+    await waitForAll([]);
+
+    expect(ops).toEqual([]);
+    expect(ReactNoop).toMatchRenderedOutput(
+      <div>
+        <div>Hello</div>
+        <span />
+      </div>,
+    );
+  });
+  
+  // Regression tests for lazy top-level fragment semantics
   it('should preserve state of children when adding a fragment wrapped in Lazy', async function () {
     const ops = [];
 
@@ -988,7 +995,6 @@       componentDidUpdate() {
         ops.push('Update Stateful');
       }
-
       render() {
         return <div>Hello</div>;
       }
