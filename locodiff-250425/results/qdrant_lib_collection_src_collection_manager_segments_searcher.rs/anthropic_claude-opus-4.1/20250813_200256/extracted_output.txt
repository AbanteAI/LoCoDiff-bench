// Parallel segment processing with hardware monitoring
segments.map(|segment| {
    let hw_collector = hw_measurement_acc.new_collector();
    runtime_handle.spawn_blocking({
        move || {
            // Search in segment with context
            search_in_segment(segment, batch_request, use_sampling, &segment_query_context)
        }
    })
})