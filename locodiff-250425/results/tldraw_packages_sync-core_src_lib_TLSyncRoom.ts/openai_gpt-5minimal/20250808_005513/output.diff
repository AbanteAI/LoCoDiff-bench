
index 66f39bdba..999cd7258 100644
--- a/tldraw_packages_sync-core_src_lib_TLSyncRoom.ts_expectedoutput.txt (expected):tmp/tmpqj8_btlq_expected.txt	
+++ b/tldraw_packages_sync-core_src_lib_TLSyncRoom.ts_extracted.txt (actual):tmp/tmpm2e8rj9s_actual.txt	
@@ -520,6 +520,12 @@ export class TLSyncRoom<R extends UnknownRecord, SessionMeta> {
 		if (this.sessions.size === 0) {
 			this.events.emit('room_became_empty')
 		}
+
+		try {
+			session.socket.close()
+		} catch {
+			// noop, calling .close() multiple times is fine
+		}
 	}
 
 	private cancelSession(sessionId: string) {
@@ -543,12 +549,6 @@ export class TLSyncRoom<R extends UnknownRecord, SessionMeta> {
 			isReadonly: session.isReadonly,
 			requiresLegacyRejection: session.requiresLegacyRejection,
 		})
-
-		try {
-			session.socket.close()
-		} catch {
-			// noop, calling .close() multiple times is fine
-		}
 	}
 
 	/**
