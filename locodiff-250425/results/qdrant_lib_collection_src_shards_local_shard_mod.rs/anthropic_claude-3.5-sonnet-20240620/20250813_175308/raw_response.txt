Here is a summary of the key changes made to the `LocalShard` struct and its implementation in the `lib/collection/src/shards/local_shard/mod.rs` file:

1. Added fields:
   - `payload_index_schema: Arc<SaveOnDisk<PayloadIndexSchema>>`
   - `total_optimized_points: Arc<AtomicUsize>`
   - `search_runtime: Handle`
   - `disk_usage_watcher: DiskUsageWatcher`
   - `read_rate_limiter: Option<ParkingMutex<RateLimiter>>`

2. Removed fields:
   - `clock_map: Arc<Mutex<ClockMap>>`

3. Changed `wal` field type from `LockedWal` to `RecoverableWal`

4. Added methods:
   - `move_data`
   - `clear`
   - `load`
   - `build_local`
   - `build`
   - `on_optimizer_config_update`
   - `on_strict_mode_config_update`
   - `trigger_optimizers`
   - `stop_gracefully`
   - `create_snapshot`
   - `restore_snapshot`
   - `local_shard_status`
   - `local_shard_info`
   - `recovery_point`
   - `update_cutoff`
   - `check_read_rate_limiter`

5. Removed methods:
   - `estimate_vector_data_size`
   - `get_telemetry_data` (moved to a separate telemetry module)

6. Modified existing methods:
   - `new`: Added parameters for clocks, search runtime, disk usage watcher
   - `load_from_wal`: Updated to use new WAL and clock structures
   - `estimate_cardinality`: Added hardware counter parameter
   - `read_filtered`: Added hardware counter parameter

7. Added support for rate limiting, disk usage monitoring, and improved snapshot handling

8. Moved telemetry-related functionality to a separate module

9. Updated error handling and logging throughout the implementation

These changes reflect improvements in shard management, performance monitoring, resource usage control, and overall code organization.