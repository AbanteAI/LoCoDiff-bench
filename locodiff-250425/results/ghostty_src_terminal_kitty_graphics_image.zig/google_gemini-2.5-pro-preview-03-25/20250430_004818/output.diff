--- ghostty_src_terminal_kitty_graphics_image.zig_expectedoutput.txt (expected)+++ ghostty_src_terminal_kitty_graphics_image.zig_extracted.txt (actual)@@ -403,7 +403,7 @@         // Write it to an array list
         var list = std.ArrayList(u8).init(alloc);
         errdefer list.deinit();
-        stream.reader().readAllArrayList(&list, max_size) catch |err| {
+        stream.readAllArrayList(&list, max_size) catch |err| {
             log.warn("failed to read decompressed data: {}", .{err});
             return error.DecompressionFailed;
         };
@@ -476,6 +476,7 @@         UnsupportedFormat,
         UnsupportedMedium,
         UnsupportedDepth,
+        OutOfMemory,
     };
 
     pub fn deinit(self: *Image, alloc: Allocator) void {
